<!doctype html>
<html lang="en">
    <head>
    <meta charset="utf-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<title>Modern PHP (7.x) | Die wunderbare Welt von Isotopp</title>
<meta name="description" content="Kris Köhntopp&#39;s blog (Fedi: @isotoppinfosec.exchange)">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" href="icon.png">
<link rel="icon" href="favicon.ico" type="image/ico">
<link rel="shortcut icon" href="favicon.ico">
<link rel="canonical" href="https://blog.koehntopp.info/2025/07/30/modern-php.html">

<link rel="alternate" type="application/rss+xml" href='https://blog.koehntopp.info/feed.xml' title="Die wunderbare Welt von Isotopp">
<link rel="alternate" type="application/rss+xml" href='https://blog.koehntopp.info/tags/mysql/feed.xml' title="Feed: mysql Articles for Die wunderbare Welt von Isotopp">
<link rel="alternate" type="application/rss+xml" href='https://blog.koehntopp.info/tags/review/feed.xml' title="Feed: review Articles for Die wunderbare Welt von Isotopp">


<meta name="generator" content="Hugo 0.148.2">
<meta property="og:title" content='Modern PHP (7.x) | Die wunderbare Welt von Isotopp' />
<meta property="og:site_name" content='Die wunderbare Welt von Isotopp' />
<meta property="og:locale" content="en_US" />
<meta name="description" content='Kris Köhntopp&#39;s blog (Fedi: @isotoppinfosec.exchange)' />
<meta property="og:description" content='Kris Köhntopp&#39;s blog (Fedi: @isotoppinfosec.exchange)' />
<meta property="og:url" content="https://blog.koehntopp.info/2025/07/30/modern-php.html" />
<meta property="og:type" content="article" />
<meta name="article:published_time" content='2025-07-30T03:04:05Z' />
<meta name="fediverse:creator" content="@isotopp@infosec.exchange">
<meta property="og:image" content='https://blog.koehntopp.info/assets/img/background/rijksmuseum.jpg' />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:creator" content='@isotopp@infosec.exchange' />
<meta property="twitter:title" content='Modern PHP (7.x)' />
<meta property="twitter:description" content='Kris Köhntopp&#39;s blog (Fedi: @isotoppinfosec.exchange)' />
<meta property="twitter:image" content='https://blog.koehntopp.info/assets/img/background/rijksmuseum.jpg' />


    



<link rel="stylesheet" href="https://blog.koehntopp.info/style.min.9c06d59cbec0d99504f824dfa9f104b2be012cc4febd69764b14c40cd8a09674.css">


    </head>
    <body>
        

        <nav class="navbar navbar-expand-lg navbar-light px-lg-4 pt-lg-4">
    <div class="container-fluid">
        <a class="navbar-brand justify-content-center" href="https://blog.koehntopp.info/" rel="home" title="Die wunderbare Welt von Isotopp">
            <img alt="Kris" height='48' width='48' src='/assets/img/avatars/isotopp.jpg' class='p-0 me-3 d-block d-lg-inline'>
            <span class='h4 d-block d-lg-inline'>Die wunderbare Welt von Isotopp</span>
        </a>

        <button class="navbar-toggler ms-auto" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse text-center" id="navbarSupportedContent">
            <ul class="navbar-nav ms-auto">
                
                <li class="nav-item ">
                    <a class="nav-link" href="/about/">
                        <span class="">About</span>
                        
                    </a>
                </li>
                <li class="nav-item ">
                    <a class="nav-link" href="/contribute/">
                        <span class="">Contribute</span>
                        
                    </a>
                </li>
                <li class="nav-item ">
                    <a class="nav-link" href="/search/">
                        <span class=""><svg class='bi' height='1.5rem' width='1.5rem' fill='currentColor'><use xlink:href='/bootstrap-icons.svg#search'/></svg></span>
                        
                    </a>
                </li>
                <li class="nav-item ">
                    <a class="nav-link" href="/tags/">
                        <span class=""><svg class='bi' width='1.5rem' height='1.5rem' fill='currentColor'><use xlink:href='/bootstrap-icons.svg#tags-fill'/></svg></span>
                        
                    </a>
                </li>
                
            </ul>
            
        </div>

    </div>
</nav>


        <main role="main" class="container-fluid p-0">

            









<div class="page">
	<article class="modern-php-7.x-page">
		<div class='row  justify-content-center text-center my-4 mx-0'>
			<header class="headerbanner">
				<div class='col'>
					<h1 class="title mb-lg-4 text-white">
						Modern PHP (7.x)
					</h1>
					<div class='text-uppercase text-light' style='letter-spacing: 0.1rem;'>
						<img alt='@isotopp@infosec.exchange image' src='/assets/img/avatars/isotopp.jpg' class='me-1 p-0'
						     style='width: 1.9rem; border-radius: 1rem;'>
						<a href="https://infosec.exchange/@isotopp" class='text-light text-decoration-none'>
							Kristian Köhntopp
						</a>
						
						<span class='d-none d-lg-inline'>-</span>
						<div class='d-block d-lg-inline'>July 30, 2025</div>
						
					</div>
				</div>
				
				<img alt='a featured image' src="/assets/img/background/rijksmuseum.jpg">
				
			</header>
		</div>

		<div class='row justify-content-center mx-0'>
			<div class='col-lg-4 text-center text-lg-start'>
				
				<div>
					<div class='letter-spacing-01 text-uppercase text-secondary'>
						Previous Post
					</div>
					<a class='text-decoration-none' href="https://blog.koehntopp.info/2025/07/30/modern-php-2.html">Modern PHP (8.x)</a>
				</div>
				
			</div>

			<div class='col-lg-4 text-lg-end mt-5 mt-lg-0 text-center'>
				
				<div>
					<div class='letter-spacing-01 text-uppercase text-secondary'>
						Next Post
					</div>
					<a class='text-decoration-none' href="https://blog.koehntopp.info/2025/08/10/two-years-megane.html">Two Years Megane</a>
				</div>
				
			</div>
		</div>

		<div class='row justify-content-center mx-0 mt-3 mb-5'>
			<div class="col-lg-8 mb-3">
				
				<header class="toc bg-light">
					<nav id="TableOfContents">
  <ul>
    <li><a href="#features">Features</a></li>
    <li><a href="#70-2015">7.0 (2015)</a>
      <ul>
        <li><a href="#strict-types--scalar-type-declarations-and-return-type-declarations">Strict Types,  Scalar Type Declarations and Return Type Declarations</a></li>
        <li><a href="#---null-coalescing-operator">?? - Null Coalescing Operator</a></li>
        <li><a href="#anonymous-classes">Anonymous Classes</a></li>
        <li><a href="#throwable-and-error-hierarchy-unifying-exceptions-and-errors">Throwable and Error hierarchy, unifying Exceptions and Errors</a></li>
      </ul>
    </li>
    <li><a href="#71-2016">7.1 (2016)</a>
      <ul>
        <li><a href="#iterable-pseudo-type">Iterable Pseudo-Type</a></li>
        <li><a href="#nullable-types-void-type">Nullable Types, Void Type</a></li>
        <li><a href="#short-array-deconstruction-syntax-using-keys-in-list-to_dict">Short array deconstruction syntax, using keys in list (&ldquo;to_dict&rdquo;)</a></li>
        <li><a href="#multiexception">Multiexception</a></li>
        <li><a href="#class-constant-visibility-modifiers">Class Constant Visibility Modifiers</a></li>
        <li><a href="#other-changes">Other changes</a></li>
      </ul>
    </li>
    <li><a href="#72-2017">7.2 (2017)</a>
      <ul>
        <li><a href="#proper-key-conversion-for-objectarray-casts">Proper Key Conversion for Object/Array Casts</a></li>
        <li><a href="#counting-uncountable-things-is-now-forbidden">Counting Uncountable Things is now forbidden</a></li>
        <li><a href="#object-typehint-for-parameters-and-return-types">Object typehint for parameters and return types</a></li>
        <li><a href="#cryptography-updates">Cryptography updates</a></li>
        <li><a href="#trailing-commas-in-list">Trailing commas in <code>list()</code></a></li>
      </ul>
    </li>
    <li><a href="#73-2018">7.3 (2018)</a>
      <ul>
        <li><a href="#flexible-heredocnowdoc-indentation">Flexible heredoc/nowdoc indentation</a></li>
        <li><a href="#trailing-commas-in-function-calls">Trailing commas in function calls</a></li>
        <li><a href="#json_throw_on_error">JSON_THROW_ON_ERROR</a></li>
        <li><a href="#is_countable">is_countable()</a></li>
      </ul>
    </li>
    <li><a href="#74-2019">7.4 (2019)</a>
      <ul>
        <li><a href="#typed-properties">Typed properties</a></li>
        <li><a href="#arrow-functions-fn">Arrow functions (fn())</a></li>
        <li><a href="#spread-operator-in-array-expressions">Spread operator in array expressions</a></li>
        <li><a href="#limited-covariance-and-contravariance">Limited covariance and contravariance</a></li>
        <li><a href="#numeric-literal-separator-_">Numeric literal separator <code>_</code></a></li>
        <li><a href="#null-coalescing-assignment-operator-">Null coalescing assignment operator (??=)</a></li>
        <li><a href="#weak-references">Weak references</a></li>
        <li><a href="#preloading-opcache">Preloading (Opcache)</a></li>
        <li><a href="#deprecations-in-74-selection">Deprecations in 7.4 (selection)</a></li>
      </ul>
    </li>
  </ul>
</nav>
				</header>
				
			</div>
			<div class='col-lg-8'>
				<p>I have not been doing PHP in a long time, and so I am writing this here as a memo to self,
in order to remind me what features are &ldquo;new&rdquo; in PHP, with &ldquo;new&rdquo; meaning 7.0 and newer.</p>
<h1 id="features">
    <a href="#features">
	Features
    </a>
</h1>
<table>
  <thead>
      <tr>
          <th>PHP version</th>
          <th>Category</th>
          <th>Feature</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>7.0</td>
          <td>Typing</td>
          <td>declare(strict_types=1) directive</td>
      </tr>
      <tr>
          <td>7.0</td>
          <td>Typing</td>
          <td>Scalar type declarations</td>
      </tr>
      <tr>
          <td>7.0</td>
          <td>Typing</td>
          <td>Return type declarations</td>
      </tr>
      <tr>
          <td>7.0</td>
          <td>Operators</td>
          <td>Null coalescing operator (??)</td>
      </tr>
      <tr>
          <td>7.0</td>
          <td>Classes</td>
          <td>Anonymous classes</td>
      </tr>
      <tr>
          <td>7.0</td>
          <td>Errors</td>
          <td>Throwable and Error hierarchy</td>
      </tr>
      <tr>
          <td>7.1</td>
          <td>Typing</td>
          <td>Iterable pseudo-type</td>
      </tr>
      <tr>
          <td>7.1</td>
          <td>Typing</td>
          <td>Nullable types (?type)</td>
      </tr>
      <tr>
          <td>7.1</td>
          <td>Typing</td>
          <td>Void return type</td>
      </tr>
      <tr>
          <td>7.1</td>
          <td>Classes</td>
          <td>Class constant visibility</td>
      </tr>
      <tr>
          <td>7.1</td>
          <td>Errors</td>
          <td>Multi-catch exceptions</td>
      </tr>
      <tr>
          <td>7.2</td>
          <td>Classes</td>
          <td>Proper key conversion for casts between object and array</td>
      </tr>
      <tr>
          <td>7.2</td>
          <td>Errors</td>
          <td>Counting uncountable things is now forbidden</td>
      </tr>
      <tr>
          <td>7.2</td>
          <td>Typing</td>
          <td>Object type hint</td>
      </tr>
      <tr>
          <td>7.2</td>
          <td>Security</td>
          <td>Cryptography update</td>
      </tr>
      <tr>
          <td>7.2</td>
          <td>Syntax</td>
          <td>Trailing commas in <code>list()</code></td>
      </tr>
      <tr>
          <td>7.3</td>
          <td>Syntax</td>
          <td>Trailing commas in function calls</td>
      </tr>
      <tr>
          <td>7.3</td>
          <td>Syntax</td>
          <td>Flexible Heredoc/Nowdoc Syntax</td>
      </tr>
      <tr>
          <td>7.3</td>
          <td>Functions</td>
          <td>is_countable()</td>
      </tr>
      <tr>
          <td>7.4</td>
          <td>Typing</td>
          <td>Typed properties</td>
      </tr>
      <tr>
          <td>7.4</td>
          <td>Syntax</td>
          <td>Arrow functions (fn())</td>
      </tr>
      <tr>
          <td>7.4</td>
          <td>Syntax</td>
          <td>Spread Operator in Array Expression</td>
      </tr>
      <tr>
          <td>7.4</td>
          <td>Typing</td>
          <td>Limited Return Type Covariance and Argument Type Contravariance</td>
      </tr>
      <tr>
          <td>7.4</td>
          <td>Syntax</td>
          <td>Numeric Literal Separator <code>_</code></td>
      </tr>
      <tr>
          <td>7.4</td>
          <td>Syntax</td>
          <td>Null Coalescing Assignment Operator</td>
      </tr>
      <tr>
          <td>7.4</td>
          <td>Classes</td>
          <td>Weak Refs</td>
      </tr>
      <tr>
          <td>7.4</td>
          <td>Performance</td>
          <td>Preloading (Opcache)</td>
      </tr>
      <tr>
          <td>7.4</td>
          <td>Syntax</td>
          <td>Lots of Deprecations</td>
      </tr>
  </tbody>
</table>
<h1 id="70-2015">
    <a href="#70-2015">
	7.0 (2015)
    </a>
</h1>
<h2 id="strict-types--scalar-type-declarations-and-return-type-declarations">
    <a href="#strict-types--scalar-type-declarations-and-return-type-declarations">
	Strict Types,  Scalar Type Declarations and Return Type Declarations
    </a>
</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="c1">#! /opt/homebrew/bin/php
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">  <span class="k">declare</span><span class="p">(</span><span class="nx">strict_typing</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="k">function</span> <span class="nf">add</span><span class="p">(</span><span class="nx">int</span> <span class="nv">$a</span><span class="p">,</span> <span class="nx">int</span> <span class="nv">$b</span><span class="p">)</span><span class="o">:</span> <span class="nx">int</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nv">$a</span> <span class="o">+</span> <span class="nv">$b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nx">add</span><span class="p">(</span><span class="s2">&#34;30&#34;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="err">$</span> <span class="nx">php</span> <span class="nx">probe</span><span class="o">.</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nx">PHP</span> <span class="nx">Fatal</span> <span class="nx">error</span><span class="o">:</span>  <span class="nx">Uncaught</span> <span class="nx">TypeError</span><span class="o">:</span> <span class="nx">add</span><span class="p">()</span><span class="o">:</span> <span class="nx">Argument</span> <span class="c1">#1 ($a) must be of type int, string given, called in /Users/kris/probe.php on line 10 and defined in /Users/kris/probe.php:5
</span></span></span></code></pre></div><h2 id="---null-coalescing-operator">
    <a href="#---null-coalescing-operator">
	?? - Null Coalescing Operator
    </a>
</h2>
<p>A shorthand for <code>isset()</code> and offering a default value.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$username</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">]</span> <span class="o">??</span> <span class="s1">&#39;guest&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// previously
</span></span></span><span class="line"><span class="cl"><span class="c1">// $username = isset($_GET[&#39;user&#39;]) ? $_GET[&#39;user&#39;] : &#39;guest&#39;;
</span></span></span></code></pre></div><h2 id="anonymous-classes">
    <a href="#anonymous-classes">
	Anonymous Classes
    </a>
</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$logger</span> <span class="o">=</span> <span class="k">new</span> <span class="k">class</span> <span class="err">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">public</span> <span class="k">function</span> <span class="nf">log</span><span class="p">(</span><span class="nx">string</span> <span class="nv">$msg</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;[LOG] </span><span class="si">{</span><span class="nv">$msg</span><span class="si">}</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$logger</span><span class="o">&gt;</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;Hi!&#34;</span><span class="p">);</span>
</span></span></code></pre></div><p>Useful for throwaway classes, often used in tests.</p>
<h2 id="throwable-and-error-hierarchy-unifying-exceptions-and-errors">
    <a href="#throwable-and-error-hierarchy-unifying-exceptions-and-errors">
	Throwable and Error hierarchy, unifying Exceptions and Errors
    </a>
</h2>
<p>Adds an Interface <code>Throwable</code>, allows you to catch Errors, not just Exceptions.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">throw</span> <span class="k">new</span> <span class="nx">Error</span><span class="p">(</span><span class="s2">&#34;Argh!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">Throwable</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">echo</span> <span class="s2">&#34;Caucht </span><span class="si">{</span><span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">()</span><span class="si">}</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h1 id="71-2016">
    <a href="#71-2016">
	7.1 (2016)
    </a>
</h1>
<h2 id="iterable-pseudo-type">
    <a href="#iterable-pseudo-type">
	Iterable Pseudo-Type
    </a>
</h2>
<p>Normally, <code>Iterable</code> would be an Interface, and you&rsquo;d declare the parameter type or return type of a function to be like that.
For historical reasons that wasn&rsquo;t possible, there is <code>array</code> for non-objects, and <code>Traverable</code> for Objects.
Both can be passed to <code>foreach</code>, and their elements can be <code>yield</code>&lsquo;ed.</p>
<p>The keyword <code>Iterable</code> is reserved, as is the function name <code>is_iterable()</code>.</p>
<p>It can be used like a type in signatures, and unifies these two behaviors.
It is a shortcut for <code>array|Traversable</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">iterate_something</span><span class="p">(</span><span class="nx">iterable</span> <span class="nv">$it</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">foreach</span> <span class="p">(</span><span class="nv">$it</span> <span class="k">as</span> <span class="nv">$element</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// ...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">generate_something</span><span class="p">()</span><span class="o">:</span> <span class="nx">iterable</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">yield</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">yield</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">yield</span> <span class="mi">3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h2 id="nullable-types-void-type">
    <a href="#nullable-types-void-type">
	Nullable Types, Void Type
    </a>
</h2>
<p>Introduces the type prefix <code>?</code> as a prefix for the type <code>t</code> so that <code>?t</code> is short for <code>t|null</code>.
So you get</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">eight_ball</span><span class="p">(</span><span class="nx">string</span> <span class="nv">$question</span><span class="p">)</span><span class="o">:</span> <span class="o">?</span><span class="nx">string</span> <span class="p">{</span> <span class="c1">// null if we don&#39;t know the answer
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="o">...</span>
</span></span><span class="line"><span class="cl">   <span class="k">return</span> <span class="k">null</span><span class="p">;</span> <span class="c1">// allowed
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span></code></pre></div><p>For return types, a subclass or implementation of an Interface can be stricter,
that is, remove nullability from the return type.</p>
<p>For parameter types, a subclass or implementation of an Interface may be looser,
that is, add nullability to a parameter type.</p>
<p>A function with a nullable type still needs a parameter, there is no <code>null</code> default.
It is valid to provide a default value to a nullable parameter, and that default may be <code>null</code>.</p>
<p>We also get the <code>void</code> return type. In a function declared with <code>: void</code>, you may not return a value.
You must use <code>return;</code> without a value.
<code>null</code> is a value, so <code>return null;</code> is invalid for <code>void</code> functions.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">no_result</span><span class="p">()</span><span class="o">:</span> <span class="nx">void</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">// invalid
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span></code></pre></div><h2 id="short-array-deconstruction-syntax-using-keys-in-list-to_dict">
    <a href="#short-array-deconstruction-syntax-using-keys-in-list-to_dict">
	Short array deconstruction syntax, using keys in list (&ldquo;to_dict&rdquo;)
    </a>
</h2>
<p>You can construct arrays and dicts in PHP with the <code>array()</code> constructor, and since 5.4 also with <code>[ ]</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$a</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl">  <span class="c1">// also $a = [1, 2, 3]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$d</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&#34;one&#34;</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&#34;two&#34;</span> <span class="o">=&gt;</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&#34;three&#34;</span> <span class="o">=&gt;</span> <span class="mi">3</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl">  <span class="c1">// also $d = [ &#34;one&#34; =&gt; 1, &#34;two&#34; =&gt; 2, &#34;three&#34; =&gt; 3 ];
</span></span></span></code></pre></div><p>Deconstruction is possible with <code>list()</code>,
and newly added is the use of keys in <code>list</code> to convert an array to a dict.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">list</span><span class="p">(</span><span class="nv">$a</span><span class="p">,</span> <span class="nv">$b</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)</span> <span class="o">=</span> <span class="nv">$some_array</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">list</span><span class="p">(</span><span class="s2">&#34;a&#34;</span> <span class="o">=&gt;</span> <span class="nv">$a</span><span class="p">,</span> <span class="s2">&#34;b&#34;</span> <span class="o">=&gt;</span> <span class="nv">$b</span><span class="p">,</span> <span class="s2">&#34;c&#34;</span> <span class="o">=&gt;</span> <span class="nv">$c</span><span class="p">)</span> <span class="o">=</span> <span class="nv">$some_array</span> <span class="c1">// to dict
</span></span></span></code></pre></div><p>This is now also possible using <code>[ ]</code> on the LHS of an assignment.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="p">[</span> <span class="nv">$a</span><span class="p">,</span> <span class="nv">$b</span><span class="p">,</span> <span class="nv">$c</span> <span class="p">]</span> <span class="o">=</span> <span class="nv">$some_array</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span> <span class="s2">&#34;a&#34;</span> <span class="o">=&gt;</span> <span class="nv">$a</span><span class="p">,</span> <span class="s2">&#34;b&#34;</span> <span class="o">=&gt;</span> <span class="nv">$b</span><span class="p">,</span> <span class="s2">&#34;c&#34;</span> <span class="o">=&gt;</span> <span class="nv">$c</span> <span class="p">]</span> <span class="o">=</span> <span class="nv">$some_array</span> <span class="c1">// to_dict
</span></span></span></code></pre></div><p>Nested, mixed use of <code>list()</code> and <code>[ ]</code> is explicitly not allowed.
You can nest, but you must consistently use either one or the other syntax.</p>
<h2 id="multiexception">
    <a href="#multiexception">
	Multiexception
    </a>
</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="c1">// Some code...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">ExceptionType1</span> <span class="o">|</span> <span class="nx">ExceptionType2</span> <span class="nv">$e</span><span class="p">)</span>
</span></span></code></pre></div><p>instead of</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="c1">// Some code...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">ExceptionType1</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="c1">// Code to handle the exception
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">ExceptionType2</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="c1">// Same code to handle the exception
</span></span></span></code></pre></div><h2 id="class-constant-visibility-modifiers">
    <a href="#class-constant-visibility-modifiers">
	Class Constant Visibility Modifiers
    </a>
</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Token</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="no">PUBLIC_CONST</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// default is public
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  
</span></span><span class="line"><span class="cl">  <span class="k">private</span> <span class="k">const</span> <span class="no">PRIVATE_CONST</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">protected</span> <span class="k">const</span> <span class="no">PRIVATE_CONST</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">public</span> <span class="k">const</span> <span class="no">PRIVATE_CONST</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p><code>const</code> can now use visibility in classes. In Interfaces, they must be <code>public</code>.</p>
<h2 id="other-changes">
    <a href="#other-changes">
	Other changes
    </a>
</h2>
<p>The variable name <code>$this</code> is now reserved and can no longer be used as a parameter,
static variable, global variable, <code>catch</code> variable, or <code>foreach</code> counter.
It can also no longer be unset, reassigned directly, through <code>$$</code> (variable variables)
or through references, through <code>extract</code> or <code>parse_str()</code>.</p>
<p>Consequently, you can&rsquo;t use <code>$this</code> when you are not in an object context.</p>
<p>Negative string offsets now can be used everywhere consistently and will reference glyphs from the right.
The last glyph in a string is at offset <code>-1</code>.</p>
<h1 id="72-2017">
    <a href="#72-2017">
	7.2 (2017)
    </a>
</h1>
<h2 id="proper-key-conversion-for-objectarray-casts">
    <a href="#proper-key-conversion-for-objectarray-casts">
	Proper Key Conversion for Object/Array Casts
    </a>
</h2>
<p>When converting between arrays and objects, keys now follow the same, consistent key-casting rules used by arrays:</p>
<ul>
<li>Only int and string keys are allowed.</li>
<li>Numeric strings become ints (&ldquo;42&rdquo; -&gt; 42).</li>
<li>Floats are truncated to int (1.7 -&gt; 1).</li>
<li>Booleans become 1/0, null becomes the empty string &ldquo;&rdquo;.</li>
</ul>
<p>This mainly affects odd cases when you cast arrays to objects and back,
or when you create properties with unusual names and then cast to an array.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="c1">#! /opt/homebrew/bin/php
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;42&#34;</span> <span class="o">=&gt;</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="mf">1.7</span> <span class="o">=&gt;</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="k">true</span> <span class="o">=&gt;</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="k">null</span> <span class="o">=&gt;</span> <span class="s1">&#39;n&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="nv">$o</span> <span class="o">=</span> <span class="p">(</span><span class="nx">object</span><span class="p">)</span><span class="nv">$a</span><span class="p">;</span>           <span class="c1">// properties named &#34;42&#34;, &#34;1&#34;, &#34;1&#34;, &#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$b</span> <span class="o">=</span> <span class="p">(</span><span class="k">array</span><span class="p">)</span><span class="nv">$o</span><span class="p">;</span>            <span class="c1">// keys are re-cast just like array keys
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nx">var_export</span><span class="p">(</span><span class="nv">$b</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="cm">/* Result: numeric string -&gt; 42, float -&gt; 1, true -&gt; 1, null -&gt; &#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="cm">array (
</span></span></span><span class="line"><span class="cl"><span class="cm">  42 =&gt; &#39;x&#39;,
</span></span></span><span class="line"><span class="cl"><span class="cm">  1 =&gt; &#39;y&#39;,   // overwrote true =&gt; 1
</span></span></span><span class="line"><span class="cl"><span class="cm">  &#39;&#39; =&gt; &#39;n&#39;,
</span></span></span><span class="line"><span class="cl"><span class="cm">)*/</span>
</span></span></code></pre></div><h2 id="counting-uncountable-things-is-now-forbidden">
    <a href="#counting-uncountable-things-is-now-forbidden">
	Counting Uncountable Things is now forbidden
    </a>
</h2>
<p>Calling count() on something that is not an array and not Countable now raises a warning.
Guard your calls, or implement <code>Countable</code> on your classes.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="c1">#! /opt/homebrew/bin/php
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="c1">// Before 7.2 this often silently returned 1 or 0 in odd ways.
</span></span></span><span class="line"><span class="cl"><span class="c1">// With 7.2 you get a warning:
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$x</span> <span class="o">=</span> <span class="mi">123</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">var_dump</span><span class="p">(</span><span class="nx">count</span><span class="p">(</span><span class="nv">$x</span><span class="p">));</span>  <span class="c1">// Warning: count(): Parameter must be an array or an object that implements Countable
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nv">$y</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ArrayObject</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="nx">var_dump</span><span class="p">(</span><span class="nx">count</span><span class="p">(</span><span class="nv">$y</span><span class="p">));</span>  <span class="c1">// 3 (Countable)
</span></span></span></code></pre></div><h2 id="object-typehint-for-parameters-and-return-types">
    <a href="#object-typehint-for-parameters-and-return-types">
	Object typehint for parameters and return types
    </a>
</h2>
<p>You can now require an object in signatures, without specifying a particular class or interface.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="c1">#! /opt/homebrew/bin/php
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">declare</span><span class="p">(</span><span class="nx">strict_types</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">touch_object</span><span class="p">(</span><span class="nx">object</span> <span class="nv">$o</span><span class="p">)</span><span class="o">:</span> <span class="nx">object</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// do something with $o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">return</span> <span class="nv">$o</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">C</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">var_dump</span><span class="p">(</span><span class="nx">touch_object</span><span class="p">(</span><span class="k">new</span> <span class="nx">C</span><span class="p">()));</span>
</span></span></code></pre></div><h2 id="cryptography-updates">
    <a href="#cryptography-updates">
	Cryptography updates
    </a>
</h2>
<ul>
<li>allow Argon2 in <code>password_\*</code> functions.</li>
<li>Sane TLS defaults</li>
<li>Removal of abandoned <code>mcrypt</code> extension.</li>
<li>Add <code>sodium</code> as a core extension.</li>
</ul>
<h2 id="trailing-commas-in-list">
    <a href="#trailing-commas-in-list">
	Trailing commas in <code>list()</code>
    </a>
</h2>
<p>You can finally add a trailing comma in list() and array destructuring, which makes diffs cleaner.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="c1">#! /opt/homebrew/bin/php
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="nv">$a</span><span class="p">,</span> <span class="nv">$b</span><span class="p">,]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="k">list</span><span class="p">(</span><span class="nv">$x</span><span class="p">,</span> <span class="nv">$y</span><span class="p">,)</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="nx">var_dump</span><span class="p">(</span><span class="nv">$a</span><span class="p">,</span> <span class="nv">$b</span><span class="p">,</span> <span class="nv">$x</span><span class="p">,</span> <span class="nv">$y</span><span class="p">);</span>
</span></span></code></pre></div><h1 id="73-2018">
    <a href="#73-2018">
	7.3 (2018)
    </a>
</h1>
<h2 id="flexible-heredocnowdoc-indentation">
    <a href="#flexible-heredocnowdoc-indentation">
	Flexible heredoc/nowdoc indentation
    </a>
</h2>
<p>Heredoc and nowdoc syntax became more flexible.
You can indent the closing identifier and the content will be de‑indented accordingly,
making multi‑line strings easier to embed in indented code.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="c1">#! /opt/homebrew/bin/php
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">declare</span><span class="p">(</span><span class="nx">strict_types</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">emailBody</span><span class="p">(</span><span class="nx">string</span> <span class="nv">$name</span><span class="p">)</span><span class="o">:</span> <span class="nx">string</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$indent</span> <span class="o">=</span> <span class="s2">&#34;    &#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$body</span> <span class="o">=</span> <span class="s">&lt;&lt;&lt;</span><span class="dl">MAIL</span><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">        Hello $name,
</span></span></span><span class="line"><span class="cl"><span class="s">        
</span></span></span><span class="line"><span class="cl"><span class="s">        this is an indented heredoc.
</span></span></span><span class="line"><span class="cl"><span class="s">        The indentation before the closing marker is ignored.
</span></span></span><span class="line"><span class="cl"><span class="s">        
</span></span></span><span class="line"><span class="cl"><span class="s">        Regards,
</span></span></span><span class="line"><span class="cl"><span class="s">        Admin
</span></span></span><span class="line"><span class="cl"><span class="s">        </span><span class="dl">MAIL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nv">$body</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nx">emailBody</span><span class="p">(</span><span class="s2">&#34;Kris&#34;</span><span class="p">),</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span></code></pre></div><h2 id="trailing-commas-in-function-calls">
    <a href="#trailing-commas-in-function-calls">
	Trailing commas in function calls
    </a>
</h2>
<p>You can add a trailing comma to function and method calls.
This helps with cleaner diffs when adding more arguments.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="c1">#! /opt/homebrew/bin/php
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">sum</span><span class="p">(</span><span class="nv">$a</span><span class="p">,</span> <span class="nv">$b</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nv">$a</span> <span class="o">+</span> <span class="nv">$b</span> <span class="o">+</span> <span class="nv">$c</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Note the trailing comma after the last argument
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">var_dump</span><span class="p">(</span><span class="nx">sum</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">3</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">));</span>
</span></span></code></pre></div><h2 id="json_throw_on_error">
    <a href="#json_throw_on_error">
	JSON_THROW_ON_ERROR
    </a>
</h2>
<p><code>json_encode()</code> and <code>json_decode()</code> can now throw <code>JsonException</code>
instead of returning false and setting <code>json_last_error()</code>.
\Use the <code>JSON_THROW_ON_ERROR</code> flag.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="c1">#! /opt/homebrew/bin/php
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">declare</span><span class="p">(</span><span class="nx">strict_types</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$broken</span> <span class="o">=</span> <span class="s2">&#34;{ invalid json }&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">json_decode</span><span class="p">(</span><span class="nv">$broken</span><span class="p">,</span> <span class="k">true</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="nx">JSON_THROW_ON_ERROR</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">JsonException</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;Decoding failed: &#34;</span><span class="p">,</span> <span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">(),</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$data</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;a&#34;</span> <span class="o">=&gt;</span> <span class="nx">INF</span><span class="p">];</span> <span class="c1">// not representable in JSON by default
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">json_encode</span><span class="p">(</span><span class="nv">$data</span><span class="p">,</span> <span class="nx">JSON_THROW_ON_ERROR</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">JsonException</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;Encoding failed: &#34;</span><span class="p">,</span> <span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">(),</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h2 id="is_countable">
    <a href="#is_countable">
	is_countable()
    </a>
</h2>
<p>A helper to check if a value is countable before calling <code>count()</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="c1">#! /opt/homebrew/bin/php
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nv">$x</span> <span class="o">=</span> <span class="mi">123</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">var_dump</span><span class="p">(</span><span class="nx">is_countable</span><span class="p">(</span><span class="nv">$x</span><span class="p">));</span> <span class="c1">// false
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">var_dump</span><span class="p">(</span><span class="nx">is_countable</span><span class="p">(</span><span class="nv">$y</span><span class="p">));</span> <span class="c1">// true
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">is_countable</span><span class="p">(</span><span class="nv">$x</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="nx">count</span><span class="p">(</span><span class="nv">$x</span><span class="p">),</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h1 id="74-2019">
    <a href="#74-2019">
	7.4 (2019)
    </a>
</h1>
<h2 id="typed-properties">
    <a href="#typed-properties">
	Typed properties
    </a>
</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="c1">#! /opt/homebrew/bin/php
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">declare</span><span class="p">(</span><span class="nx">strict_types</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Counter</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nx">int</span> <span class="nv">$count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>      <span class="c1">// typed property
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">private</span> <span class="o">?</span><span class="nx">string</span> <span class="nv">$name</span> <span class="o">=</span> <span class="k">null</span><span class="p">;</span> <span class="c1">// nullable type
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$c</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Counter</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$c</span><span class="o">-&gt;</span><span class="na">count</span> <span class="o">=</span> <span class="mi">42</span><span class="p">;</span>           <span class="c1">// OK
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$c</span><span class="o">-&gt;</span><span class="na">name</span> <span class="o">=</span> <span class="s2">&#34;demo&#34;</span><span class="p">;</span>        <span class="c1">// OK
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// TypeError at runtime (assignment must match declared type)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nv">$c</span><span class="o">-&gt;</span><span class="na">count</span> <span class="o">=</span> <span class="s2">&#34;not an int&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">TypeError</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">(),</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h2 id="arrow-functions-fn">
    <a href="#arrow-functions-fn">
	Arrow functions (fn())
    </a>
</h2>
<p>Short syntax for anonymous functions.
Automatic access to closure values, and to outer values.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="c1">#! /opt/homebrew/bin/php
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">declare</span><span class="p">(</span><span class="nx">strict_types</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$factor</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$nums</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="nv">$doubled</span> <span class="o">=</span> <span class="nx">array_map</span><span class="p">(</span><span class="nx">fn</span><span class="p">(</span><span class="nx">int</span> <span class="nv">$n</span><span class="p">)</span><span class="o">:</span> <span class="nx">int</span> <span class="o">=&gt;</span> <span class="nv">$n</span> <span class="o">*</span> <span class="nv">$factor</span><span class="p">,</span> <span class="nv">$nums</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">print_r</span><span class="p">(</span><span class="nv">$doubled</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">// [2, 4, 6]
</span></span></span></code></pre></div><h2 id="spread-operator-in-array-expressions">
    <a href="#spread-operator-in-array-expressions">
	Spread operator in array expressions
    </a>
</h2>
<p>You can unpack arrays into other arrays using <code>...</code>.
In PHP 7.4 only arrays with numeric keys can be spread (string keys are supported from 8.1).</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="c1">#! /opt/homebrew/bin/php
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">declare</span><span class="p">(</span><span class="nx">strict_types</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="nv">$b</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">...</span><span class="nv">$a</span><span class="p">,</span> <span class="mi">4</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="nx">print_r</span><span class="p">(</span><span class="nv">$b</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">// [1, 2, 3, 4]
</span></span></span></code></pre></div><h2 id="limited-covariance-and-contravariance">
    <a href="#limited-covariance-and-contravariance">
	Limited covariance and contravariance
    </a>
</h2>
<p>Return types may be more specific (covariant),
parameter types may be more general (contravariant) in child (subclass) methods.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="c1">#! /opt/homebrew/bin/php
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">declare</span><span class="p">(</span><span class="nx">strict_types</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Base</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">getIterator</span><span class="p">()</span><span class="o">:</span> <span class="nx">Traversable</span> <span class="p">{</span> <span class="k">return</span> <span class="k">new</span> <span class="nx">ArrayIterator</span><span class="p">([]);</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">setIterator</span><span class="p">(</span><span class="nx">Iterator</span> <span class="nv">$it</span><span class="p">)</span><span class="o">:</span> <span class="nx">void</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Child</span> <span class="k">extends</span> <span class="nx">Base</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// Return type covariance: Traversable -&gt; Iterator (more specific)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">getIterator</span><span class="p">()</span><span class="o">:</span> <span class="nx">Iterator</span> <span class="p">{</span> <span class="k">return</span> <span class="k">new</span> <span class="nx">ArrayIterator</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]);</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// Param type contravariance: Iterator -&gt; Traversable (more general)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">setIterator</span><span class="p">(</span><span class="nx">Traversable</span> <span class="nv">$it</span><span class="p">)</span><span class="o">:</span> <span class="nx">void</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$child</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Child</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nx">var_dump</span><span class="p">(</span><span class="nx">get_class</span><span class="p">(</span><span class="nv">$child</span><span class="o">-&gt;</span><span class="na">getIterator</span><span class="p">()));</span> <span class="c1">// ArrayIterator
</span></span></span></code></pre></div><h2 id="numeric-literal-separator-_">
    <a href="#numeric-literal-separator-_">
	Numeric literal separator <code>_</code>
    </a>
</h2>
<p>Use underscores in numeric literals for readability.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="c1">#! /opt/homebrew/bin/php
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">declare</span><span class="p">(</span><span class="nx">strict_types</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$oneMillion</span> <span class="o">=</span> <span class="mi">1_000_000</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$hex</span> <span class="o">=</span> <span class="mh">0xFF_FF</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$bin</span> <span class="o">=</span> <span class="mi">0</span><span class="nx">b1010_1010</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">var_dump</span><span class="p">(</span><span class="nv">$oneMillion</span><span class="p">,</span> <span class="nv">$hex</span><span class="p">,</span> <span class="nv">$bin</span><span class="p">);</span>
</span></span></code></pre></div><h2 id="null-coalescing-assignment-operator-">
    <a href="#null-coalescing-assignment-operator-">
	Null coalescing assignment operator (??=)
    </a>
</h2>
<p>Shorthand to assign a default only if the variable is null or not set.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="c1">#! /opt/homebrew/bin/php
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">declare</span><span class="p">(</span><span class="nx">strict_types</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$options</span> <span class="o">=</span> <span class="p">[];</span>
</span></span><span class="line"><span class="cl"><span class="nv">$options</span><span class="p">[</span><span class="s1">&#39;timeout&#39;</span><span class="p">]</span> <span class="o">??=</span> <span class="mi">30</span><span class="p">;</span> <span class="c1">// sets to 30 because key is not set
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$options</span><span class="p">[</span><span class="s1">&#39;timeout&#39;</span><span class="p">]</span> <span class="o">??=</span> <span class="mi">10</span><span class="p">;</span> <span class="c1">// keeps 30, because already set and not null
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">var_dump</span><span class="p">(</span><span class="nv">$options</span><span class="p">);</span>
</span></span></code></pre></div><h2 id="weak-references">
    <a href="#weak-references">
	Weak references
    </a>
</h2>
<p>Hold references to objects that do not prevent their garbage collection.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="c1">#! /opt/homebrew/bin/php
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">declare</span><span class="p">(</span><span class="nx">strict_types</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$o</span> <span class="o">=</span> <span class="k">new</span> <span class="k">stdClass</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$wr</span> <span class="o">=</span> <span class="nx">WeakReference</span><span class="o">::</span><span class="na">create</span><span class="p">(</span><span class="nv">$o</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">var_dump</span><span class="p">(</span><span class="nv">$wr</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">()</span> <span class="o">!==</span> <span class="k">null</span><span class="p">);</span> <span class="c1">// true
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">unset</span><span class="p">(</span><span class="nv">$o</span><span class="p">);</span>                      <span class="c1">// drop the strong reference
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">var_dump</span><span class="p">(</span><span class="nv">$wr</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">()</span> <span class="o">===</span> <span class="k">null</span><span class="p">);</span>  <span class="c1">// true (target was collected)
</span></span></span></code></pre></div><h2 id="preloading-opcache">
    <a href="#preloading-opcache">
	Preloading (Opcache)
    </a>
</h2>
<p>Allows loading PHP files into Opcache on server startup
so classes/functions are available to all requests without requiring them each time.</p>
<ul>
<li>php.ini:</li>
</ul>
<pre tabindex="0"><code>opcache.preload=/path/to/preload.php
opcache.preload_user=www-data
</code></pre><ul>
<li>preload.php:</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nx">opcache_compile_file</span><span class="p">(</span><span class="no">__DIR__</span> <span class="o">.</span> <span class="s1">&#39;/src/Autoload.php&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">opcache_compile_file</span><span class="p">(</span><span class="no">__DIR__</span> <span class="o">.</span> <span class="s1">&#39;/src/Domain/Model.php&#39;</span><span class="p">);</span>
</span></span></code></pre></div><h2 id="deprecations-in-74-selection">
    <a href="#deprecations-in-74-selection">
	Deprecations in 7.4 (selection)
    </a>
</h2>
<ul>
<li>Curly brace array/string offset access: <code>$str{0}</code> and <code>$arr{0}</code> — use <code>$str[0]</code>, <code>$arr[0]</code>.</li>
<li>Nested ternary without explicit parentheses emits a deprecation warning.</li>
<li>Real type alias <code>real</code> is deprecated; use <code>float</code>.</li>
<li><code>implode()</code> parameter order confusion warnings (use implode(string $glue, array $pieces)).</li>
</ul>
<p>See PHP 7.4 RFCs for the full list: <a href="https://wiki.php.net/rfc#php_74" target="_blank" rel="noopener">https://wiki.php.net/rfc#php_74</a>

</p>

			</div>
		</div>

		
		
		<div class='row justify-content-center py-3 mb-3 mx-0'>
			<div class='col-lg-8 text-center'>
				<span class='letter-spacing-01 text-uppercase text-secondary me-2'>Tags</span>
				
				<a href="/tags/#php" class='btn btn-sm btn-outline-primary mb-1'>
				<svg class="bi" width="1rem" height="1rem" fill="currentColor">
					<use xlink:href="/bootstrap-icons.svg#tag-fill"></use>
				</svg>
				php
				</a>
				
				<a href="/tags/#lang_en" class='btn btn-sm btn-outline-primary mb-1'>
				<svg class="bi" width="1rem" height="1rem" fill="currentColor">
					<use xlink:href="/bootstrap-icons.svg#tag-fill"></use>
				</svg>
				lang_en
				</a>
				
			</div>
		</div>

		
		
		
		
		<div class='row justify-content-center py-3 mb-3 mx-0'>
			<div class='col-lg-8 text-center'>
				<a href="https://github.com/isotopp/isotopp.github.io/edit/main/content/posts/2025-07-30-modern-php.md"
				   rel="noopener noreferrer" target="_blank">
					<span class='letter-spacing-01 text-uppercase text-secondary me-2'>Suggest Changes</span>
				</a>
			</div>
		</div>
		

		<div class='row justify-content-center mx-0'>
			<div class='col-lg-4 text-center text-lg-start'>
				
				<div>
					<div class='letter-spacing-01 text-uppercase text-secondary'>
						Previous Post
					</div>
					<a class='text-decoration-none' href="https://blog.koehntopp.info/2025/07/30/modern-php-2.html">Modern PHP (8.x)</a>
				</div>
				
			</div>

			<div class='col-lg-4 text-lg-end mt-5 mt-lg-0 text-center'>
				
				<div>
					<div class='letter-spacing-01 text-uppercase text-secondary'>
						Next Post
					</div>
					<a class='text-decoration-none' href="https://blog.koehntopp.info/2025/08/10/two-years-megane.html">Two Years Megane</a>
				</div>
				
			</div>
		</div>


		
	</article>
</div>



            <footer class='row justify-content-center mb-4 pb-4 mx-0'>
  <div class='col-8 text-center'>
    <div>
      A collection of old stuff, new stuff and random stuff.
    </div>
    <div class='row text-primary mt-4'>
      <div class='col'>

        <a href='/feed.xml' title='Follow RSS feed' class='me-3 text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#rss-fill'/>
          </svg>
        </a>

        <a href='mailto:kristian.koehntopp@gmail.com' title='Email' class='me-3 text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#envelope'/>
          </svg>
        </a>

        <a href='https://github.com/isotopp' title='Follow on GitHub' class='me-3 text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#github'/>
          </svg>
        </a>

        <a rel="me" href="https://infosec.exchange/@isotopp" title='Follow on Mastodon' class='me-3 text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#mastodon'/>
          </svg>
        </a>

        
        <a href='http://steamcommunity.com/id/ixotopp' title='Follow on Steam' class='me-3 text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#steam'/>
          </svg>
        </a>

        

        <a href='https://www.youtube.com/user/isotopp' title='Follow on YouTube' class=''>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#youtube'/>
          </svg>
        </a>
      </div>
    </div>
  </div>
</footer>


        </main>

	





<script src="https://blog.koehntopp.info/js/bootstrap.js"></script>




<script src="https://blog.koehntopp.info/js/lunr.js"></script>





<script src="https://blog.koehntopp.info/js/app.js"></script>


    </body>
</html>
