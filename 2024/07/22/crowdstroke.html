<!doctype html>
<html lang="en">
    <head>
    <meta charset="utf-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<title>Crowdstroke | Die wunderbare Welt von Isotopp</title>
<meta name="description" content="Kris Köhntopp&#39;s blog (Fedi: @isotoppinfosec.exchange)">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" href="icon.png">
<link rel="icon" href="favicon.ico" type="image/ico">
<link rel="shortcut icon" href="favicon.ico">
<link rel="canonical" href="https://blog.koehntopp.info/2024/07/22/crowdstroke.html">

<link rel="alternate" type="application/rss+xml" href='https://blog.koehntopp.info/feed.xml' title="Die wunderbare Welt von Isotopp">
<link rel="alternate" type="application/rss+xml" href='https://blog.koehntopp.info/tags/mysql/feed.xml' title="Feed: mysql Articles for Die wunderbare Welt von Isotopp">
<link rel="alternate" type="application/rss+xml" href='https://blog.koehntopp.info/tags/review/feed.xml' title="Feed: review Articles for Die wunderbare Welt von Isotopp">


<meta name="generator" content="Hugo 0.145.0">
<meta property="og:title" content='Crowdstroke | Die wunderbare Welt von Isotopp' />
<meta property="og:site_name" content='Die wunderbare Welt von Isotopp' />
<meta property="og:locale" content="en_US" />
<meta name="description" content='What can we learn from the Crowdstroke fail?' />
<meta property="og:description" content='What can we learn from the Crowdstroke fail?' />
<meta property="og:url" content="https://blog.koehntopp.info/2024/07/22/crowdstroke.html" />
<meta property="og:type" content="article" />
<meta name="article:published_time" content='2024-07-22T04:05:06Z' />
<meta name="fediverse:creator" content="@isotopp@infosec.exchange">
<meta property="og:image" content='https://blog.koehntopp.info/assets/img/background/schloss.jpg' />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:creator" content='@isotopp@infosec.exchange' />
<meta property="twitter:title" content='Crowdstroke' />
<meta property="twitter:description" content='What can we learn from the Crowdstroke fail?' />
<meta property="twitter:image" content='https://blog.koehntopp.info/assets/img/background/schloss.jpg' />


    



<link rel="stylesheet" href="https://blog.koehntopp.info/style.min.dd9d518fe6cac55191b6af874e18327dff051055754ffc7e106131baf826e6d3.css">


    </head>
    <body>
        

        <nav class="navbar navbar-expand-lg navbar-light px-lg-4 pt-lg-4">
    <div class="container-fluid">
        <a class="navbar-brand justify-content-center" href="https://blog.koehntopp.info/" rel="home" title="Die wunderbare Welt von Isotopp">
            <img alt="Kris" height='48' width='48' src='/assets/img/avatars/isotopp.jpg' class='p-0 me-3 d-block d-lg-inline'>
            <span class='h4 d-block d-lg-inline'>Die wunderbare Welt von Isotopp</span>
        </a>

        <button class="navbar-toggler ms-auto" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse text-center" id="navbarSupportedContent">
            <ul class="navbar-nav ms-auto">
                
                <li class="nav-item ">
                    <a class="nav-link" href="/about/">
                        <span class="">About</span>
                        
                    </a>
                </li>
                <li class="nav-item ">
                    <a class="nav-link" href="/contribute/">
                        <span class="">Contribute</span>
                        
                    </a>
                </li>
                <li class="nav-item ">
                    <a class="nav-link" href="/search/">
                        <span class=""><svg class='bi' height='1.5rem' width='1.5rem' fill='currentColor'><use xlink:href='/bootstrap-icons.svg#search'/></svg></span>
                        
                    </a>
                </li>
                <li class="nav-item ">
                    <a class="nav-link" href="/tags/">
                        <span class=""><svg class='bi' width='1.5rem' height='1.5rem' fill='currentColor'><use xlink:href='/bootstrap-icons.svg#tags-fill'/></svg></span>
                        
                    </a>
                </li>
                
            </ul>
            
        </div>

    </div>
</nav>


        <main role="main" class="container-fluid p-0">

            









<div class="page">
	<article class="crowdstroke-page">
		<div class='row  justify-content-center text-center my-4 mx-0'>
			<header class="headerbanner">
				<div class='col'>
					<h1 class="title mb-lg-4 text-white">
						Crowdstroke
					</h1>
					<div class='text-uppercase text-light' style='letter-spacing: 0.1rem;'>
						<img alt='@isotopp@infosec.exchange image' src='/assets/img/avatars/isotopp.jpg' class='me-1 p-0'
						     style='width: 1.9rem; border-radius: 1rem;'>
						<a href="https://infosec.exchange/@isotopp" class='text-light text-decoration-none'>
							Kristian Köhntopp
						</a>
						
						<span class='d-none d-lg-inline'>-</span>
						<div class='d-block d-lg-inline'>July 22, 2024</div>
						
					</div>
				</div>
				
				<img alt='a featured image' src="/assets/img/background/schloss.jpg">
				
			</header>
		</div>

		<div class='row justify-content-center mx-0'>
			<div class='col-lg-4 text-center text-lg-start'>
				
				<div>
					<div class='letter-spacing-01 text-uppercase text-secondary'>
						Previous Post
					</div>
					<a class='text-decoration-none' href="https://blog.koehntopp.info/2024/07/16/energy.html">Power (and Energy)</a>
				</div>
				
			</div>

			<div class='col-lg-4 text-lg-end mt-5 mt-lg-0 text-center'>
				
				<div>
					<div class='letter-spacing-01 text-uppercase text-secondary'>
						Next Post
					</div>
					<a class='text-decoration-none' href="https://blog.koehntopp.info/2024/07/23/mysql-upgrading-old-mysql-instances.html">MySQL: Upgrading old MySQL instances</a>
				</div>
				
			</div>
		</div>

		<div class='row justify-content-center mx-0 mt-3 mb-5'>
			<div class="col-lg-8 mb-3">
				
				<header class="toc bg-light">
					<nav id="TableOfContents">
  <ul>
    <li><a href="#some-takes">Some Takes</a>
      <ul>
        <li><a href="#crowdstrike">Crowdstrike</a></li>
        <li><a href="#martin-seeger">Martin Seeger</a></li>
        <li><a href="#kevin-beaumont">Kevin Beaumont</a></li>
        <li><a href="#manuel-atug">Manuel Atug</a></li>
        <li><a href="#lennart-poettering">Lennart Poettering</a></li>
        <li><a href="#stefan-eissing">Stefan Eissing</a></li>
      </ul>
    </li>
    <li><a href="#learnings">Learnings</a>
      <ul>
        <li><a href="#windows">Windows</a></li>
        <li><a href="#crowdstrike-1">Crowdstrike</a></li>
        <li><a href="#enterprises">Enterprises</a></li>
      </ul>
    </li>
  </ul>
</nav>
				</header>
				
			</div>
			<div class='col-lg-8'>
				<p>This is the Monday after the Friday
when Crowdstrike took out a good 1% of all Windows machines worldwide with a botched update.</p>
<h1 id="some-takes">
    <a href="#some-takes">
	Some Takes
    </a>
</h1>
<p><p class="md__image">
  <img src="/uploads/2024/07/crowdstroke-01.png" alt=""  />
</p>

</p>
<h2 id="crowdstrike">
    <a href="#crowdstrike">
	Crowdstrike
    </a>
</h2>
<p>The company did release a statement with
&ldquo;<a href="https://www.crowdstrike.com/blog/falcon-update-for-windows-hosts-technical-details/" target="_blank" rel="noopener">Technical Details</a>

&rdquo;.
This is a big nothingburger.
They are confirming what we already knew.
Nothing is said about the server side, root causes and the chain of process failures that led to this incident.</p>
<h2 id="martin-seeger">
    <a href="#martin-seeger">
	Martin Seeger
    </a>
</h2>
<p>Martin Seeger compares this to the XZ Incident in Open Source in
<a href="https://infosec.exchange/@masek/112817758224618946" target="_blank" rel="noopener">a post</a>

:</p>
<blockquote>
<p>We are now at t+26h.
Please compare
how much we knew about the xz-attack after less than a day with what
we know about the chain of events of giant outage yesterday.</p>
<p>If something similar had been caused by an OSS component,
we would see congress discussing a ban on open software in critical infrastructure already.</p></blockquote>
<h2 id="kevin-beaumont">
    <a href="#kevin-beaumont">
	Kevin Beaumont
    </a>
</h2>
<p>Kevin Beaumont gives the kill count in
<a href="https://cyberplace.social/@GossiTheDog/112819549722486621" target="_blank" rel="noopener">another post</a>

:</p>
<blockquote>
<p>Microsoft estimate almost 9 million Windows devices are impacted by the CrowdStrike incident
(likely from crash telemetry).
<a href="https://blogs.microsoft.com/blog/2024/07/20/helping-our-customers-through-the-crowdstrike-outage/" target="_blank" rel="noopener">link to microsoft</a>

</p></blockquote>
<p>But the outage did not affect just any one percent of all Windows machines,
but specifically, the one percent
that due to use in commercial environments with special requirements had Crowdstrike installed.
That is particularly funny, because the
<a href="https://www.crowdstrike.com/terms-and-conditions-de/" target="_blank" rel="noopener">ToS of Crowdstrike</a>


says &ldquo;not liable, not highly available, not suitable for anything important, and by the way, you are on your own&rdquo;.
I am sure this will be contested in court,
but in any case, the liability clauses of anything else in the market are very similar.</p>
<h2 id="manuel-atug">
    <a href="#manuel-atug">
	Manuel Atug
    </a>
</h2>
<p><a href="https://www.linkedin.com/posts/manuel-honkhase-atug-820b27241_crowdstrike-kritis-activity-7220713390443241472-1EMl/" target="_blank" rel="noopener">Manual Atug posts on LinkedIn</a>


about this fact, and the comments section is largely in
<a href="https://en.wikipedia.org/wiki/Five_stages_of_grief" target="_blank" rel="noopener">the denial stage of grief</a>

.
Mostly people resign (&ldquo;All EULA are like this.&rdquo;),
think product liability is never going to be a thing,
and even ask how they are supposed to test this, or implement staggered rollouts for AV and endpoint security updates.</p>
<p>That is not how KRITIS works.
If an outage on a desktop can affect flight operations or supermarket cash registers,
the desktops are in scope.
And the Crowdstrike outage, on the desktop, had an impact on travel, sales and other systems.
That means it&rsquo;s in scope, and the testing, rollout and EULA are not adequate.</p>
<h2 id="lennart-poettering">
    <a href="#lennart-poettering">
	Lennart Poettering
    </a>
</h2>
<p>Windows itself is badly prepared for such an outage.
Lennart Poettering (somewhat smugly)
<a href="https://mastodon.social/@pid_eins/112818864687187963" target="_blank" rel="noopener">in a post</a>


points out that</p>
<blockquote>
<p>So, if you ask me what my takeaway from the Crowdstrike issue is, I&rsquo;d say:
boot counting/boot assessment/automatic fallback should really be a MUST for today&rsquo;s systems.
Before* you invoke your first kernel you need
have tracking of boot attempts and a logic for falling back to older versions automatically.
It&rsquo;s a major shortcoming that this is not default behaviour of today&rsquo;s distros, in particular commercial ones.</p>
<p>Of course systemd has supported this for a long time:
<a href="https://systemd.io/AUTOMATIC_BOOT_ASSESSMENT/" target="_blank" rel="noopener">Automatic Boot Assessment</a>

</p></blockquote>
<p>Windows does not do that, but Linux could.
If commercial Linux distros were to use this feature.</p>
<p>MacOS also would not have been affected.
Apple prohibits security software implemented as device drivers,
because they <a href="/2018/06/18/websense-dlp-gives-instant-root.html">tend to be flawed</a>

.
Instead, Apple provides a framework, System Extensions,
in which a non-privileged process can run a security scanning process safely and in a way
where a crash does not take down the system.
Microsoft claims they can&rsquo;t provide this
because due to contracts with the EU they are bound to give security vendors the same API as they are using themselves.
That is, of course, bullshit.
Defender could use such an API, and then everybody else would have to, as well, because that <em>is</em> the API.</p>
<h2 id="stefan-eissing">
    <a href="#stefan-eissing">
	Stefan Eissing
    </a>
</h2>
<p>Stefan Eissing describes what the <a href="">mod_md</a>

 certificate renewal process does.</p>
<p>Apache mod_md is a module for the Apache web server that implements the ACME protocol as spoken by Let&rsquo;s Encrypt.
Here is how he <a href="https://chaos.social/@icing/112829370177074835" target="_blank" rel="noopener">describes the update</a>

:</p>
<blockquote>
<p>How Apache ACME (mod_md) gets you a new certificate:</p>
<ol>
<li>all ACME communication are done as unprivileged user</li>
<li>all certificates from the CA are parsed as unprivileged user before storing them</li>
<li>activation, as privileged user, parses again before replacing production as a last fail safe.</li>
</ol>
<p>Since 2017.</p>
<p>Typical over-engineering. What are the chances a CA sends you a borked file?</p></blockquote>
<p>This is what Crowdstrike did not do, in the client.</p>
<p>So, what can we learn, not having a proper Root Cause Analysis from the vendor, four days later?</p>
<h1 id="learnings">
    <a href="#learnings">
	Learnings
    </a>
</h1>
<h2 id="windows">
    <a href="#windows">
	Windows
    </a>
</h2>
<ul>
<li>Windows does not offer the equivalent of the macOS System Extension API,
in which an iterator for files is provided by the OS
and all security software is running with System Extension Capability,
but as an otherwise unprivileged user.</li>
<li>Windows does not offer the equivalent of the Linux eBPF framework,
which allows vendors to implement probes in a safer, less intrusive and more resilient way than using raw C.</li>
<li>Windows does not protect against recoverable device driver crashes such as Linux (Kernel Oops vs. Kernel Crash).</li>
<li>Windows does not do automatic Boot Assessment and Rollback,
and manual rollback is complicated with disk encryption deployed.</li>
</ul>
<h2 id="crowdstrike-1">
    <a href="#crowdstrike-1">
	Crowdstrike
    </a>
</h2>
<ul>
<li>Crowdstrike implements a kernel process or driver,
which parses config files in a privileged kernel context which can lead to crash on boot
(which is remediated by deleting a config file)
<ul>
<li>This is a bad architecture from the 1990ies.</li>
<li>Crowdstrike could implement a &ldquo;System Extension&rdquo; like static driver themselves,
and run the analysis in an unprivileged user account.
They do not have to wait for Microsoft for such an API.</li>
</ul>
</li>
<li>Crowdstrike seems to use C or C++ instead of a memory safe language such as Rust.
<ul>
<li>Crashing a Rust-written driver in the way demonstrated would be much harder.</li>
</ul>
</li>
<li>There is no public documentation on the functioning, configuration or the data processed by Crowdstrike in their cloud.
It is weird that this can be even done in the EU, being GDPR-compliant and all.</li>
</ul>
<h2 id="enterprises">
    <a href="#enterprises">
	Enterprises
    </a>
</h2>
<ul>
<li>Enterprises roll out such updates in an uncontrolled way.
No local testing, no staggered rollouts.
Complete absence of a proper Change Management process.</li>
<li>The fact
that large Enterprises operating KRITIS have fired thousands of employees within the last 12 months also contributed,
for example, by the inability to implement proper testing and staggered rollout.
Non-functional decisions have functional consequences.
Enterprises have lost critical institutional knowledge and functional execution capabilities.</li>
<li>Enterprises use such software in the critical path of KRITIS systems.
While not directly in regulated OT, the outage did affect the proper functioning of KRITIS systems,
and is therefore in scope.
<ul>
<li>This also suggests <a href="/2023/02/18/this-is-not-a-drill.html">inadequate BCM testing</a>

.</li>
</ul>
</li>
</ul>
<p>In summary,
we are observing a multilateral process breakdown leading to a KRITIS outage,
indicating that we do have compliance driven architecture instead of an actual security process.</p>
<p>See also: <a href="/2024/02/10/snake-oil.html">Snake Oil</a>

,
especially the guinea pig at the end.
Some things can only be made bearable with cute guinea pig photos.</p>

			</div>
		</div>

		
		
		<div class='row justify-content-center py-3 mb-3 mx-0'>
			<div class='col-lg-8 text-center'>
				<span class='letter-spacing-01 text-uppercase text-secondary me-2'>Tags</span>
				
				<a href="/tags/#lang_en" class='btn btn-sm btn-outline-primary mb-1'>
				<svg class="bi" width="1rem" height="1rem" fill="currentColor">
					<use xlink:href="/bootstrap-icons.svg#tag-fill"></use>
				</svg>
				lang_en
				</a>
				
				<a href="/tags/#security" class='btn btn-sm btn-outline-primary mb-1'>
				<svg class="bi" width="1rem" height="1rem" fill="currentColor">
					<use xlink:href="/bootstrap-icons.svg#tag-fill"></use>
				</svg>
				security
				</a>
				
				<a href="/tags/#computer" class='btn btn-sm btn-outline-primary mb-1'>
				<svg class="bi" width="1rem" height="1rem" fill="currentColor">
					<use xlink:href="/bootstrap-icons.svg#tag-fill"></use>
				</svg>
				computer
				</a>
				
				<a href="/tags/#erklaerbaer" class='btn btn-sm btn-outline-primary mb-1'>
				<svg class="bi" width="1rem" height="1rem" fill="currentColor">
					<use xlink:href="/bootstrap-icons.svg#tag-fill"></use>
				</svg>
				erklaerbaer
				</a>
				
			</div>
		</div>

		
		
		
		
		<div class='row justify-content-center py-3 mb-3 mx-0'>
			<div class='col-lg-8 text-center'>
				<a href="https://github.com/isotopp/isotopp.github.io/edit/main/content/posts/2024-07-22-crowdstroke.md"
				   rel="noopener noreferrer" target="_blank">
					<span class='letter-spacing-01 text-uppercase text-secondary me-2'>Suggest Changes</span>
				</a>
			</div>
		</div>
		

		<div class='row justify-content-center mx-0'>
			<div class='col-lg-4 text-center text-lg-start'>
				
				<div>
					<div class='letter-spacing-01 text-uppercase text-secondary'>
						Previous Post
					</div>
					<a class='text-decoration-none' href="https://blog.koehntopp.info/2024/07/16/energy.html">Power (and Energy)</a>
				</div>
				
			</div>

			<div class='col-lg-4 text-lg-end mt-5 mt-lg-0 text-center'>
				
				<div>
					<div class='letter-spacing-01 text-uppercase text-secondary'>
						Next Post
					</div>
					<a class='text-decoration-none' href="https://blog.koehntopp.info/2024/07/23/mysql-upgrading-old-mysql-instances.html">MySQL: Upgrading old MySQL instances</a>
				</div>
				
			</div>
		</div>


		
	</article>
</div>



            <footer class='row justify-content-center mb-4 pb-4 mx-0'>
  <div class='col-8 text-center'>
    <div>
      A collection of old stuff, new stuff and random stuff.
    </div>
    <div class='row text-primary mt-4'>
      <div class='col'>

        <a href='/feed.xml' title='Follow RSS feed' class='me-3 text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#rss-fill'/>
          </svg>
        </a>

        <a href='mailto:kristian.koehntopp@gmail.com' title='Email' class='me-3 text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#envelope'/>
          </svg>
        </a>

        <a href='https://github.com/isotopp' title='Follow on GitHub' class='me-3 text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#github'/>
          </svg>
        </a>

        <a rel="me" href="https://infosec.exchange/@isotopp" title='Follow on Mastodon' class='me-3 text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#mastodon'/>
          </svg>
        </a>

        
        <a href='http://steamcommunity.com/id/ixotopp' title='Follow on Steam' class='me-3 text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#steam'/>
          </svg>
        </a>

        

        <a href='https://www.youtube.com/user/isotopp' title='Follow on YouTube' class=''>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#youtube'/>
          </svg>
        </a>
      </div>
    </div>
  </div>
</footer>


        </main>

	





<script src="https://blog.koehntopp.info/js/bootstrap.js"></script>




<script src="https://blog.koehntopp.info/js/lunr.js"></script>





<script src="https://blog.koehntopp.info/js/app.js"></script>


    </body>
</html>
