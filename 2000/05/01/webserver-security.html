<!doctype html>
<html lang="en">
    <head>
    <meta charset="utf-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<title>Webserver Security | Die wunderbare Welt von Isotopp</title>
<meta name="description" content="Kris Köhntopp&#39;s blog (Fedi: @isotoppinfosec.exchange)">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" href="icon.png">
<link rel="icon" href="favicon.ico" type="image/ico">
<link rel="shortcut icon" href="favicon.ico">
<link rel="canonical" href="https://blog.koehntopp.info/2000/05/01/webserver-security.html">

<link rel="alternate" type="application/rss+xml" href='https://blog.koehntopp.info/feed.xml' title="Die wunderbare Welt von Isotopp">
<link rel="alternate" type="application/rss+xml" href='https://blog.koehntopp.info/tags/mysql/feed.xml' title="Feed: mysql Articles for Die wunderbare Welt von Isotopp">
<link rel="alternate" type="application/rss+xml" href='https://blog.koehntopp.info/tags/review/feed.xml' title="Feed: review Articles for Die wunderbare Welt von Isotopp">


<meta name="generator" content="Hugo 0.145.0">
<meta property="og:title" content='Webserver Security | Die wunderbare Welt von Isotopp' />
<meta property="og:site_name" content='Die wunderbare Welt von Isotopp' />
<meta property="og:locale" content="de_DE" />
<meta name="description" content='Kris Köhntopp&#39;s blog (Fedi: @isotoppinfosec.exchange)' />
<meta property="og:description" content='Kris Köhntopp&#39;s blog (Fedi: @isotoppinfosec.exchange)' />
<meta property="og:url" content="https://blog.koehntopp.info/2000/05/01/webserver-security.html" />
<meta property="og:type" content="article" />
<meta name="article:published_time" content='2000-05-01T09:00:00Z' />
<meta name="fediverse:creator" content="@isotopp@infosec.exchange">
<meta property="og:image" content='https://blog.koehntopp.info/assets/img/background/rijksmuseum.jpg' />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:creator" content='@isotopp@infosec.exchange' />
<meta property="twitter:title" content='Webserver Security' />
<meta property="twitter:description" content='Kris Köhntopp&#39;s blog (Fedi: @isotoppinfosec.exchange)' />
<meta property="twitter:image" content='https://blog.koehntopp.info/assets/img/background/rijksmuseum.jpg' />


    



<link rel="stylesheet" href="https://blog.koehntopp.info/style.min.dd9d518fe6cac55191b6af874e18327dff051055754ffc7e106131baf826e6d3.css">


    </head>
    <body>
        

        <nav class="navbar navbar-expand-lg navbar-light px-lg-4 pt-lg-4">
    <div class="container-fluid">
        <a class="navbar-brand justify-content-center" href="https://blog.koehntopp.info/" rel="home" title="Die wunderbare Welt von Isotopp">
            <img alt="Kris" height='48' width='48' src='/assets/img/avatars/isotopp.jpg' class='p-0 me-3 d-block d-lg-inline'>
            <span class='h4 d-block d-lg-inline'>Die wunderbare Welt von Isotopp</span>
        </a>

        <button class="navbar-toggler ms-auto" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse text-center" id="navbarSupportedContent">
            <ul class="navbar-nav ms-auto">
                
                <li class="nav-item ">
                    <a class="nav-link" href="/about/">
                        <span class="">About</span>
                        
                    </a>
                </li>
                <li class="nav-item ">
                    <a class="nav-link" href="/contribute/">
                        <span class="">Contribute</span>
                        
                    </a>
                </li>
                <li class="nav-item ">
                    <a class="nav-link" href="/search/">
                        <span class=""><svg class='bi' height='1.5rem' width='1.5rem' fill='currentColor'><use xlink:href='/bootstrap-icons.svg#search'/></svg></span>
                        
                    </a>
                </li>
                <li class="nav-item ">
                    <a class="nav-link" href="/tags/">
                        <span class=""><svg class='bi' width='1.5rem' height='1.5rem' fill='currentColor'><use xlink:href='/bootstrap-icons.svg#tags-fill'/></svg></span>
                        
                    </a>
                </li>
                
            </ul>
            
        </div>

    </div>
</nav>


        <main role="main" class="container-fluid p-0">

            









<div class="page">
	<article class="webserver-security-page">
		<div class='row  justify-content-center text-center my-4 mx-0'>
			<header class="headerbanner">
				<div class='col'>
					<h1 class="title mb-lg-4 text-white">
						Webserver Security
					</h1>
					<div class='text-uppercase text-light' style='letter-spacing: 0.1rem;'>
						<img alt='@isotopp@infosec.exchange image' src='/assets/img/avatars/isotopp.jpg' class='me-1 p-0'
						     style='width: 1.9rem; border-radius: 1rem;'>
						<a href="https://infosec.exchange/@isotopp" class='text-light text-decoration-none'>
							Kristian Köhntopp
						</a>
						
						<span class='d-none d-lg-inline'>-</span>
						<div class='d-block d-lg-inline'>May 1, 2000</div>
						
					</div>
				</div>
				
				<img alt='a featured image' src="/assets/img/background/rijksmuseum.jpg">
				
			</header>
		</div>

		<div class='row justify-content-center mx-0'>
			<div class='col-lg-4 text-center text-lg-start'>
				
				<div>
					<div class='letter-spacing-01 text-uppercase text-secondary'>
						Previous Post
					</div>
					<a class='text-decoration-none' href="https://blog.koehntopp.info/2000/04/14/neu-auf-einem-fremden-system.html">Neu auf einem fremden System</a>
				</div>
				
			</div>

			<div class='col-lg-4 text-lg-end mt-5 mt-lg-0 text-center'>
				
				<div>
					<div class='letter-spacing-01 text-uppercase text-secondary'>
						Next Post
					</div>
					<a class='text-decoration-none' href="https://blog.koehntopp.info/2000/08/21/web-security.html">Web Security</a>
				</div>
				
			</div>
		</div>

		<div class='row justify-content-center mx-0 mt-3 mb-5'>
			<div class="col-lg-8 mb-3">
				
			</div>
			<div class='col-lg-8'>
				<p><strong>aus: iX 5/2000.</strong></p>
<h1 id="webserver-security">
    <a href="#webserver-security">
	Webserver Security
    </a>
</h1>
<p>In den vergangenen Monaten haben Zeitschriften des Heise-Verlages immer wieder über Sicherheitslöcher in Installationen bekannter Serverbetreiber oder Webhoster berichtet.
Offensichtlich existieren tausende von Webanwendungen, die mit heißer Nadel gestrickt und online gebracht worden sind und die - wenn überhaupt - nur unzulänglich getestet worden sind.
Was ist die Ursache der beobachteten Probleme und wie kann man sie für seinen eigenen Server vermeiden?
Kann man als Verbraucher und Benutzer erkennen, ob der Server eines Anbieters elementaren Qualitätsanforderungen an die Sicherheit im Web genügt?</p>
<p>Eine Analyse der gemeldeten Fehler zeigt, daß sich die weitaus meisten Probleme in nur drei Fehlerklassen einteilen lassen:</p>
<ul>
<li>Der Server bietet zu viele Dienste an.</li>
<li>Der Server lagert vertrauliche Daten in zugänglichen Verzeichnissen.</li>
<li>Der Server vertraut Eingabeparametern aus Webformularen ohne Grund.</li>
</ul>
<h2 id="ein-server-bietet-zu-viele-dienste-an">
    <a href="#ein-server-bietet-zu-viele-dienste-an">
	Ein Server bietet zu viele Dienste an
    </a>
</h2>
<p>Häufig hat sich ein Betreiber einer Maschine seinen Server noch niemals mit einem der gängigen Portscanner von außen angesehen und läßt auf seinem Server Dienste laufen, die für die Benutzung der Anwendung nicht benötigt werden oder nicht von allen IP-Adressen aus zugänglich sein müssen.
Ein prominentes Beispiel der vergangenen Wochen, über das wir berichteten war ein Server, der vollständig ohne Firewall betrieben wurde und nach außen komplette Dateisysteme mit dem Sun Network Filesystem exportierte und dessen Oracle Server von jedermann kontaktiert werden konnte.
Praktischerweise fanden sich die für Oracle benötigten Paßworte auf den exportierten Netzwerklaufwerken.</p>
<p>Oft wird dieser Fehler mit der Verwendung unsicherer und abhörbarer Übertragungsprotokolle für Wartungszugänge kombiniert:
So findet man oft auf Webserver auch POP3-Zugänge zum Abruf von Bestellmails, FTP-Zugänge zum Upload von neuen Webseiten oder gar Datenbankzugänge zum Upload neuer Bestandsdaten.
Diese Protokolle bieten vielfach nur unzulängliche Verschlüsselung von Benutzernamen und Paßworten an, von einer Verschlüsselung der eigentlichen Nutzdaten ganz zu schweigen - der msql-Datenbankserver zum Beispiel bietet nur rudimentäre bis gar keine Sicherung des Zugangs an, FTP und POP3 übertragen Paßworte oft unverschlüsselt.</p>
<p>Ein Webmaster ist gut beraten, sich einen Zugang außerhalb seines eigentlichen Providers und Webmasters zu besorgen und sich seinen eigenen Server einmal mit den Augen und Tools eines Angreifers anzusehen.
Oft ist es so, daß Dienste in der Default-Konfiguration der Servermaschine ab Werk enthalten sind, die vom Serverbetreiber nicht erkannt und nicht abgeschaltet worden sind.
Beliebte Fehlerquellen sind zum Beispiel Webserver auf Nichtstandardports, die die Handbücher des Systems anbieten.
Diese Server enthalten sehr oft fehlerhafte CGI-Scripte oder können auf andere Weise zum Sicherheitsrisiko werden.
Eine andere beliebte Fehlerquelle ist der SNMP-Dienst (Simple Network Management Protocol), der einem potenziellen Angreifer viele Informationen über das Zielsystem liefert.
Auch Dienste, die nur zur Erstinstallation benötigt wurden, werden oft vergessen und für den Wirkbetrieb nicht abgeschaltet.</p>
<p>Natürlich muß nicht nur der Webserver geschützt werden: Auch alle anderen Maschinen, die außerhalb der Firewall im Produktions-LAN stehen, müssen denselben Sicherheitslevel erfüllen.</p>
<h2 id="nmap-scan-">
    <a href="#nmap-scan-">
	nmap-Scan (<a href="http://www.insecure.org/nmap/" target="_blank" rel="noopener">http://www.insecure.org/nmap/</a>

)
    </a>
</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> nmap -sS -T Agressive -p 1-10000 www.beispiel1.de<span class="p">|</span> grep open
</span></span><span class="line"><span class="cl"><span class="go">Port    State       Protocol  Service
</span></span></span><span class="line"><span class="cl"><span class="go">21      open        tcp       ftp
</span></span></span><span class="line"><span class="cl"><span class="go">22      open        tcp       ssh
</span></span></span><span class="line"><span class="cl"><span class="go">25      open        tcp       smtp
</span></span></span><span class="line"><span class="cl"><span class="go">80      open        tcp       http
</span></span></span><span class="line"><span class="cl"><span class="go">111     open        tcp       sunrpc
</span></span></span><span class="line"><span class="cl"><span class="go">119     open        tcp       nntp
</span></span></span><span class="line"><span class="cl"><span class="go">3306    open        tcp       mysql
</span></span></span><span class="line"><span class="cl"><span class="go">4333    open        tcp       msql
</span></span></span></code></pre></div><p><em><code>beispiel1.de</code>, eigentlich ein Web- und FTP-Server, bietet außerdem die Dienste ftp, ssh, smtp, sunrpc, nntp, mysql und msql an. Davon ist ssh, ein mit starker Kryptographie verschlüsselndes und authentisierendes Protokoll, unbedenklich. Die Protokolle httpd, ftp, smtp und nntp sind die eigentlichen Dienste des Servers und müssen angeboten werden. Solange ftp nur als FTP-Server für Anon-FTP eingesetzt wird, werden keine abhörbaren Paßworte übertragen. Die sunrpc, mysql und msql-Ports von außen zugänglich zu machen ist nicht nötig. Die Ports gehören in einer Firewall oder mit einen Paketfilter gesperrt.</em></p>
<p><em>Bei den Diensten, die man nach außen anbietet sollte man unbedingt auf aktuelle Versionen der Server achten: Buffer-Overflows und andere Probleme sind von ssh, von vielen FTP-Servern und auch von alten sendmail- und INN-Versionen bekannt.</em></p>
<p>Manchmal findet man einen offenen Port, kann aber nicht sagen, welches Programm diesen Port benutzt.
Hier ist ein Tool wie <code>lsof</code> sehr nützlich.
Alle lokal offenen Ports und die dazugehörigen Programme kann man mit dem Kommando <code>lsof -P -n -i</code> auflisten.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> lsof -P -n -i
</span></span><span class="line"><span class="cl"><span class="go">COMMAND    PID USER   FD   TYPE DEVICE SIZE NODE NAME
</span></span></span><span class="line"><span class="cl"><span class="go">xfstt       46 root    4u  IPv4     30       TCP *:7100 (LISTEN)
</span></span></span><span class="line"><span class="cl"><span class="go">httpd      199 root   19u  IPv4     99       TCP 193.102.57.12:80 (LISTEN)
</span></span></span><span class="line"><span class="cl"><span class="go">...
</span></span></span><span class="line"><span class="cl"><span class="go">smbd     11741 root    5u  IPv4  28694       UDP 127.0.0.1:1180
</span></span></span><span class="line"><span class="cl"><span class="go">smbd     11741 root    6u  IPv4  28689       TCP 193.102.57.3:139-&gt;193.102.57.2:1044 (ESTABLISHED)
</span></span></span></code></pre></div><p>Durch die Angabe von Suchoptionen kann man gezielt nach Protokoll und Port suchen:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> lsof -P -n -i tcp:139
</span></span><span class="line"><span class="cl"><span class="go">COMMAND   PID USER   FD   TYPE DEVICE SIZE NODE NAME
</span></span></span><span class="line"><span class="cl"><span class="go">smbd      276 root    5u  IPv4    175       TCP *:139 (LISTEN)
</span></span></span><span class="line"><span class="cl"><span class="go">smbd    11741 root    6u  IPv4  28689       TCP 193.102.57.3:139-&gt;193.102.57.2:1044 (ESTABLISHED)
</span></span></span></code></pre></div><h2 id="dump-einer-zone-mit-nslookup">
    <a href="#dump-einer-zone-mit-nslookup">
	Dump einer Zone mit nslookup
    </a>
</h2>
<p>Um festzustellen, welche Rechner in einer Domain stehen, kann man mit einem Tool wie nmap das ganze Teilnetz durchprüfen, in dem ein Server steht.
Alternativ kann man sich auch die Daten im DNS ansehen, die ein Serverbetreiber über seine Domain veröffentlicht.</p>
<p>Am Beispiel der Domain <code>beispiel1.de</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> nslookup
</span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">&gt;</span> <span class="nb">set</span> <span class="nv">type</span><span class="o">=</span>ns
</span></span><span class="line"><span class="cl"><span class="gp">&gt;</span> www.beispiel1.de.
</span></span><span class="line"><span class="cl"><span class="go">Server:  nuki.netuse.de
</span></span></span><span class="line"><span class="cl"><span class="go">Address:  193.98.110.1
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">beispiel1.de
</span></span></span><span class="line"><span class="cl"><span class="go">        origin = ns.beispiel1.de
</span></span></span><span class="line"><span class="cl"><span class="go">        mail addr = postmaster.ns.beispiel1.de
</span></span></span><span class="line"><span class="cl"><span class="go">        serial = 2000032201
</span></span></span><span class="line"><span class="cl"><span class="go">        refresh = 10800 (3H)
</span></span></span><span class="line"><span class="cl"><span class="go">        retry   = 3600 (1H)
</span></span></span><span class="line"><span class="cl"><span class="go">        expire  = 604800 (1W)
</span></span></span><span class="line"><span class="cl"><span class="go">        minimum ttl = 86400 (1D)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="gp">&gt;</span> server ns.beispiel1.de
</span></span><span class="line"><span class="cl"><span class="go">Default Server:  ns.beispiel1.de
</span></span></span><span class="line"><span class="cl"><span class="go">Address:  192.168.254.37
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">&gt;</span> ls beispiel1.de.
</span></span><span class="line"><span class="cl"><span class="go">[ns.beispiel1.de]
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="gp">$</span>ORIGIN beispiel1.de.
</span></span><span class="line"><span class="cl"><span class="go">@                       1D IN A         192.168.253.131
</span></span></span><span class="line"><span class="cl"><span class="go">wwwtest                 1D IN A         192.168.253.135
</span></span></span><span class="line"><span class="cl"><span class="go">news                    1D IN A         192.168.253.136
</span></span></span><span class="line"><span class="cl"><span class="go">localhost               1D IN A         127.0.0.1
</span></span></span><span class="line"><span class="cl"><span class="go">listserv                1D IN A         192.168.253.136
</span></span></span><span class="line"><span class="cl"><span class="go">...
</span></span></span><span class="line"><span class="cl"><span class="go">igate                   1D IN A         192.168.254.34
</span></span></span><span class="line"><span class="cl"><span class="go">daiquiri                1D IN A         192.168.254.61
</span></span></span></code></pre></div><p>Durch <code>set type=ns</code> (Nameserver) sagen wir <code>nslookup</code>, daß wir ausschließlich Informationen über Nameserver einer Domain haben möchten.
Wir fragen dann mit <code>www.beispiel1.de.</code> nach den Nameservern der Domain <code>beispiel1.de</code>.
Dies ist nur ein einzelner Server, nämlich <code>ns.beispiel1.de</code>.</p>
<p>Wir sagen nun mit Hilfe des Kommandos <code>server ns.beispiel1.de</code>, daß <code>nslookup</code> alle weiteren Fragen an diesen Server richten soll.
Mit Hilfe des Kommandos <code>ls beispiel1.de</code> fordern wir ein Listing der gesamten Zone <code>beispiel1.de</code> an.
Wir erhalten eine Liste aller Hostnamen und IP-Nummern, die der Betreiber der Domain <code>beispiel1.de</code> veröffentlicht.</p>
<p>Besser konfigurierte Nameserver erlauben ab BIND8, Zonetransfers auf die Secondary-Server einer Domain einzuschränken.
<code>ls</code>-Kommandos von anderen Hosts schlagen dann fehl.
Hat eine Domain mehrere Nameserver, ist es unter Umständen lohnend, diese nacheinander durchzuprobieren:
Vielfach ist der Primary Nameserver restriktiv konfiguriert, aber die Secondaries geben einem dennoch ein Listing der Zone.</p>
<p>Sicherheitsbewußte Netzbetreiber setzen Nameserver für das Internet und ihr Intranet getrennt auf.
Schließlich braucht es niemanden zu interessieren, welche Rechner in den Büros einer Firma laufen und wie diese heißen.
Stattdessen ist vollkommen ausreichend, die Namen und Nummern der Rechner zu publizieren, die Dienste für die Öffentlichkeit bringen, also etwa der Web-, der Name- und der Mailserver einer Domain.</p>
<h2 id="netzwerk-kartierung-mit-cheops">
    <a href="#netzwerk-kartierung-mit-cheops">
	Netzwerk-Kartierung mit Cheops
    </a>
</h2>
<p><p class="md__image">
  <img src="/uploads/2000/05/net.jpg" alt=""  />
</p>

</p>
<p><em>Mit Hilfe des Gnome-Programmes Cheops bekommt man schnell einen graphischen Netzplan mit Rechnertypen und Verbindungen.
Das Programm kann auch eingesetzt werden, um Portscans von Rechnern durchzuführen, ist hier aber nicht so vielseitig wie nmap.</em></p>
<h2 id="unverschlüsselte-verbindung-in-ethereal">
    <a href="#unverschl%c3%bcsselte-verbindung-in-ethereal">
	Unverschlüsselte Verbindung in Ethereal
    </a>
</h2>
<p><p class="md__image">
  <img src="/uploads/2000/05/ethereal.gif" alt=""  />
</p>

</p>
<p><em>Mit Hilfe des Netzwerkmonitors Ethereal ist die Analyse von Netzwerkpaketen möglich. Mit Hilfe der Stromverfolgung können dabei die Klartextpaßworte in Protokollen wie TELNET, FTP, POP3 und anderen sehr gut sichtbar gemacht werden.</em></p>
<h2 id="rpcinfo-anfrage-an">
    <a href="#rpcinfo-anfrage-an">
	rpcinfo-Anfrage an <a href="https://www.beispiel1.de" target="_blank" rel="noopener">www.beispiel1.de</a>

</h3></a>
    </a>
</h2>
<p>Mit Hilfe der Tools <code>rpcinfo</code> und <code>showmount</code> (Linux: auch <code>kshowmount</code>) kann man abfragen, welche Dienste der <code>sunrpc</code>-Dienst  erbringt.
Falls das SUN Network Filesystem (NFS) zu diesen Diensten gehört, kann man weiterfragen, welche Dateisysteme und für wen exportiert werden.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> rpcinfo -p www.beispiel1.de
</span></span><span class="line"><span class="cl"><span class="go">   program vers proto   port
</span></span></span><span class="line"><span class="cl"><span class="go">    100000    4   tcp    111  portmapper
</span></span></span><span class="line"><span class="cl"><span class="go">    100000    3   tcp    111  portmapper
</span></span></span><span class="line"><span class="cl"><span class="go">    100000    2   tcp    111  portmapper
</span></span></span><span class="line"><span class="cl"><span class="go">    100000    4   udp    111  portmapper
</span></span></span><span class="line"><span class="cl"><span class="go">    100000    3   udp    111  portmapper
</span></span></span><span class="line"><span class="cl"><span class="go">    100000    2   udp    111  portmapper
</span></span></span></code></pre></div><p>Wie man sieht, redet der <code>sunrpc</code>-Dienst von <code>www.beispiel1.de</code> mit externen Rechnern.
Das ist nicht notwendig und der Dienst kann blockiert werden, etwa durch eine Firewall oder durch Konfiguration entsprechender Filtermechanismen.</p>
<p>Eine sehr häufige Fehlkonfiguration besteht darin, Verzeichnisse mit NFS weltweit les- und schreibbar freizugeben.
Beispielhaft unsicher die Server von <code>beispiel2.de</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> /usr/sbin/kshowmount -e rzserv2.beispiel2.de
</span></span><span class="line"><span class="cl"><span class="go">Export list for rzserv2.beispiel2.de:
</span></span></span><span class="line"><span class="cl"><span class="go">/usr/lib/cobol       (everyone)
</span></span></span><span class="line"><span class="cl"><span class="go">/usr/sys/inst.images (everyone)
</span></span></span><span class="line"><span class="cl"><span class="go">/stadtinf            (everyone)
</span></span></span><span class="line"><span class="cl"><span class="go">/var/spool/mail      (everyone)
</span></span></span><span class="line"><span class="cl"><span class="go">/usr/lpp/info        (everyone)
</span></span></span><span class="line"><span class="cl"><span class="go">/usr/local           (everyone)
</span></span></span><span class="line"><span class="cl"><span class="go">/pd-software         (everyone)
</span></span></span><span class="line"><span class="cl"><span class="go">/u1                  (everyone)
</span></span></span><span class="line"><span class="cl"><span class="go">/user                (everyone)
</span></span></span><span class="line"><span class="cl"><span class="go">/fix                 (everyone)
</span></span></span><span class="line"><span class="cl"><span class="go">/u                   (everyone)
</span></span></span><span class="line"><span class="cl"><span class="go">/ora                 rzws01
</span></span></span><span class="line"><span class="cl"><span class="go">/install             (everyone)
</span></span></span><span class="line"><span class="cl"><span class="go">/ora-client          192.168.252.20
</span></span></span></code></pre></div><p>Die mit <code>everyone</code> gelisteten Verzeichnisse, darunter die Mail und die Homeverzeichnisse der Benutzer, sind weltweit les- und schreibbar.
Durch Zugriffe auf die <code>/usr/local</code> und <code>/usr/lib/cobol</code>-Verzeichnisse lassen sich Systembibiotheken und Systemprogramme austauschen, sodaß das ganze System ohne nennenswerten Widerstand sofort einnehmbar ist.
Tauscht man Daten im <code>/install</code>-Verzeichnis aus, sind auch alle Clients subvertiert, die von dieser Maschine installiert werden.
Das System ist durch seine fahrlässig offene Konfiguration also die ideale Ausgangsbasis für weitere Angriffe gegen andere Netzwerke.</p>
<h2 id="snmp-abfragen-an-ein-entferntes-system">
    <a href="#snmp-abfragen-an-ein-entferntes-system">
	SNMP-Abfragen an ein entferntes System
    </a>
</h2>
<p>SNMP gehört zu den Diensten, die einem Angreifer ein Höchstmaß an Information liefern können und die in Standardinstallationen oft nicht abgeschaltet und unzureichend gesichert werden.
Zudem läuft der Dienst über UDP, das von vielen Portscannern nicht per Default gescannt wird.
Daher taucht der Dienst auf dem Radar vieler Systemadministratoren nicht auf.</p>
<p>Wieder dienen die Server von <code>beispiel2.de</code> als abschreckendes Beispiel:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> snmpwalk rzserv2.beispiel2.de public
</span></span><span class="line"><span class="cl"><span class="go">system.sysDescr.0 = OCTET STRING: &#34;Fore Systems ATM Host (AIX 1 000005016600)&#34;
</span></span></span><span class="line"><span class="cl"><span class="go">system.sysObjectID.0 = OBJECT IDENTIFIER: enterprises.326.2.1
</span></span></span><span class="line"><span class="cl"><span class="go">system.sysUpTime.0 = Timeticks: (0) 0:00:00
</span></span></span><span class="line"><span class="cl"><span class="go">system.sysContact.0 = OCTET STRING: &#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="go">system.sysName.0 = OCTET STRING: &#34;rzserv2.&#34;
</span></span></span><span class="line"><span class="cl"><span class="go">system.sysLocation.0 = OCTET STRING: &#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="go">system.sysServices.0 = INTEGER: 72
</span></span></span><span class="line"><span class="cl"><span class="go">interfaces.ifNumber.0 = INTEGER: 7
</span></span></span><span class="line"><span class="cl"><span class="go">interfaces.ifTable.ifEntry.ifIndex.1 = INTEGER: 1
</span></span></span><span class="line"><span class="cl"><span class="go">interfaces.ifTable.ifEntry.ifIndex.2 = INTEGER: 2
</span></span></span><span class="line"><span class="cl"><span class="go">interfaces.ifTable.ifEntry.ifIndex.3 = INTEGER: 3
</span></span></span><span class="line"><span class="cl"><span class="go">interfaces.ifTable.ifEntry.ifIndex.4 = INTEGER: 4
</span></span></span><span class="line"><span class="cl"><span class="go">interfaces.ifTable.ifEntry.ifIndex.5 = INTEGER: 5
</span></span></span><span class="line"><span class="cl"><span class="go">...
</span></span></span></code></pre></div><p>Wir erfahren hier nicht nur den Typ und Patchlevel des Systems, sondern (nicht gezeigt) auch eine Liste der Interfaces und Routingkonfiguration des Systems - wir bekommen also detaillierte Information über die Topologie des Zielnetzes.
Zusammen mit Daten aus dem DNS gibt uns das einen genauen Netzplan des potentiellen Opfers.
Wenn weitere Management Module installiert sind, bekommen Zugriff auf weitere Subsysteme, etwa Oracle, SAP oder andere fernzuüberwachende Einheiten.
SNMP wird auch in vielen Routern und in RMON Netzwerkprobes eingesetzt - ein Eindringling kann so sogar Verkehrsdaten aus dem Netz erfahren, wenn diese nicht gesichert worden sind.</p>
<h2 id="ein-server-lagert-vertrauliche-daten-in-zugänglichen-verzeichnissen">
    <a href="#ein-server-lagert-vertrauliche-daten-in-zug%c3%a4nglichen-verzeichnissen">
	Ein Server lagert vertrauliche Daten in zugänglichen Verzeichnissen
    </a>
</h2>
<p>Eine weitere beliebte Fehlerklasse besteht in vertraulichen Daten, die in durch den Webserver zugänglichen Verzeichnissen gelagert werden.
Häufig bieten Webspace-Provider virtuelle Webserver an, bei denen die Wurzel des durch den Anwender beschreibbaren Bereiches (etwa: <code>/home/www/servers/www.kunde.de/</code>, für den Kunden sichtbar als <code>/</code>) auch die Wurzel des virtuellen Servers ist (etwa: <code>http://www.kunde.de/</code>).
Legt der Kunde jetzt Daten unterhalb seines Wurzelverzeichnisses ab (etwa eine Datei <code>/passwd</code>) dann ist diese Datei auch durch den Webserver abrufbar, denn sie liegt ja unterhalb der Document Root und hat eine URL (etwa: <code>http://www.kunde.de/passwd</code>).</p>
<p>Viele Webshops schreiben Bestellungen in ein oder mehrere Logverzeichnisse oder haben Konfigurationsdateien mit Paßworten und Artikeldaten.
Liegen diese Daten unterhalb der Document Root, dann haben sie URLs und sind zunächst einmal prinzipiell über das Web abrufbar, sofern es einem Angreifer gelingt den Namen zu raten.
Kennt man den Namen und die Version der verwendeten Websoftware, ist dies meist sehr einfach zu machen.</p>
<p>Prinzipielle Abhilfe schaffen hier nur Hostingumgebungen, bei denen die Document Root des Webservers tiefer als die Wurzel des Kundenverzeichnisses liegt (etwa ab <code>/home/www/servers/www.kunde.de/pages</code>).
Nun kann der Kunde weitere Verzeichnisse oberhalb der Document Root anlegen (etwa: <code>/home/www/servers/www.kunde.de/shop</code>) und seine vertraulichen Daten dort speichern.
Da diese Verzeichnisse über das Wartungs-FTP, nicht aber mit HTTP zugänglich sind, können sie nicht so einfach abgerufen werden.</p>
<p>Alternativ legt man Verzeichnisse unterhalb der Document Root an und verbietet den Zugriff per HTTP auf das Verzeichnis durch Anlegen einer <code>.htaccess</code>-Datei (Apache-Webserver).
Die Datei sollte den Zugriff von überall verbieten:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> cat /shop/.htaccess
</span></span><span class="line"><span class="cl"><span class="go">order deny, allow
</span></span></span><span class="line"><span class="cl"><span class="go">deny from all
</span></span></span></code></pre></div><p>Daten können dann nur noch über FTP abgerufen werden. Für FTP gelten <code>.htaccess</code>-Dateien nicht.</p>
<h2 id="ein-server-vertraut-eingabeparametern-aus-webformularen-ohne-grund">
    <a href="#ein-server-vertraut-eingabeparametern-aus-webformularen-ohne-grund">
	Ein Server vertraut Eingabeparametern aus Webformularen ohne Grund
    </a>
</h2>
<p>Die dritte häufige Fehlerklasse besteht darin, in CGI-Programmen Parameter aus dem Web zu übernehmen und ohne Prüfung zu verwenden.</p>
<p>Eine Webanwendung besteht aus Komponenten die innerhalb der Firewall liegen und als vertrauenswürdig gelten können, weil sie durch den lokalen Administrator kontrolliert werden.
Dazu gehören etwa die lokalen Scripte, die Datenbank, der Webserver und lokale Datendateien.
Dazu kommen dann weitere Komponenten, die außerhalb der Firewall liegen und die grundsätzlich als nicht vertrauenswürdig gelten können.
Das ist hauptsächlich der Browser des Anwenders, wenn er denn einen benutzt und seinen Webrequest zwecks Hackangriff nicht direkt in ein Telnet tippt.
Die Firewall markiert eine Vertrauensgrenze, eine Trust Boundary.</p>
<p>Daten von jenseits der Vertrauensgrenze kann eine Webanwendung nicht ohne Prüfung vertrauen.
Dazu gehören alle Parameter, die dem CGI-Script übergeben werden, also alle GET-, POST- oder COOKIE-Parameter, der HTTP_REFERER, der HTTP_USER_AGENT und alle weiteren Werte von außen.
Alle diese Werte müssen vor der Verwendung durch ein CGI-Script durch eine Gültigkeitsprüfung, in der sichergestellt wird, daß die Daten auch das erwartete Format haben und gültige Werte besitzen.</p>
<p>Zum Beispiel ist es gängige Praxis, daß bestimmte Scripte Werte nur dann akzeptieren, wenn bei der Übergabe der HTTP_REFERER des Aufrufes korrekt ist.
Auf diese Weise versucht sich das Script gegen gefälschte Aufrufe zu schützen.
Natürlich ist es für einen potentiellen Angreifer überhaupt gar kein Problem außer den Scriptparametern auch noch jeden gewünschten HTTP_REFERER mit zu übergeben - der Schutz ist also wirkungslos.
Korrekt wäre, wenn das Script jeden übergebenen Parametern einzeln prüft.</p>
<p>Eine andere häufig verwendete Technik besteht darin, Parameter von einer Seite zur nächsten als <code>&lt;INPUT TYPE=&quot;HIDDEN&quot;&gt;</code> mitzuschleifen.
Dabei wird interner Zustand der Anwendung im Browser des Anwenders gehalten, also jenseits der Trust Boundary.
Für den Anwender ist es ein leichtes, den Zustand einer solchen Anwendung zu manipulieren und jeden gewünschten Effekt zu bewirken.
Korrekt wäre, eine Plattform zu verwenden, die Sessionvariablen bietet und den Zustand der Anwendung auf dem Webserver halten kann (etwa: Microsoft ASP mit dem Session-Objekt, PHP3 mit PHPLIB, PHP4 mit den
<code>session_*()</code>-Funktionen oder einen richtigen Application-Server).</p>
<h2 id="fazit">
    <a href="#fazit">
	Fazit
    </a>
</h2>
<p>Webmaster sind gut beraten, alle ihre Installationen auf diese drei Fehlerklassen abzuprüfen und ihre Anwendungen gegebenenfalls anzupassen.
Gestohlene Kreditkartendaten oder gar geknackte Server, die als Ausgangspunkt für weitere Angriffe dienen, sind nicht nur peinlich:
Derartige Installationen sind fahrlässig unsicher und dem betroffenen Betreiber stehen mit großer Wahrscheinlichkeit Klagen auf Schadenersatz oder Beihilfe zum Computereinbruch ins Haus.</p>
<p>Für den Laien ist dies keine Alternative:
Die Sicherheit eines Servers zu verifizieren setzt nicht nur umfassende technische Kenntnisse, sondern auch Zugang zum Server voraus.
Letztendlich kann nur ein technisches Gütesiegel, das auf Grundlage einer technischen Überprüfung der Server und aller darauf laufenden Anwendungen erteilt wird dem Verbraucher mitteilen, daß er es mit einer seriösen Installation zu tun hat.</p>
<h1 id="referenzen">
    <a href="#referenzen">
	Referenzen:
    </a>
</h1>
<dl>
<dt><a href="http://www.koehntopp.de/kris/artikel/webtune/" target="_blank" rel="noopener">http://www.koehntopp.de/kris/artikel/webtune/</a>

:</dt>
<dd>&ldquo;Webserver verstehen und tunen&rdquo;</dd>
<dt><a href="http://www.koehntopp.de/php/" target="_blank" rel="noopener">http://www.koehntopp.de/php/</a>

:</dt>
<dd>&ldquo;de.comp.lang.php - Häufig gestellte Fragen&rdquo;</dd>
<dt><a href="http://www.insecure.org/nmap/" target="_blank" rel="noopener">http://www.insecure.org/nmap/</a>

:</dt>
<dd>&ldquo;NMAP Port Scanner&rdquo;</dd>
<dt><a href="http://ethereal.zing.org/" target="_blank" rel="noopener">http://ethereal.zing.org/</a>

:</dt>
<dd>&ldquo;Ethereal Network Monitor&rdquo;</dd>
<dt><a href="http://www.marko.net/cheops/" target="_blank" rel="noopener">http://www.marko.net/cheops</a>

:</dt>
<dd>&ldquo;Ceops Network Mapper&rdquo;</dd>
<dt><a href="http://freshmeat.net/appindex/1998/04/06/891857252.html" target="_blank" rel="noopener">http://freshmeat.net/appindex/1998/04/06/891857252.html</a>

:</dt>
<dd>&ldquo;lsof - list open files&rdquo;</dd>
<dt>&ldquo;TCP/IP Illustrated, Volume 1: The Protocols&rdquo;:</dt>
<dd>W. Richard Stevens, Addison-Wesley</dd>
<dt>&ldquo;Hacking Exposed - Network Security Secrets &amp; Solutions&rdquo;:</dt>
<dd>McClure, Scambray and Kurtz, Osborne</dd>
<dt>&ldquo;Maximum Linux Security&rdquo;:</dt>
<dd>Anonymous, Sams</dd>
</dl>

			</div>
		</div>

		
		
		<div class='row justify-content-center py-3 mb-3 mx-0'>
			<div class='col-lg-8 text-center'>
				<span class='letter-spacing-01 text-uppercase text-secondary me-2'>Tags</span>
				
				<a href="/tags/#lang_de" class='btn btn-sm btn-outline-primary mb-1'>
				<svg class="bi" width="1rem" height="1rem" fill="currentColor">
					<use xlink:href="/bootstrap-icons.svg#tag-fill"></use>
				</svg>
				lang_de
				</a>
				
				<a href="/tags/#publication" class='btn btn-sm btn-outline-primary mb-1'>
				<svg class="bi" width="1rem" height="1rem" fill="currentColor">
					<use xlink:href="/bootstrap-icons.svg#tag-fill"></use>
				</svg>
				publication
				</a>
				
				<a href="/tags/#talk" class='btn btn-sm btn-outline-primary mb-1'>
				<svg class="bi" width="1rem" height="1rem" fill="currentColor">
					<use xlink:href="/bootstrap-icons.svg#tag-fill"></use>
				</svg>
				talk
				</a>
				
				<a href="/tags/#internet" class='btn btn-sm btn-outline-primary mb-1'>
				<svg class="bi" width="1rem" height="1rem" fill="currentColor">
					<use xlink:href="/bootstrap-icons.svg#tag-fill"></use>
				</svg>
				internet
				</a>
				
			</div>
		</div>

		
		
		
		
		<div class='row justify-content-center py-3 mb-3 mx-0'>
			<div class='col-lg-8 text-center'>
				<a href="https://github.com/isotopp/isotopp.github.io/edit/main/content/posts/2000-05-01-webserver-security.md"
				   rel="noopener noreferrer" target="_blank">
					<span class='letter-spacing-01 text-uppercase text-secondary me-2'>Suggest Changes</span>
				</a>
			</div>
		</div>
		

		<div class='row justify-content-center mx-0'>
			<div class='col-lg-4 text-center text-lg-start'>
				
				<div>
					<div class='letter-spacing-01 text-uppercase text-secondary'>
						Previous Post
					</div>
					<a class='text-decoration-none' href="https://blog.koehntopp.info/2000/04/14/neu-auf-einem-fremden-system.html">Neu auf einem fremden System</a>
				</div>
				
			</div>

			<div class='col-lg-4 text-lg-end mt-5 mt-lg-0 text-center'>
				
				<div>
					<div class='letter-spacing-01 text-uppercase text-secondary'>
						Next Post
					</div>
					<a class='text-decoration-none' href="https://blog.koehntopp.info/2000/08/21/web-security.html">Web Security</a>
				</div>
				
			</div>
		</div>


		
	</article>
</div>



            <footer class='row justify-content-center mb-4 pb-4 mx-0'>
  <div class='col-8 text-center'>
    <div>
      A collection of old stuff, new stuff and random stuff.
    </div>
    <div class='row text-primary mt-4'>
      <div class='col'>

        <a href='/feed.xml' title='Follow RSS feed' class='me-3 text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#rss-fill'/>
          </svg>
        </a>

        <a href='mailto:kristian.koehntopp@gmail.com' title='Email' class='me-3 text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#envelope'/>
          </svg>
        </a>

        <a href='https://github.com/isotopp' title='Follow on GitHub' class='me-3 text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#github'/>
          </svg>
        </a>

        <a rel="me" href="https://infosec.exchange/@isotopp" title='Follow on Mastodon' class='me-3 text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#mastodon'/>
          </svg>
        </a>

        
        <a href='http://steamcommunity.com/id/ixotopp' title='Follow on Steam' class='me-3 text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#steam'/>
          </svg>
        </a>

        

        <a href='https://www.youtube.com/user/isotopp' title='Follow on YouTube' class=''>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#youtube'/>
          </svg>
        </a>
      </div>
    </div>
  </div>
</footer>


        </main>

	





<script src="https://blog.koehntopp.info/js/bootstrap.js"></script>




<script src="https://blog.koehntopp.info/js/lunr.js"></script>





<script src="https://blog.koehntopp.info/js/app.js"></script>


    </body>
</html>
