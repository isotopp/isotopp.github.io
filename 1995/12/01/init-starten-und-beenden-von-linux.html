<!doctype html>
<html lang="en">
    <head>
    <meta charset="utf-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<title>init - Starten und Beenden von Linux | Die wunderbare Welt von Isotopp</title>
<meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="apple-touch-icon" href="icon.png">
<link rel="favicon.ico" rel="icon" type="image/ico">
<link rel="canonical" href="https://blog.koehntopp.info">


<link rel="alternate" type="application/rss+xml" href='https://blog.koehntopp.info/feed.xml' title="Die wunderbare Welt von Isotopp">
<link rel="alternate" type="application/rss+xml" href='https://blog.koehntopp.info/tags/mysql/feed.xml' title="Feed: mysql Articles for Die wunderbare Welt von Isotopp">
<link rel="alternate" type="application/rss+xml" href='https://blog.koehntopp.info/tags/review/feed.xml' title="Feed: review Articles for Die wunderbare Welt von Isotopp">




<meta name="generator" content="Hugo 0.104.3" />
<meta property="og:title" content='init - Starten und Beenden von Linux' />
<meta property="og:site_name" content='Die wunderbare Welt von Isotopp' />


<meta property="og:locale" content="de_DE" />


<meta name="description" content='' />
<meta property="og:description" content='' />

<link rel="canonical" href="https://blog.koehntopp.info" />
<meta property="og:url" content="https://blog.koehntopp.info" />


<meta property="og:type" content="article" />
<meta name="article:published_time" content='1995-12-01T09:00:00Z' />



<meta property="og:image" content='https://blog.koehntopp.info/assets/img/background/rijksmuseum.jpg' />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:site" content='@isotopp' />
<meta name="twitter:creator" content='@isotopp' />
<meta property="twitter:title" content='init - Starten und Beenden von Linux' />
<meta property="twitter:description" content='' />
<meta property="twitter:image" content='https://blog.koehntopp.info/assets/img/background/rijksmuseum.jpg' />

<script type="application/ld+json">
    {"@context":"https://schema.org","@type":"WebSite","description":null,"headline":"init - Starten und Beenden von Linux","image":"/assets/img/background/rijksmuseum.jpg","name":"Die wunderbare Welt von Isotopp","url":"https://blog.koehntopp.info"}
</script>

    



<link rel="stylesheet" href="https://blog.koehntopp.info/style.min.731532d47a51fed497cc74301e50720b3c56d09404efc36b4fa1a4117a6aa10e.css">


    </head>
    <body>
        

        <nav class="navbar navbar-expand-lg navbar-light px-lg-4 pt-lg-4">
    <div class="container-fluid">
        <a class="navbar-brand justify-content-center" href="https://blog.koehntopp.info" rel="home" title="Die wunderbare Welt von Isotopp">
            <img alt="Kris" height='48' width='48' src='/assets/img/isotopp.jpg' class='p-0 me-3 d-block d-lg-inline'>
            <span class='h4 d-block d-lg-inline'>Die wunderbare Welt von Isotopp</span>
        </a>

        <button class="navbar-toggler ms-auto" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse text-center" id="navbarSupportedContent">
            <ul class="navbar-nav ms-auto">
                
                <li class="nav-item ">
                    <a class="nav-link" href="/about/">
                        <span class="">About</span>
                        
                    </a>
                </li>
                <li class="nav-item ">
                    <a class="nav-link" href="/contribute/">
                        <span class="">Contribute</span>
                        
                    </a>
                </li>
                <li class="nav-item ">
                    <a class="nav-link" href="/search/">
                        <span class=""><svg class='bi' height='1.5rem' width='1.5rem' fill='currentColor'><use xlink:href='/bootstrap-icons.svg#search'/></svg></span>
                        
                    </a>
                </li>
                <li class="nav-item ">
                    <a class="nav-link" href="/tags/">
                        <span class=""><svg class='bi' width='1.5rem' height='1.5rem' fill='currentColor'><use xlink:href='/bootstrap-icons.svg#tags-fill'/></svg></span>
                        
                    </a>
                </li>
                
            </ul>
            
        </div>

    </div>
</nav>


        <main role="main" class="container-fluid p-0">

            




<div class="page">
  <article class="init-starten-und-beenden-von-linux-page">
    <div class='row  justify-content-center text-center my-4 mx-0'>
      <header>
        <div class='col'>
          <h1 class="title mb-lg-4 text-white">
            init - Starten und Beenden von Linux
          </h1>
          <div class='text-uppercase text-light' style='letter-spacing: 0.1rem;'>
            <img alt='isotopp image' src='/assets/img/isotopp.jpg' class='me-1 p-0' style='width: 1.9rem; border-radius: 1rem;'>
            <a href="https://twitter.com/isotopp" class='text-light text-decoration-none'>
                Kristian Köhntopp
            </a>

            
              <span class='d-none d-lg-inline'>-</span>
              <div class='d-block d-lg-inline'>December 1, 1995</div>
            

          </div>
        </div>
        
          <img alt='a featured image' src="/assets/img/background/rijksmuseum.jpg">
        
      </header>
    </div>

    <div class='row justify-content-center mx-0 mt-5 mb-5'>
      <div class='col-lg-8'>
        <p><strong>Linux Magazin, Heft 12/1995</strong></p>
<h2 id="init---starten-und-beenden-von-linux">
    <a href="#init---starten-und-beenden-von-linux">
	init - Starten und Beenden von Linux
    </a>
</h2>
<p><em>Der Prozeß mit der Prozeßnummer 1 ist init. init wird beim Starten des Systems geladen und läuft bis zum Abschalten durch. Er ist der direkte oder indirekte Urahn aller anderen Prozesse eines Linux-Systems. Ein genaues Verständnis der Vorgänge vom Starten von init bis zum Erscheinen des ersten Shellprompts nach dem Login ist notwendig, um fehlerhaft konfigurierte Linuxsysteme wiederzubeleben, ohne neu installieren zu müssen.</em></p>
<p>Die meisten Linux-Distributionen haben heutzutage den sysvinit 2.4 von Miquel van Smoorenburg (Miquel van Smoorenburg) installiert. Diese init-Version entspricht im Großen und Ganzen den von regulären System V Systemen bekannten inits, ist aber auf PC-Verhältnisse besonders angepaßt. sysvinit kennt zum Beispiel spezielle Optionen betreffend das Verhalten bei einem Stromausfall mit einer USV und weiß mit einem Control-Alt-Delete umzugehen. Mit Smoorenburgs init-Paket kommen außer init auch noch die Programme <code>halt</code>, <code>last</code>, <code>mesg</code>, <code>shutdown</code> und <code>wall</code> sowie der Quelltext für den <code>powerd</code>, ein Auswertedämon für die Statusleitungen von USVs. Eine Version von <code>who</code>, die auf den init abgestimmt wäre, fehlt.</p>
<p>Zu dem Zeitpunkt, zu dem init gestartet wird, ist das System soeben gebootet worden. Außer dem Root-Dateisystem, das wahrscheinlich nur read-only gemountet ist und möglicherweise beschädigt ist und der Systemkonsole <code>/dev/console</code> existieren keine weiteren Ressourcen. Außer init laufen keine anderen Prozesse. Swapspace ist noch nicht angemeldet, was zur Folge hat, daß auf Systemen mit nur 4 MB RAM der Speicher schnell knapp werden könnte. Die Aufgabe von init beim Systemstart ist zunächst einmal, die Dateisysteme zu prüfen, gegebenenfalls zu reparieren und sie sowie eventuell vorhandenen Swapspace anzumelden. Durch die zusätzlichen Dateisysteme und den zusätzlichen Speicher versetzt sich das System in die Lage, die zahlreichen Hintergrundprozesse zu starten, die ein vollständig betriebsbereites Linux auszeichnen. Welche Dämonen gestartet sind, wird durch die Konfigurationsdatei von init, die <code>/etc/inittab</code> festgelegt. Je nach Run-Level des Systems können dies unterschiedliche Prozesse sein.</p>
<h2 id="run-levels">
    <a href="#run-levels">
	Run-Levels
    </a>
</h2>
<p>Ein Run-Level ist dabei einfach nur die numerische Bezeichnung (Okay, es gibt auch noch einen Run-Level S) für eine bestimmte Systemkonfiguration. Abhängig vom aktuellen Run-Level werden bestimmte Zeilen der <code>/etc/inittab</code> gültig oder ungültig und init stoppt oder startet dementsprechend die zugehörigen Prozesse. Die <code>/etc/inittab</code> definiert gewissermaßen den Soll-Zustand des Systems in einem bestimmten Run-Level: Fehlende Dämon-Prozesse werden von init nachgestartet, überzählige Dämon-Prozesse werden von init gestoppt.</p>
<p>Über den Ist-Zustand des Systems führt init parallel dazu in der utmp-Datei Buch. Für jede Zeile der <code>/etc/inittab</code> steht in der utmp-Datei ein <code>struct utmp</code>-Eintrag, der über den Verbleib des zugehörigen Prozesses Aufschluß gibt. Außerdem führt init über seine Aktionen noch in der wtmp-Datei ein Logbuch. Auch diese Datei besteht aus <code>struct utmp</code>-Einträgen, aber im Gegensatz zu utmp, die eine feste Länge hat, wird wtmp als Logbuch fortgeschrieben (und muß regelmäßig gekürzt werden). Programme wie <code>who</code>, <code>w</code>, <code>finger</code> oder der <code>rwhod</code> können die utmp-Datei auswerten und anzeigen, welche Benutzer gerade im System eingeloggt sind oder welche Schnittstellen gerade unbelegt sind. Programme wie <code>last</code> oder Accountingtools werten dagegen die wtmp-Datei aus und können so ein Logbuch über die vergangenen Logins erzeugen.</p>
<p>Auf einem richtigen System V kann who nicht nur eine Liste der eingeloggten Benutzer erzeugen, sondern die komplette utmp-Datei analysieren und auch mit der Option -r den aktuellen Run-Level des Systems anzeigen. Im Umfeld der Slackware-Distributionen paßt der <code>who</code>-Befehl nicht zum init und ihm fehlen diese Optionen, sodaß man auf selbstgeschriebene Programme angewiesen ist.</p>
<p>init erzwingt nicht, daß bestimmte Run-Level (ausgenommen S) bestimmte Bedeutungen haben. Das Verhalten des Systems richtet sich ausschließlich nach der Konfiguration in der <code>/etc/inittab</code>. Per Konvention hat diese auf den meisten Distributionen, die von Slackware abstammen, ein bestimmtes Aussehen. &ldquo;Slackware inittab&rdquo; weiter unten zeigt die <code>/etc/inittab</code> einer Slackware-Installation.</p>
<p>Eine Zeile der <code>inittab</code> hat dabei das folgende Format:</p>
<pre tabindex="0"><code>	id:runlevels:action:process
</code></pre><p>Die <strong>id</strong> stellt dabei einen eindeutigen Identifikator für die Zeile der inittab dar. Er muß genau zwei Buchstaben lang sein und taucht später als <code>ut_id</code>-Feld in demjenigen Eintrag in der utmp-Datei auf, der zu dieser Zeile der inittab gehört. Das, was <code>finger</code> in der Spalte Tty ausdruckt, ist der Inhalt dieses <code>ut_id</code>-Feldes aus der utmp-Datei.</p>
<p>Das Feld <strong>runlevels</strong> definiert einen oder mehrere Run-Levels, in denen diese Zeile aktiviert sein soll.Wenn der aktuelle Run-Level des Systems hier nicht aufgeführt ist, ist diese Zeile unwirksam: Ein Eintrag im Feld runlevels mit den Ziffern 123 wäre nur in den Run-Levels 1, 2 und 3 gültig.</p>
<p>Das Feld <strong>process</strong> definiert dann den Aufruf eines Prozesses mit allen Parametern, wie er von init gestartet werden soll, wenn das System sich in einem der in runlevels genannten Run-Level befindet. Diese Prozesse sind entweder Dämon-Prozesse wie <code>xdm</code> oder <code>nnmaster</code>, Login-Prompts wie <code>getty</code> oder Scripte und Anweisungen, die beim Wechsel des Run-Levels aktiv werden. init überwacht diese Prozesse. Wenn sich einer von ihnen beendet, bemerkt init dies und entscheidet anhand der <strong>action</strong> darüber, ob der Dämon neu gestartet werden soll oder was sonst zu tun ist.</p>
<p>Der Abschnitt &ldquo;Das action Feld in der inittab&rdquo; erklärt die Bedeutung der verschiedenen Schlüsselworte.</p>
<h2 id="die-rc-scripte">
    <a href="#die-rc-scripte">
	Die rc-Scripte
    </a>
</h2>
<p>Bei der Slackware startet die inittab einige rc-Scripte, genau wie bei den meisten anderen Unices auch. Die Bezeichnung <code>rc</code> steht dabei für &ldquo;run command&rdquo;. Sie stammt noch aus der Urzeit der Computerentwicklung und wurde von einem der vergessenen Vorläufer von UNIX übernommen. Heute würde man wohl stattdessen das Kürzel &ldquo;BAT&rdquo; verwenden.</p>
<p>Die Struktur dieser Scripte orientiert sich bei Linux mehr an der wesentlich primitiveren Konfiguration eines BSD-Systems als an einem normalen System V. Mit unserem Wissen über init können wir inzwischen erkennen, daß Linux nach dem Booten wegen des <code>initdefault</code>-Schlüsselwortes in der inittab den Run-Level 5 ansteuert. Der <code>sysinit</code>-Eintrag sorgt dann für die Abarbeitung von <code>/etc/rc.d/rc.S</code>, gefolgt von <code>/etc/rc.d/rc.M</code>, da der <code>wait</code>-Eintrag &ldquo;rc&rdquo; den Run-Level 5 enthält. Nachdem init auf das Ende von <code>rc.M</code> gewartet hat, startet er die <code>getty</code>-Einträge <code>c2</code> bis <code>c6</code> (<code>c1</code> ist hier auskommentiert) und den <code>nnmaster</code>. Der Eintrag <code>x1</code> wird ignoriert, da er nur für den Run-Level 6 gilt.</p>
<p><code>/etc/rc.d/rc.S</code> ist das Script, das als erstes nach dem Systemstart abgearbeitet wird. Es findet den eingangs erwähnten Rechner ohne Dateisysteme und Ressourcen vor und macht sich daran, diesen Zustand zu ändern. Die ersten Handgriffe nach der Definition eines Suchpfades dienen dazu, den Swapspace zu aktivieren: Dazu muß <code>swapon -a</code> eine gültige <code>/etc/fstab</code> vorfinden und dort die Swap-Partitionen benannt bekommen. Der <code>update</code>-Dämon sorgt dann dafür, daß der Speicherinhalt auch gelegentlich auf die Festplatte geschrieben werden. Jetzt ist auch auf Maschinen mit 4 MB RAM genügend Speicher bereitgestellt, um größere Prozesse ablaufen lassen zu können.</p>
<p>Die folgenden Anweisungen dienen dazu, die Dateisysteme zu prüfen und - falls möglich - das Root-Dateisystem read-write anzumelden. Wenn der <code>fsck</code> oder der Remount fehlschlagen, druckt das Script Handlungsanweisungen und versucht noch so etwas wie ein Login hinzubekommen. Die folgenden Anweisungen ab Zeile 92 dienen dann dazu, die üblichen Konfigurations- und Statusdateien zu erzeugen, die beim Systemstart aufgefrischt werden müssen und die Systemzeit zu stellen.</p>
<p>Startet man Linux im <i>single user mode</i> oder gerät man auf andere Weise auf ein System mit einer read-only angemeldeten Root-Platte, kann man sich behelfen, indem man <code>/etc/rc.d/rc.S</code> von Hand ausführt. Mit ein wenig Glück bekommt man so ein halbwegs vernünftig konfiguriertes System, bei dem man immerhin soviele Eingriffsmöglichkeiten hat, daß man die verbleibenden Fehler von Hand korrigieren kann. Auch normale UNIX-Versionen haben ähnliche Scripte. Da das Checken und Anmelden der Platten nach dem Systemstart mit die dringlichste Aufgabe ist, findet man den Namen des Scriptes am einfachsten heraus, indem man sich den sysinit-Eintrag der betreffenden <code>/etc/inittab</code> ansieht. Ein häufige Name für dieses Script ist zum Beispiel <code>bcheckrc</code>.</p>
<p><code>/etc/rc.d/rc.M</code> kümmert sich dann um die Vorbereitung des Systems auf den Mehrbenutzerbetrieb. Dieses Script kann davon ausgehen, daß alle lokalen Platten schon verfügbar sind und daß ausreichend Swapspace zur Verfügung steht. Hostnamen und andere das Netzwerk betreffende Dinge sind aber noch undefiniert. <code>rc.M</code> konfiguriert einen Screenblanker, startet den <code>cron</code>, setzt den Hostnamen und verzweigt dann vorübergehend in die Scripte <code>rc.inet1</code> und <code>rc.inet2</code>. Ersteres dient dazu, den Kernelteil des Netzwerkes zu konfigurieren: Die Interfaces erhalten ihre IP-Nummern und werden gestartet, danach setzt sich der Kernel Routingtabellen. Das gesamte Script besteht im Prinzip nur aus glorifizierten Aufrufen von <code>ifconfig</code> und <code>route</code>. Die zweite Datei konfiguriert dann den Anwendungsteil des Netzes, indem dort die entsprechenden Serverprozesse gestartet werden. Die folgenden Arbeiten in <code>rc.M</code> erledigen dann einige Aufräumarbeiten, die zu verschiedenen Subsystemen gehören. Wichtig ist hier vor allen Dingen der Aufruf von <code>ldconfig</code>, der Links auf die aktuellen Versionen der shared libraries auf den neuesten Stand bringt. Am Ende von <code>rc.M</code> wird dann noch auf <code>rc.local</code> verzweigt, in der der Systemverwalter lokale Modifikationen des Systemstarts unterbringen kann. Einige Versionen der Slackware verzweigen bei Bedarf noch in andere, spezialisierte rc-Dateien zum Verstellen des Zeichensatzes oder der Tastaturbelegung.</p>
<p><p class="md__image">
  <img src="/uploads/1995/12/init-files.gif" alt=""  />
</p>

</p>
<h2 id="erweiterungen-der-rc-dateien">
    <a href="#erweiterungen-der-rc-dateien">
	Erweiterungen der rc-Dateien
    </a>
</h2>
<p>Bei der Konstruktion der rc-Dateien, wie sie im Abschnitt &ldquo;Slackware inittab&rdquo; gezeigt wird, ist einzig die Datei <code>rc.local</code> für lokale Erweiterungen des Bootvorganges vorgesehen. Der Systemverwalter kann hier neben lokalen Anpassungen für Zeichensatz und Tastatur eigene Dämon-Prozesse starten oder den Weg für den Start solcher Prozesse bereiten (indem zum Beispiel alte Lockdateien abgeräumt werden).</p>
<p>Dabei sollte man auf jeden Fall darauf achten, daß die <code>rc.local</code>-Datei beendet wird! <code>rc.S</code> wird als sysinit-Eintrag ausgeführt und <code>rc.local</code> ist Bestandteil von <code>rc.M</code> und wird als wait-Eintrag ausgeführt. In beiden Fällen können die folgenden Einträge der inittab erst dann ausgeführt werden, wenn <code>rc.S</code> bzw. <code>rc.M</code> beendet sind. Die folgenden Einträge sind aber die <code>getty</code>-Prozesse für die Systemkonsole (c1-c6), die das Login überhaupt ermöglichen. Wenn ein Fehler in <code>rc.M</code> also dazu führt, daß sich das Script niemals beendet, kommen niemals Loginprompts und man kann sich nicht anmelden, um den Fehler zu korrigieren.</p>
<p>Der Fehler tritt zum Beispiel gerne dann auf, wenn man in <code>rc.local</code> einen Dämon startet (es ist ein Characteristikum von Dämonen, daß sie sich nach Möglichkeit nicht beenden), der sich nicht automatisch selbst in den Hintergrund schiebt. Zum Beispiel schiebt sich der <code>nnmaster</code>-Aufruf</p>
<pre tabindex="0"><code>	/usr/lib/nn/nnmaster -l -r -C
</code></pre><p>automatisch in den Hintergrund, während</p>
<pre tabindex="0"><code>	/usr/lib/nn/nnmaster -f -l -r -C
</code></pre><p>keinen Hintergrundprozeß erzeugt, sondern ausdrücklich im Vordergrund bleibt. In der <code>rc.local</code> würde nur der erste Aufruf korrekt funktionieren, der zweite würde das System blockieren.</p>
<p>In der <code>/etc/inittab</code> im Abschnitt &ldquo;Slackware inittab&rdquo; ist <code>nnmaster</code> jedoch in der zweiten Variante eingetragen. Wieso ist das hier notwendig? Nun, in der inittab ist <code>nnmaster</code> als respawn-Eintrag eingetragen: init bewacht den <code>nnmaster</code> hier und startet ihn neu, falls notwendig. Wäre <code>nnmaster</code> hier ohne -f eingetragen, würde der Dämon sich in den Hintergrund schieben und der Vordergrundprozeß würde sich gleich wieder beenden. init bemerkt, daß sich der von ihm gestartete Prozeß beendet hat und würde sogleich einen zweiten <code>nnmaster</code> starten, wie der respawn-Eintrag es befiehlt. Solche Einträge erzeugen dann die Meldung &ldquo;respawning to rapidly&rdquo;.</p>
<h2 id="rc-dateien-im-stile-von-system-v">
    <a href="#rc-dateien-im-stile-von-system-v">
	rc-Dateien im Stile von System V
    </a>
</h2>
<p>Das Konzept der <code>rc.local</code>-Datei ist zwar schön einfach zu verstehen, aber für die automatische Wartung des Systems ist es nicht besonders elegant. In einer kommerziellen Umgebung würde man davon ausgehen, daß die Benutzer des Systems reine Anwender sind und kaum genug Ausbildung haben, um mit der Anwendung selbst klarzukommen. Auch von der Systemverwaltung kann man nicht in jedem Fall verlangen, daß sie zu selbstständigen Änderungen an rc-Dateien in der Lage ist. Das gilt insbesondere dann, wenn diese Änderung den fehlerfreien Wiederanlauf des Systems gefährden kann. Für Anwendungen, die durch schlecht ausgebildete Personen aus vorgefertigen Packages installiert werden sollen, wäre es wünschenswert, wenn ein Mechanismus besteht, durch den sie sich automatisch und weitgehend fehlerfrei in die Programmfolge beim Systemstart einhängen können.</p>
<p>Ein ähnliches Problem besteht schon seit Jahren im Bereich MS-DOS, wo Installationsprozeduren von Anwendungspaketen Änderungen an der AUTOEXEC.BAT und der CONFIG.SYS vornehmen müssen. Im Bereich MS-DOS löst man dies, indem jede Anwendung einen großen Installator mit sich herumschleppt, der in der Lage ist, solche Konfigurationsdateien zu parsen und zu korrekt verändern (oder auch nicht). Das so etwas schon bei MS-DOS nicht richtig funktioniert, bemerkt der Autor jedesmal an seiner eigenen Konfiguration, die leider nicht linear ist, sondern mehrere Verzweigungen und Aufrufe von Unterbatches enthält. Praktisch alle DOS-Installationsprogramme führen ihre Änderungen an der falschen Stelle oder nur für eine Konfiguration (meistens nicht die aktive) ein. UNIX Shellscripte sind allerdings noch mächtiger als DOS Batchdateien und für ein Installationsprogramm entsprechend schwieriger zu handhaben. Die Wahrscheinlichkeit, daß ein rc-Modifikator eine etwas komplexere <code>rc.local</code> durch seine Änderungen zerstört sind viel größer als für ein DOS Installationsprogramm.</p>
<p>In System V UNIX verwendet man deswegen ein etwas anderes Konzept, daß ohne aufwendige Parser auskommt und trotzdem viel sicherer funktioniert. Statt alle Anweisungen in eine einzige Datei zu quetschen, hat man die rc-Datei dort in viele kleine Module zerlegt, von denen sich jedes um einen Aspekt des Systemstartes kümmert. Man hat für jeden Run-Level ein Unterverzeichnis <code>/etc/rcn.d</code> (wobei n die Nummer des Run-Levels ist). Dort befinden sich die Startdateien für diesen Run-Level. Das Script <code>/etc/rcn</code> (wieder ist n der Run-Level) ist für jeden Run-Level gleich und führt nacheinander alle Dateien im zum Run-Level gehörenden Unterverzeichnis aus.</p>
<p>Per Konvention haben alle Dateien im Unterverzeichnis entweder den Namen KxyNAME oder SxyNAME. Eine K-Datei dient dazu, irgendeinen Dienst beim Betreten des Run-Levels zu stoppen, eine S-Datei dient dazu, einen Dienst zu starten. Die Ziffern xy laufen von 00 bis 99 durch und dienen dazu, eine alphabethische Reihenfolge der Script zu definieren: Das Script führt die einzelnen Module in der Reihenfolge K00 bis K99 und dann S00 bis S99 aus. Es ruft K-Scripte mit dem Parameter <code>stop</code> auf, S-Scripte werden mit dem Parameter <code>start</code> aufgerufen. Der Bestandteil NAME dient zur Identifikation des Scriptes und bezeichnet das Subsystem, das durch das Script gestartet oder gestoppt wird.</p>
<p>Ein Programmpaket kann bei dieser Konstruktion ganz leicht eingefügt werden. Nehmen wir an, ein hypothetischer FAX-Server <code>kfax</code> braucht beim Systemstart einige Anweisungen, um einen Dämon-Prozeß zu starten und ein wenig aufzuräumen. Das Installationspaket könnte eine Datei mit den benötigten Anweisungen erzeugen und sie als <code>/etc/init.d/kfax</code> in einem Sammelverzeichnis für alle Startscripte installieren. Das Modul soll beim Betreten von Run-Level 5 getstartet werden. Also erzeugt die Installationsprozedur ein Symlink von <code>/etc/rc5.d/S99kfax</code> nach <code>/etc/init.d/kfax</code>. Die Installation braucht also nur eine Datei zu erzeugen und ein Link zu legen, um ihr Modul in die rc-Scripte zu integrieren. Soll das Script in mehr als einem Run-Level aktiviert werden, wird es auch von den anderen <code>/etc/rcn.d</code>-Verzeichnissen nach <code>/etc/init.d</code> gelinkt. Lesen und Verstehen von <code>rc.local</code> oder anderen Scripten ist nicht notwendig. Die Deinstallationsanweisung ist genauso simpel: &ldquo;Löschen Sie die Datei <code>/etc/rc5.d/S99kfax</code> und starten Sie das System neu.&rdquo;</p>
<p>Beim Wechsel in den Run-Level 5 wird unser Beispielsystem das Script <code>/etc/rc5</code> durch einen once-Eintrag aktivieren. Das Script geht alle Dateien in <code>/etc/rc5.d</code> durch und führt sie der Reihe nach aus. Es wird zunächst alle <code>/etc/rc.d/K*</code>-Dateien mit dem Parameter <code>stop</code> aufrufen, danach wird es alle <code>/etc/rc.d/S*</code>-Dateien mit dem Parameter <code>start</code> aufrufen. Ganz am Schluss wird <code>S99kfax start</code> ausgeführt.</p>
<p>Das folgende Listing zeigt den inittab-Eintrag und ein Listing von <code>/etc/rc5</code>.</p>
<h2 id="system-v-startscript-etcrc5">
    <a href="#system-v-startscript-etcrc5">
	System V Startscript <code>/etc/rc5</code>
    </a>
</h2>
<p>Der Eintrag in der <code>/etc/inittab</code>:</p>
<pre tabindex="0"><code>r5:5:once:/etc/rc5
</code></pre><p>Das zugehörige Script:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># /bin/sh --</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#	Das Script wird ausgefuehrt, wenn das System in den </span>
</span></span><span class="line"><span class="cl"><span class="c1">#	Run-Level 5 wechselt.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1">#	Fuer die anderen Run-Levels sollten </span>
</span></span><span class="line"><span class="cl"><span class="c1">#   analoge Eintraege und Scripte existieren.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">PATH</span><span class="o">=</span>/bin:/sbin:/usr/sbin:/usr/bin
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="o">[</span> -d /etc/rc5.d <span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="k">then</span>
</span></span><span class="line"><span class="cl">	<span class="c1"># Ausfuehren der Stopscripte</span>
</span></span><span class="line"><span class="cl">	<span class="nv">MODE</span><span class="o">=</span>stop
</span></span><span class="line"><span class="cl">	<span class="k">for</span> f in /etc/rc5.d/K*
</span></span><span class="line"><span class="cl">	<span class="k">do</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="o">[</span> -x <span class="si">${</span><span class="nv">f</span><span class="si">}</span> <span class="o">]</span>
</span></span><span class="line"><span class="cl">		<span class="k">then</span>
</span></span><span class="line"><span class="cl">			/sbin/sh <span class="si">${</span><span class="nv">f</span><span class="si">}</span> stop
</span></span><span class="line"><span class="cl">		<span class="k">else</span>
</span></span><span class="line"><span class="cl">			. <span class="si">${</span><span class="nv">f</span><span class="si">}</span>
</span></span><span class="line"><span class="cl">		<span class="k">fi</span>
</span></span><span class="line"><span class="cl">	<span class="k">done</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="c1"># Ausfuehren der Startscripte</span>
</span></span><span class="line"><span class="cl">	<span class="nv">MODE</span><span class="o">=</span>start
</span></span><span class="line"><span class="cl">	<span class="k">for</span> f in /etc/rc3.d/S*
</span></span><span class="line"><span class="cl">	<span class="k">do</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="o">[</span> -x <span class="si">${</span><span class="nv">f</span><span class="si">}</span> <span class="o">]</span>
</span></span><span class="line"><span class="cl">		<span class="k">then</span>
</span></span><span class="line"><span class="cl">			/sbin/sh <span class="si">${</span><span class="nv">f</span><span class="si">}</span> start
</span></span><span class="line"><span class="cl">		<span class="k">else</span>
</span></span><span class="line"><span class="cl">			. <span class="si">${</span><span class="nv">f</span><span class="si">}</span>
</span></span><span class="line"><span class="cl">		<span class="k">fi</span>
</span></span><span class="line"><span class="cl">        <span class="k">done</span>
</span></span><span class="line"><span class="cl"><span class="k">fi</span>
</span></span></code></pre></div><h2 id="slackware-inittab">
    <a href="#slackware-inittab">
	Slackware inittab
    </a>
</h2>
<pre tabindex="0"><code>#
# inittab       This file describes how the INIT process should set up
#               the system in a certain Run-Level.
#
# Version:      @(#)inittab             2.04    17/05/93        MvS
#
# Author:       Miquel van Smoorenburg, &lt;miquels@drinkel.nl.mugnet.org&gt;
#
# Default runlevel.
id:5:initdefault:

# System initialization (runs when system boots).
si:S:sysinit:/etc/rc.d/rc.S

# Script to run when going single user.
su:S:wait:/etc/rc.d/rc.K

# Script to run when going multi user.
rc:123456:wait:/etc/rc.d/rc.M

# What to do at the &#34;Three Finger Salute&#34;.
ca::ctrlaltdel:/sbin/shutdown -t3 -rf now

# What to do when power fails (shutdown to single user).
pf::powerfail:/sbin/shutdown -f +5 &#34;THE POWER IS FAILING&#34;

# If power is back before shutdown, cancel the running shutdown.
pg:0123456:powerokwait:/sbin/shutdown -c &#34;THE POWER IS BACK&#34;

# If power comes back in single user mode, return to multi user mode.
ps:S:powerokwait:/sbin/init 5

# The getties in multi user mode on consoles an serial lines.
#
# NOTE NOTE NOTE adjust this to your getty or you will not be
#                able to login !!
#
# Note: for &#39;agetty&#39; you use linespeed, line.
# for &#39;getty_ps&#39; you use line, linespeed and also use &#39;gettydefs&#39;
#c1:12345:respawn:/sbin/agetty 38400 tty1
c2:12345:respawn:/sbin/agetty 38400 tty2
c3:12345:respawn:/sbin/agetty 38400 tty3
c4:45:respawn:/sbin/agetty 38400 tty4
c5:45:respawn:/sbin/agetty 38400 tty5
c6:456:respawn:/sbin/agetty 38400 tty6

# nn
nn:23456:respawn:/usr/lib/nn/nnmaster -f -l -r -C

# Serial lines
#s1:45:respawn:/sbin/agetty 19200 ttyS0
#s2:45:respawn:/sbin/agetty 19200 ttyS1

# Dialup lines
#d1:45:respawn:/sbin/agetty -mt60 38400,19200,9600,2400,1200 ttyS0
#d2:45:respawn:/sbin/agetty -mt60 38400,19200,9600,2400,1200 ttyS1

# Runlevel 6 used to be for an X-window only system, until we discovered
# that it throws init into a loop that keeps your load avg at least 1 all 
# the time. Thus, there is now one getty opened on tty6. Hopefully no one
# will notice. ;^)
# It might not be bad to have one text console anyway, in case something 
# happens to X.
x1:6:wait:/etc/rc.d/rc.6

# End of /etc/inittab
</code></pre><h2 id="das-action-feld-in-der-etcinittab">
    <a href="#das-action-feld-in-der-etcinittab">
	Das Action Feld in der <code>/etc/inittab</code>
    </a>
</h2>
<p>Das Feld <code>action</code> in der <code>inittab</code> bestimmt, wie <code>init</code> mit dem im Feld <strong>process</strong> genannten Prozeß verfährt. <code>sysvinit</code> kennt dieselben Schlüsselworte wie ein richtiger <code>init</code> eines originalen System V UNIX plus einige eigene Schlüsselworte, die spezifisch für Linux sind.</p>
<h3 id="start-und-restart-von-prozessen">
    <a href="#start-und-restart-von-prozessen">
	Start und Restart von Prozessen
    </a>
</h3>
<dl>
<dt>off:</dt>
<dd>Zeilen, die als <code>off</code> gekennzeichnet sind, sind inaktiv. Dies stellt eine gute Methode dar, um Einträge in der <code>inittab</code> vorübergehend außer Betrieb zu nehmen. Natürlich könnte man sie auch in Kommentarzeilen verwandeln, indem man an den Anfang der Zeile ein &ldquo;#&rdquo; setzt.</dd>
<dt>respawn:</dt>
<dd>Dies ist der häufigste Eintrag, wie er für <code>getty</code>s und für Dämon-Prozesse verwendet wird, die automatisch neu gestartet werden sollen. Wenn sich ein so gekennzeichneter Eintrag beendet, versucht <code>init</code> den Prozeß erneut zu starten. Kommt es dabei zu einer Endlosschleife (der Prozeß beendet sich aufgrund eines Fehlers sofort wieder, <code>init</code> startet ihn sofort wieder neu&hellip;), erkennt <code>init</code> dies und legt den Eintrag für einige Minuten mit der Meldung &ldquo;process respawning too rapidly&rdquo; still.</dd>
<dt>initdefault:</dt>
<dd>Der <code>initdefault</code>-Eintrag hat in gewisser Weise eine Sonderrolle: Er spezifiziert keinen Prozeß, sondern sein <code>runlevel</code>-Feld gibt an, in welchen Run-Level sich das System beim Systemstart begeben soll. Fehlt dieser Eintrag, wird der gewünschte Run-Level beim Booten an der Console erfragt.</dd>
<dt>wait:</dt>
<dd>Mit wait gekennzeichnete Prozesse werden von <code>init</code> einmal beim Betreten des Run-Levels gestartet. <code>init</code> wartet dann darauf, daß der entsprechende Prozeß sich wieder beendet, bevor der nächste Eintrag abgearbeitet wird. Da <code>init</code> die Einträge einer <code>inittab</code> von oben nach unten abarbeitet, kann man so eine kontrollierte Folge von Scripten beim Erreichen eines Run-Levels starten.</dd>
<dt>once:</dt>
<dd>Mit <code>once</code> gekennzeichnete Prozesse werden von <code>init</code> einmal beim Betreten des Run-Levels gestartet. Im Gegensatz zur Aktion <code>wait</code> wartet <code>init</code> hier aber nicht auf das Ende des Prozesses, bevor der nächste Eintrag der <code>inittab</code> abgearbeitet wird. <code>once</code> wird normalerweise verwendet, um einen Dämon zu starten ohne in wie bei <code>respawn</code> bewachen zu lassen. Sollte der Dämon sich beenden, wird eben kein neuer Prozeß gestartet. In System V UNIX wird <code>once</code> verwendet, um die <code>/etc/rcn</code>-Scripte zu starten.</dd>
</dl>
<h3 id="boot">
    <a href="#boot">
	Boot
    </a>
</h3>
<p>Weil <code>init</code> als allererster Prozeß im System gestartet wird, muß es Einträge gegeben, die spezifizieren, wie das System ans Laufen gebracht wird. Bei diesen Einträgen wird das Feld <strong>runlevels</strong> ignoriert. Sie werden beim Start des Systems schlicht von oben nach unten abgearbeitet.</p>
<dl>
<dt>sysinit:</dt>
<dd>Die ersten Prozesse der Bootphase werden durch die <code>sysinit</code>-Einträge bestimmt. Es handelt sich meistens um Scripte, deren Aufgabe es ist, die Platten zu checken und sie read-write anzumelden.</dd>
<dt>boot:</dt>
<dd>Nach den <code>sysinit</code>-Scripten folgen dann die anderen Scripte der Bootphase.</dd>
<dt>bootwait:</dt>
<dd>Bei <code>bootwait</code>-Einträgen wartet das System mit dem Starten des Folgeeintrags solange, bis der aktuelle Eintrag abgearbeitet ist. Bei <code>boot</code>-Einträgen wird dagegen nicht gewartet.</dd>
</dl>
<h3 id="speziell-für-linux">
    <a href="#speziell-f%c3%bcr-linux">
	Speziell für Linux
    </a>
</h3>
<p><code>sysvinit</code> von Linux hat außerdem noch einige Nichtstandard-Aktionen. Sie dienen hauptsächlich der Unterstützung von USVs und zumAbfangen der Tastenkombination Control-Alt-Delete.</p>
<dl>
<dt>ctrlaltdel:</dt>
<dd>Bei diesem Eintrag wird das Feld <strong>runlevels</strong> ebenfalls ignoriert. Er wird aktiviert, wenn jemand an der Console die Tastenkombination Control-Alt-Delete gedrückt hat. Normalerweise wird man hier entweder das System herunterfahren oder in den single user mode wechseln.</dd>
<dt>powerwait:</dt>
<dt>powerfail:</dt>
<dd>Einträge mit der Aktion <code>powerwait</code> oder <code>powerfail</code> werden aktiviert, wenn das System ein SIGPWR Signal erhält. Dies ist typischerweise ein Signal, das vom Kernel generiert wird, wenn die Stromversorgung des Systems zusammenbricht und die USV übernimmt. Bei <code>powerwait</code>-Einträgen wartet <code>init</code> wieder auf das Ende eines Eintrages, bevor der nächste abgearbeitet wird, während dies bei <code>powerfail</code>-Einträgen nicht geschieht.</dd>
<dt>powerokwait:</dt>
<dd>Dieser Eintrag wird aktiviert, wenn ein SIGPWR auftritt und die Datei <code>/etc/powerstatus</code> das Wort OK enthält. Sollte die Stromversorgung wieder funktionieren, bevor das System sich auf Grund des ersten SIGPWR abgeschaltet hat, kann durch einen Eintrag hier die Abschaltung verhindert werden.</dd>
<dt>ondemand:</dt>
<dd>Ein Eintrag mit der Bezeichnung ondemand funktioniert ähnlich wie ein Eintrag <code>once</code>. Während ein <code>once</code>-Eintrag jedoch nur beim Betreten eines Run-Levels aktiviert wird, wird ein <code>ondemand</code>-Eintrag auch dann aktiviert, wenn das System in den Run-Level wechseln soll, in dem es sich sowieso schon befindet.</dd>
</dl>

      </div>
    </div>

    
    
    <div class='row justify-content-center mb-3 mx-0'>
      <div class='col-lg-8 text-center'>
        <span class='letter-spacing-01 text-uppercase text-secondary me-2'>Share</span>
        <a href='https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.koehntopp.info%2f1995%2f12%2f01%2finit-starten-und-beenden-von-linux.html' target='_blank' class='text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'><use xlink:href='/bootstrap-icons.svg#facebook'/></svg>
        </a>
        <a href='https://twitter.com/intent/tweet?source=https%3a%2f%2fblog.koehntopp.info%2f1995%2f12%2f01%2finit-starten-und-beenden-von-linux.html&text=init%20-%20Starten%20und%20Beenden%20von%20Linux%20%7C%20Die+wunderbare+Welt+von+Isotopp:%20https%3a%2f%2fblog.koehntopp.info%2f1995%2f12%2f01%2finit-starten-und-beenden-von-linux.html' target='_blank' class='text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'><use xlink:href='/bootstrap-icons.svg#twitter'/></svg>
        </a>
        <a href='http://www.reddit.com/submit?url=https%3a%2f%2fblog.koehntopp.info%2f1995%2f12%2f01%2finit-starten-und-beenden-von-linux.html&title=init%20-%20Starten%20und%20Beenden%20von%20Linux' target='_blank' class='text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'><use xlink:href='/bootstrap-icons.svg#reddit'/></svg>
        </a>
        <a href='mailto:?subject=init%20-%20Starten%20und%20Beenden%20von%20Linux&body=https%3a%2f%2fblog.koehntopp.info%2f1995%2f12%2f01%2finit-starten-und-beenden-von-linux.html' target='_blank' class='text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'><use xlink:href='/bootstrap-icons.svg#envelope-fill'/></svg>
        </a>
      </div>
    </div>

    
    
    <div class='row justify-content-center py-3 mb-3 mx-0'>
      <div class='col-lg-8 text-center'>
        <span class='letter-spacing-01 text-uppercase text-secondary me-2'>Tags</span>
        
          <a href="/tags/#lang_de" class='btn btn-sm btn-outline-primary mb-1'>
            <svg class="bi" width="1rem" height="1rem" fill="currentColor"><use xlink:href="/bootstrap-icons.svg#tag-fill"></use></svg>
            lang_de
          </a>
        
          <a href="/tags/#publication" class='btn btn-sm btn-outline-primary mb-1'>
            <svg class="bi" width="1rem" height="1rem" fill="currentColor"><use xlink:href="/bootstrap-icons.svg#tag-fill"></use></svg>
            publication
          </a>
        
          <a href="/tags/#unix" class='btn btn-sm btn-outline-primary mb-1'>
            <svg class="bi" width="1rem" height="1rem" fill="currentColor"><use xlink:href="/bootstrap-icons.svg#tag-fill"></use></svg>
            unix
          </a>
        
      </div>
    </div>

    <div class='row justify-content-center mb-5 pt-5 border-top mx-0'>
      <div class='col-lg-4 text-center text-lg-start'>
        
          <div>
            <div class='letter-spacing-01 text-uppercase text-secondary'>
              Next Post
            </div>
            <a class='text-decoration-none' href="https://blog.koehntopp.info/1996/01/01/wer-beherrscht-das-internet.html">Wer beherrscht das Internet?</a>
          </div>
        
      </div>

      <div class='col-lg-4 text-lg-end mt-5 mt-lg-0 text-center'>
        
          <div>
            <div class='letter-spacing-01 text-uppercase text-secondary'>
              Previous Post
            </div>
            <a class='text-decoration-none' href="https://blog.koehntopp.info/1995/11/01/cnews-in-betrieb-nehmen.html">Cnews in Betrieb nehmen</a>
          </div>
        
      </div>
    </div>

    
    </article>
</div>



            <footer class='row justify-content-center mb-4 pb-4 mx-0'>
  <div class='col-8 text-center'>
    <div>
      A collection of old stuff, new stuff and random stuff. 
    </div>
    <div class='row text-primary mt-4'>
      <div class='col'>

        <a href='/feed.xml' title='Follow RSS feed' class='me-3 text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'><use xlink:href='/bootstrap-icons.svg#rss-fill'/></svg>
        </a>

        <a href='mailto:kristian.koehntopp@gmail.com' title='Email' class='me-3 text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'><use xlink:href='/bootstrap-icons.svg#envelope'/></svg>
        </a>

        <a href='https://github.com/isotopp' title='Follow on GitHub' class='me-3 text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'><use xlink:href='/bootstrap-icons.svg#github'/></svg>
        </a>

        <a href='https://www.reddit.com/user/isotopp' title='Follow on Reddit' class='me-3 text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'><use xlink:href='/bootstrap-icons.svg#reddit'/></svg>
        </a>

        <a href='http://steamcommunity.com/id/ixotopp' title='Follow on Steam' class='me-3 text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'><use xlink:href='/bootstrap-icons.svg#steam'/></svg>
        </a>

        <a href='https://twitter.com/isotopp' title='Follow on Twitter' class='me-3 text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'><use xlink:href='/bootstrap-icons.svg#twitter'/></svg>
        </a>

        <a href='https://www.youtube.com/user/isotopp' title='Follow on YouTube' class=''>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'><use xlink:href='/bootstrap-icons.svg#youtube'/></svg>
        </a>

      </div>
    </div>
  </div>
</footer>


        </main>

	





<script src="https://blog.koehntopp.info/js/bootstrap.js"></script>




<script src="https://blog.koehntopp.info/js/lunr.js"></script>





<script src="https://blog.koehntopp.info/js/app.js"></script>


    </body>
</html>
