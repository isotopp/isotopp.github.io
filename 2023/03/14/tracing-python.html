<!doctype html>
<html lang="en">
    <head>
    <meta charset="utf-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<title>Tracing Python | Die wunderbare Welt von Isotopp</title>
<meta name="description" content="Kris Köhntopp&#39;s blog (Fedi: @isotoppinfosec.exchange)">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" href="icon.png">
<link rel="icon" href="favicon.ico" type="image/ico">
<link rel="shortcut icon" href="favicon.ico">
<link rel="canonical" href="https://blog.koehntopp.info/2023/03/14/tracing-python.html">

<link rel="alternate" type="application/rss+xml" href='https://blog.koehntopp.info/feed.xml' title="Die wunderbare Welt von Isotopp">
<link rel="alternate" type="application/rss+xml" href='https://blog.koehntopp.info/tags/mysql/feed.xml' title="Feed: mysql Articles for Die wunderbare Welt von Isotopp">
<link rel="alternate" type="application/rss+xml" href='https://blog.koehntopp.info/tags/review/feed.xml' title="Feed: review Articles for Die wunderbare Welt von Isotopp">


<meta name="generator" content="Hugo 0.145.0">
<meta property="og:title" content='Tracing Python | Die wunderbare Welt von Isotopp' />
<meta property="og:site_name" content='Die wunderbare Welt von Isotopp' />
<meta property="og:locale" content="en_US" />
<meta name="description" content='Kris Köhntopp&#39;s blog (Fedi: @isotoppinfosec.exchange)' />
<meta property="og:description" content='Kris Köhntopp&#39;s blog (Fedi: @isotoppinfosec.exchange)' />
<meta property="og:url" content="https://blog.koehntopp.info/2023/03/14/tracing-python.html" />
<meta property="og:type" content="article" />
<meta name="article:published_time" content='2023-03-14T12:13:14Z' />
<meta name="fediverse:creator" content="@isotopp@infosec.exchange">
<meta property="og:image" content='https://blog.koehntopp.info/assets/img/background/rijksmuseum.jpg' />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:creator" content='@isotopp@infosec.exchange' />
<meta property="twitter:title" content='Tracing Python' />
<meta property="twitter:description" content='Kris Köhntopp&#39;s blog (Fedi: @isotoppinfosec.exchange)' />
<meta property="twitter:image" content='https://blog.koehntopp.info/assets/img/background/rijksmuseum.jpg' />


    



<link rel="stylesheet" href="https://blog.koehntopp.info/style.min.dd9d518fe6cac55191b6af874e18327dff051055754ffc7e106131baf826e6d3.css">


    </head>
    <body>
        

        <nav class="navbar navbar-expand-lg navbar-light px-lg-4 pt-lg-4">
    <div class="container-fluid">
        <a class="navbar-brand justify-content-center" href="https://blog.koehntopp.info/" rel="home" title="Die wunderbare Welt von Isotopp">
            <img alt="Kris" height='48' width='48' src='/assets/img/avatars/isotopp.jpg' class='p-0 me-3 d-block d-lg-inline'>
            <span class='h4 d-block d-lg-inline'>Die wunderbare Welt von Isotopp</span>
        </a>

        <button class="navbar-toggler ms-auto" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse text-center" id="navbarSupportedContent">
            <ul class="navbar-nav ms-auto">
                
                <li class="nav-item ">
                    <a class="nav-link" href="/about/">
                        <span class="">About</span>
                        
                    </a>
                </li>
                <li class="nav-item ">
                    <a class="nav-link" href="/contribute/">
                        <span class="">Contribute</span>
                        
                    </a>
                </li>
                <li class="nav-item ">
                    <a class="nav-link" href="/search/">
                        <span class=""><svg class='bi' height='1.5rem' width='1.5rem' fill='currentColor'><use xlink:href='/bootstrap-icons.svg#search'/></svg></span>
                        
                    </a>
                </li>
                <li class="nav-item ">
                    <a class="nav-link" href="/tags/">
                        <span class=""><svg class='bi' width='1.5rem' height='1.5rem' fill='currentColor'><use xlink:href='/bootstrap-icons.svg#tags-fill'/></svg></span>
                        
                    </a>
                </li>
                
            </ul>
            
        </div>

    </div>
</nav>


        <main role="main" class="container-fluid p-0">

            









<div class="page">
	<article class="tracing-python-page">
		<div class='row  justify-content-center text-center my-4 mx-0'>
			<header class="headerbanner">
				<div class='col'>
					<h1 class="title mb-lg-4 text-white">
						Tracing Python
					</h1>
					<div class='text-uppercase text-light' style='letter-spacing: 0.1rem;'>
						<img alt='@isotopp@infosec.exchange image' src='/assets/img/avatars/isotopp.jpg' class='me-1 p-0'
						     style='width: 1.9rem; border-radius: 1rem;'>
						<a href="https://infosec.exchange/@isotopp" class='text-light text-decoration-none'>
							Kristian Köhntopp
						</a>
						
						<span class='d-none d-lg-inline'>-</span>
						<div class='d-block d-lg-inline'>March 14, 2023</div>
						
					</div>
				</div>
				
				<img alt='a featured image' src="/assets/img/background/rijksmuseum.jpg">
				
			</header>
		</div>

		<div class='row justify-content-center mx-0'>
			<div class='col-lg-4 text-center text-lg-start'>
				
				<div>
					<div class='letter-spacing-01 text-uppercase text-secondary'>
						Previous Post
					</div>
					<a class='text-decoration-none' href="https://blog.koehntopp.info/2023/03/06/selecting-random-rows.html">MySQL: Selecting random rows</a>
				</div>
				
			</div>

			<div class='col-lg-4 text-lg-end mt-5 mt-lg-0 text-center'>
				
				<div>
					<div class='letter-spacing-01 text-uppercase text-secondary'>
						Next Post
					</div>
					<a class='text-decoration-none' href="https://blog.koehntopp.info/2023/04/04/mysql-sovereign-dbaas-decoded.html">MySQL: SeveralNines Podcast with Kris</a>
				</div>
				
			</div>
		</div>

		<div class='row justify-content-center mx-0 mt-3 mb-5'>
			<div class="col-lg-8 mb-3">
				
				<header class="toc bg-light">
					<nav id="TableOfContents">
  <ul>
    <li><a href="#pycharm-builtin-method">PyCharm builtin method</a></li>
    <li><a href="#do-it-yourself-syssettrace">Do it yourself: <code>sys.settrace()</code></a></li>
    <li><a href="#do-it-yourself-logging">Do it yourself: <code>@logging</code></a></li>
    <li><a href="#using-autologging">Using autologging</a></li>
    <li><a href="#using-icecream">Using <code>icecream</code></a></li>
    <li><a href="#snoop-and-birdseye"><code>snoop</code> and <code>birdseye</code></a></li>
    <li><a href="#pysnoop">pysnoop</a></li>
    <li><a href="#peepshow-a-commandline-debugger"><code>peepshow</code>, a commandline debugger</a></li>
    <li><a href="#honeycomb-and-opentracing">Honeycomb and Opentracing</a></li>
    <li><a href="#and-in-c">And in C?</a></li>
  </ul>
</nav>
				</header>
				
			</div>
			<div class='col-lg-8'>
				<p>Based on a discussion on IRC and Mastodon: &ldquo;How can I get access to the return values of my (Python-) programs functions?&rdquo;
And more generally, how can I trace function execution in Python, showing function parameters and return values?</p>
<h1 id="pycharm-builtin-method">
    <a href="#pycharm-builtin-method">
	PyCharm builtin method
    </a>
</h1>
<p>Of course, you can always simply turn on this in the PyCharm debugger:</p>
<p><p class="md__image">
  <img src="/uploads/2023/03/python-tracing-01.png" alt=""  />
</p>

</p>
<p><em>PyCharm, Debug Window, Gear Icon, &ldquo;Show Return Values&rdquo;</em></p>
<h1 id="do-it-yourself-syssettrace">
    <a href="#do-it-yourself-syssettrace">
	Do it yourself: <code>sys.settrace()</code>
    </a>
</h1>
<p>(via <a href="https://news.ycombinator.com/item?id=36066670" target="_blank" rel="noopener">Peterkelly</a>

):
Python has a built-in API for tracing: <a href="https://docs.python.org/3/library/sys.html#sys.settrace" target="_blank" rel="noopener"><code>sys.settrace()</code></a>

.</p>
<p>Here&rsquo;s an example of how to use it:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">mytrace</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">event</span> <span class="o">==</span> <span class="s2">&#34;call&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;call&#34;</span><span class="p">,</span> <span class="n">frame</span><span class="o">.</span><span class="n">f_code</span><span class="o">.</span><span class="n">co_name</span><span class="p">,</span> <span class="n">frame</span><span class="o">.</span><span class="n">f_locals</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">elif</span> <span class="n">event</span> <span class="o">==</span> <span class="s2">&#34;return&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;return&#34;</span><span class="p">,</span> <span class="n">frame</span><span class="o">.</span><span class="n">f_code</span><span class="o">.</span><span class="n">co_name</span><span class="p">,</span> <span class="n">arg</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">mytrace</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="cl"><span class="n">sys</span><span class="o">.</span><span class="n">settrace</span><span class="p">(</span><span class="n">mytrace</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">fac</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">n</span> <span class="o">*</span> <span class="n">fac</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="n">fac</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">result</span><span class="si">=}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></div><p>This will output:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">call</span> <span class="n">fac</span> <span class="p">{</span><span class="s1">&#39;n&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">call</span> <span class="n">fac</span> <span class="p">{</span><span class="s1">&#39;n&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">call</span> <span class="n">fac</span> <span class="p">{</span><span class="s1">&#39;n&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">return</span> <span class="n">fac</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="k">return</span> <span class="n">fac</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl"><span class="k">return</span> <span class="n">fac</span> <span class="mi">6</span>
</span></span><span class="line"><span class="cl"><span class="n">result</span><span class="o">=</span><span class="mi">6</span>
</span></span></code></pre></div><h1 id="do-it-yourself-logging">
    <a href="#do-it-yourself-logging">
	Do it yourself: <code>@logging</code>
    </a>
</h1>
<p>You can also implement such a thing from first principles, in Python:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">functools</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">args_to_str</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="s2">&#34;, &#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">args</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">kwargs_to_str</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">ret</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">        <span class="n">ret</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">,&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">ret</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">logging</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">func</span><span class="o">.</span><span class="n">__indent__</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@functools.wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">wrapper_logging</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">func_indent</span> <span class="o">=</span> <span class="s2">&#34; &#34;</span> <span class="o">*</span> <span class="n">func</span><span class="o">.</span><span class="n">__indent__</span>
</span></span><span class="line"><span class="cl">        <span class="n">func</span><span class="o">.</span><span class="n">__indent__</span> <span class="o">+=</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">func_name</span> <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="vm">__qualname__</span>
</span></span><span class="line"><span class="cl">        <span class="n">func_args</span> <span class="o">=</span> <span class="n">args_to_str</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">func_kwargs</span> <span class="o">=</span> <span class="n">kwargs_to_str</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">func_indent</span><span class="si">}</span><span class="s2"> -&gt; Enter: </span><span class="si">{</span><span class="n">func_name</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="n">func_args</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">func_kwargs</span> <span class="o">!=</span> <span class="s2">&#34;&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;, </span><span class="si">{</span><span class="n">func_kwargs</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;)&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">result</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">func_indent</span><span class="si">}</span><span class="s2"> &lt;- Leave: </span><span class="si">{</span><span class="n">func_name</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">)&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">result</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">wrapper_logging</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@logging</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">fac</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">n</span> <span class="o">*</span> <span class="n">fac</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="n">fac</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">result</span><span class="si">=}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></div><p>This makes use of <code>@functools.wraps()</code> to define a <a href="https://python101.pythonlibrary.org/chapter25_decorators.html" target="_blank" rel="noopener">decorator</a>

, <code>@logging</code>.
It also leverages the fact, that anything, including a callable, can have properties, which we are using to maintain an indent count in <code>func.__indent__</code>.
This is initialized to 0, and then incremented by 2 for each call in the call stack. Unwinding the call stack resets the counter, so we don&rsquo;t have to do that manually.</p>
<p>We have two helper functions to turn the functions <code>*args</code> and <code>**kwargs</code> into proper strings, and we access <code>func.__qualname__</code> to get the functions <a href="https://docs.python.org/3/glossary.html#term-qualified-name" target="_blank" rel="noopener">name</a>

.
We are using <code>__qualname__</code> to handle inner functions properly here, even if that is sometimes creating less readable output.</p>
<p>Running the code results in</p>
<p><p class="md__image">
  <img src="/uploads/2023/03/python-tracing-02.png" alt=""  />
</p>

</p>
<p><em>Output from the Python program above shows function calls and results.</em></p>
<h1 id="using-autologging">
    <a href="#using-autologging">
	Using autologging
    </a>
</h1>
<p>The <a href="https://github.com/mzipay/Autologging" target="_blank" rel="noopener">autologging</a>

 package makes this simpler, even if it lacks the nice indentation.</p>
<p>Our code becomes much shorter:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">logging</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">autologging</span> <span class="kn">import</span> <span class="n">logged</span><span class="p">,</span> <span class="n">traced</span><span class="p">,</span> <span class="n">TRACE</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">level</span><span class="o">=</span><span class="n">TRACE</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">stream</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nb">format</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">%(levelname)s</span><span class="s2">:</span><span class="si">%(name)s</span><span class="s2">:</span><span class="si">%(funcName)s</span><span class="s2">:</span><span class="si">%(message)s</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@logged</span>
</span></span><span class="line"><span class="cl"><span class="nd">@traced</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Fac</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">pass</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">fac</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">__log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&#34;OHAI&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">n</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">fac</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">f</span> <span class="o">=</span> <span class="n">Fac</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">fac</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</span></span></code></pre></div><p>We get to use a new loglevel <code>TRACE</code>, and import <code>@logged</code> and <code>@traced</code> decorators from the package.
After setting up a log channel with proper formatting, we can mark functions with the decorator, get their execution traced and can simply log.</p>
<p>The output:</p>
<p><p class="md__image">
  <img src="/uploads/2023/03/python-tracing-03.png" alt=""  />
</p>

</p>
<p><em>Output of our program using the <code>autologging</code> package.</em></p>
<h1 id="using-icecream">
    <a href="#using-icecream">
	Using <code>icecream</code>
    </a>
</h1>
<p>At this point Andreas Thienemann mentioned <code>icecream</code>, which is remarkable comfortable.
Versions of <code>icecream</code> exist for many programming languages, so this is not Python specific.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">icecream</span> <span class="kn">import</span> <span class="n">ic</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ic</span><span class="o">.</span><span class="n">configureOutput</span><span class="p">(</span><span class="n">includeContext</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Fac</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">pass</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">fac</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">ic</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">ic</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">ic</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">fac</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">f</span> <span class="o">=</span> <span class="n">Fac</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">fac</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</span></span></code></pre></div><p>Icecream defined a function <code>ic()</code>, which you can call with parameters (<code>ic(n)</code>, <code>ic(1)</code>, and <code>ic(n * self.fac(n - 1))</code>), or without (<code>ic()</code>).
The function will print its parameters, just like a debug print, or when called without parameters, just log its execution including source file and line.
Options to prettify the output exist.</p>
<p>The package also provides a function <code>install()</code>, which will simply make <code>ic()</code> available as a builtin:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">icecream</span> <span class="kn">import</span> <span class="n">ic</span>
</span></span><span class="line"><span class="cl"><span class="n">install</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="c1"># this basically does builtin.ic = ic</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ic() is now available in all your modules </span>
</span></span><span class="line"><span class="cl"><span class="c1"># without having to include it in every submodule.</span>
</span></span></code></pre></div><p>The output looks like this:</p>
<p><p class="md__image">
  <img src="/uploads/2023/03/python-tracing-04.png" alt=""  />
</p>

</p>
<p><em>Running our code with <code>icecream</code> produces this output, nicely colorized and pretty printed.
We enabled <code>includeContext=True</code>, so we also get file names and line numbers.</em></p>
<h1 id="snoop-and-birdseye">
    <a href="#snoop-and-birdseye">
	<code>snoop</code> and <code>birdseye</code>
    </a>
</h1>
<p>Of course, this is not the end of it.
The package <a href="https://github.com/alexmojaki/snoop" target="_blank" rel="noopener">snoop</a>

 provides tracing of one or all functions,
comes with its own version of icecream called <code>pp</code> (PrettyPrint).
Using <code>pp.deep()</code>, it will show expression evaluation step by step.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">snoop</span> <span class="kn">import</span> <span class="n">pp</span>
</span></span><span class="line"><span class="cl"><span class="n">pp</span><span class="o">.</span><span class="n">deep</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">max</span><span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="mi">3</span><span class="p">))</span>
</span></span></code></pre></div><p>logs</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">12:34:56.78 LOG:
</span></span></span><span class="line"><span class="cl"><span class="go">12:34:56.78 ............ x = 1
</span></span></span><span class="line"><span class="cl"><span class="go">12:34:56.78 ........ x + 1 = 2
</span></span></span><span class="line"><span class="cl"><span class="go">12:34:56.78 ................ y = 2
</span></span></span><span class="line"><span class="cl"><span class="go">12:34:56.78 ............ y + 2 = 4
</span></span></span><span class="line"><span class="cl"><span class="go">12:34:56.78 ................ y = 2
</span></span></span><span class="line"><span class="cl"><span class="go">12:34:56.78 ............ y + 3 = 5
</span></span></span><span class="line"><span class="cl"><span class="go">12:34:56.78 ........ max(y + 2, y + 3) = 5
</span></span></span><span class="line"><span class="cl"><span class="go">12:34:56.78 .... x + 1 + max(y + 2, y + 3) = 7
</span></span></span></code></pre></div><p>Snoop understands Python:
It shows not just file numbers, but actual code call context, parameters.
It handles debugging Decorators, can log Exceptions properly, and can log call stacks of a configurable depth.</p>
<p>Check out the examples in the link above.</p>
<p><a href="https://github.com/alexmojaki/birdseye" target="_blank" rel="noopener">birdseye</a>

 is a continuation of <code>snoop</code> to the extreme, and integrated with it.
It captures the same data as <code>snoop</code>, but logs it to a SQLite file in your <code>$HOME</code>.
It will then allow you to start a <code>flask</code>-based Webserver on port 7777 to evaluate the trace file and replay it step by step.</p>
<p><code>@spy</code> allows you to run <code>snoop</code> and <code>birdseye</code> in tandem.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">birdseye</span> <span class="kn">import</span> <span class="n">eye</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">snoop</span> <span class="kn">import</span> <span class="n">snoop</span><span class="p">,</span> <span class="n">spy</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@spy</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">fac</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">n</span> <span class="o">*</span> <span class="n">fac</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="n">fac</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">result</span><span class="si">=}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></div><p>This will instrument the code to run with <code>snoop</code>, and also log into the database file.</p>
<p>The trace is pretty:</p>
<p><p class="md__image">
  <img src="/uploads/2023/03/python-tracing-05.png" alt=""  />
</p>

</p>
<p><em>Output of <code>snoop</code> running on our test function. We instrumented with <code>@spy</code>, which will also create a trace file.</em></p>
<p>Running the Birdseye decoder is easy: <code>python -m birdeye</code> will start it on the default port, <code>7777</code>.</p>
<p><p class="md__image">
  <img src="/uploads/2023/03/python-tracing-06.png" alt=""  />
</p>

</p>
<p><em>Starting the <code>birdseye</code> web server to serve trace files. It is bound to localhost, and listens by default on Port <code>7777</code>.</em></p>
<p>The rendered trace looks like this:</p>
<p><p class="md__image">
  <img src="/uploads/2023/03/python-tracing-07.png" alt=""  />
</p>

</p>
<p><em><code>birdseye</code> webserver showing a trace. You can click through the program execution.</em></p>
<h1 id="pysnoop">
    <a href="#pysnoop">
	pysnoop
    </a>
</h1>
<p>(via <a href="https://news.ycombinator.com/item?id=36066786" target="_blank" rel="noopener">lathiat</a>

) A similar but different thing is <a href="https://github.com/cool-RR/PySnooper" target="_blank" rel="noopener">pysnoop</a>

.
You <code>pip install pysnoop</code> and</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="ch">#! /usr/bin/env python3</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pysnooper</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@pysnooper.snoop</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">fac</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">n</span> <span class="o">*</span> <span class="n">fac</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="n">fac</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">result</span><span class="si">=}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></div><p>to get</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">Source</span> <span class="n">path</span><span class="p">:</span><span class="o">...</span> <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">kris</span><span class="o">/</span><span class="n">keks</span><span class="o">.</span><span class="n">py</span>
</span></span><span class="line"><span class="cl"><span class="n">Starting</span> <span class="n">var</span><span class="p">:</span><span class="o">..</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl"><span class="mi">09</span><span class="p">:</span><span class="mi">38</span><span class="p">:</span><span class="mf">58.287242</span> <span class="n">call</span>         <span class="mi">6</span> <span class="k">def</span> <span class="nf">fac</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="mi">09</span><span class="p">:</span><span class="mi">38</span><span class="p">:</span><span class="mf">58.287317</span> <span class="n">line</span>         <span class="mi">7</span>     <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="mi">09</span><span class="p">:</span><span class="mi">38</span><span class="p">:</span><span class="mf">58.287330</span> <span class="n">line</span>        <span class="mi">10</span>         <span class="k">return</span> <span class="n">n</span> <span class="o">*</span> <span class="n">fac</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Starting</span> <span class="n">var</span><span class="p">:</span><span class="o">..</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">    <span class="mi">09</span><span class="p">:</span><span class="mi">38</span><span class="p">:</span><span class="mf">58.287352</span> <span class="n">call</span>         <span class="mi">6</span> <span class="k">def</span> <span class="nf">fac</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="mi">09</span><span class="p">:</span><span class="mi">38</span><span class="p">:</span><span class="mf">58.287369</span> <span class="n">line</span>         <span class="mi">7</span>     <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="mi">09</span><span class="p">:</span><span class="mi">38</span><span class="p">:</span><span class="mf">58.287380</span> <span class="n">line</span>        <span class="mi">10</span>         <span class="k">return</span> <span class="n">n</span> <span class="o">*</span> <span class="n">fac</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">Starting</span> <span class="n">var</span><span class="p">:</span><span class="o">..</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="mi">09</span><span class="p">:</span><span class="mi">38</span><span class="p">:</span><span class="mf">58.287392</span> <span class="n">call</span>         <span class="mi">6</span> <span class="k">def</span> <span class="nf">fac</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="mi">09</span><span class="p">:</span><span class="mi">38</span><span class="p">:</span><span class="mf">58.287405</span> <span class="n">line</span>         <span class="mi">7</span>     <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="mi">09</span><span class="p">:</span><span class="mi">38</span><span class="p">:</span><span class="mf">58.287420</span> <span class="n">line</span>         <span class="mi">8</span>         <span class="k">return</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="mi">09</span><span class="p">:</span><span class="mi">38</span><span class="p">:</span><span class="mf">58.287428</span> <span class="k">return</span>       <span class="mi">8</span>         <span class="k">return</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="n">Return</span> <span class="n">value</span><span class="p">:</span><span class="o">..</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="n">Elapsed</span> <span class="n">time</span><span class="p">:</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000054</span>
</span></span><span class="line"><span class="cl">    <span class="mi">09</span><span class="p">:</span><span class="mi">38</span><span class="p">:</span><span class="mf">58.287456</span> <span class="k">return</span>      <span class="mi">10</span>         <span class="k">return</span> <span class="n">n</span> <span class="o">*</span> <span class="n">fac</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Return</span> <span class="n">value</span><span class="p">:</span><span class="o">..</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">    <span class="n">Elapsed</span> <span class="n">time</span><span class="p">:</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000122</span>
</span></span></code></pre></div><h1 id="peepshow-a-commandline-debugger">
    <a href="#peepshow-a-commandline-debugger">
	<code>peepshow</code>, a commandline debugger
    </a>
</h1>
<p>The package <a href="https://github.com/gergelyk/peepshow" target="_blank" rel="noopener">peepshow</a>

 then offers a full scale commandline debugger, which allows you to trace program execution, set breakpoints and so on.</p>
<p>Unfortunately, it has been abandoned (the last commit was in November 2020), and does not support modern Python.</p>
<h1 id="honeycomb-and-opentracing">
    <a href="#honeycomb-and-opentracing">
	Honeycomb and Opentracing
    </a>
</h1>
<p>What if you cannot access the host your code runs on, for example, because that host is variable and many, because you are running in Kubernetes?
In this case, Honeycomb and other OpenTelemetry packages have you covered.
They do the same logging as above, but package data in OpenTelemetry Spans, and send these over the network.</p>
<p>The old, original Honeycomb Beeline for Python is documented here: <a href="https://docs.honeycomb.io/getting-data-in/beeline/python/" target="_blank" rel="noopener">Python Beeline</a>

.
The current OTel compatible implementation is here: <a href="https://docs.honeycomb.io/getting-data-in/opentelemetry/python/" target="_blank" rel="noopener">OTel replacement</a>

.</p>
<p>A medium article discussion the same decorator usage as we do here, but in the context of OpenTelemetry, is available:
<a href="https://digma.ai/blog/using-decorators-to-instrument-python-code-with-opentelemetry-traces/" target="_blank" rel="noopener">Using Decorators to Instrument Python Code With OpenTelemetry Traces</a>

.</p>
<h1 id="and-in-c">
    <a href="#and-in-c">
	And in C?
    </a>
</h1>
<p>A similar solution exists for the C programming language since 1987, in the form of the Fred Fish Debug Macros.</p>
<p>See the usage <a href="https://github.com/mysql/mysql-server/blob/1bfe02bdad6604d54913c62614bde57a055c8332/mysys/list.cc#L44-L56" target="_blank" rel="noopener">in MySQL</a>

,
and grab <a href="https://github.com/mysql/mysql-server/blob/1bfe02bdad6604d54913c62614bde57a055c8332/mysys/dbug.cc" target="_blank" rel="noopener">the source</a>

.</p>
<p>This is older than time itself, and C is a bit limited compared to Python, but it basically does the same thing, in 36 years old code.</p>
<p>The code for these samples has been made avialable <a href="https://github.com/isotopp/logging-experiments" target="_blank" rel="noopener">on GitHub</a>

.</p>

			</div>
		</div>

		
		
		<div class='row justify-content-center py-3 mb-3 mx-0'>
			<div class='col-lg-8 text-center'>
				<span class='letter-spacing-01 text-uppercase text-secondary me-2'>Tags</span>
				
				<a href="/tags/#lang_en" class='btn btn-sm btn-outline-primary mb-1'>
				<svg class="bi" width="1rem" height="1rem" fill="currentColor">
					<use xlink:href="/bootstrap-icons.svg#tag-fill"></use>
				</svg>
				lang_en
				</a>
				
				<a href="/tags/#python" class='btn btn-sm btn-outline-primary mb-1'>
				<svg class="bi" width="1rem" height="1rem" fill="currentColor">
					<use xlink:href="/bootstrap-icons.svg#tag-fill"></use>
				</svg>
				python
				</a>
				
				<a href="/tags/#debug" class='btn btn-sm btn-outline-primary mb-1'>
				<svg class="bi" width="1rem" height="1rem" fill="currentColor">
					<use xlink:href="/bootstrap-icons.svg#tag-fill"></use>
				</svg>
				debug
				</a>
				
			</div>
		</div>

		
		
		
		
		<div class='row justify-content-center py-3 mb-3 mx-0'>
			<div class='col-lg-8 text-center'>
				<a href="https://github.com/isotopp/isotopp.github.io/edit/main/content/posts/2023-03-14-tracing-python.md"
				   rel="noopener noreferrer" target="_blank">
					<span class='letter-spacing-01 text-uppercase text-secondary me-2'>Suggest Changes</span>
				</a>
			</div>
		</div>
		

		<div class='row justify-content-center mx-0'>
			<div class='col-lg-4 text-center text-lg-start'>
				
				<div>
					<div class='letter-spacing-01 text-uppercase text-secondary'>
						Previous Post
					</div>
					<a class='text-decoration-none' href="https://blog.koehntopp.info/2023/03/06/selecting-random-rows.html">MySQL: Selecting random rows</a>
				</div>
				
			</div>

			<div class='col-lg-4 text-lg-end mt-5 mt-lg-0 text-center'>
				
				<div>
					<div class='letter-spacing-01 text-uppercase text-secondary'>
						Next Post
					</div>
					<a class='text-decoration-none' href="https://blog.koehntopp.info/2023/04/04/mysql-sovereign-dbaas-decoded.html">MySQL: SeveralNines Podcast with Kris</a>
				</div>
				
			</div>
		</div>


		
	</article>
</div>



            <footer class='row justify-content-center mb-4 pb-4 mx-0'>
  <div class='col-8 text-center'>
    <div>
      A collection of old stuff, new stuff and random stuff.
    </div>
    <div class='row text-primary mt-4'>
      <div class='col'>

        <a href='/feed.xml' title='Follow RSS feed' class='me-3 text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#rss-fill'/>
          </svg>
        </a>

        <a href='mailto:kristian.koehntopp@gmail.com' title='Email' class='me-3 text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#envelope'/>
          </svg>
        </a>

        <a href='https://github.com/isotopp' title='Follow on GitHub' class='me-3 text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#github'/>
          </svg>
        </a>

        <a rel="me" href="https://infosec.exchange/@isotopp" title='Follow on Mastodon' class='me-3 text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#mastodon'/>
          </svg>
        </a>

        
        <a href='http://steamcommunity.com/id/ixotopp' title='Follow on Steam' class='me-3 text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#steam'/>
          </svg>
        </a>

        

        <a href='https://www.youtube.com/user/isotopp' title='Follow on YouTube' class=''>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#youtube'/>
          </svg>
        </a>
      </div>
    </div>
  </div>
</footer>


        </main>

	





<script src="https://blog.koehntopp.info/js/bootstrap.js"></script>




<script src="https://blog.koehntopp.info/js/lunr.js"></script>





<script src="https://blog.koehntopp.info/js/app.js"></script>


    </body>
</html>
