<!doctype html>
<html lang="en">
    <head>
    <meta charset="utf-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<title>Getting rid of phishing training mails | Die wunderbare Welt von Isotopp</title>
<meta name="description" content="Kris Köhntopp&#39;s blog (Fedi: @isotoppinfosec.exchange)">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" href="icon.png">
<link rel="icon" href="favicon.ico" type="image/ico">
<link rel="shortcut icon" href="favicon.ico">
<link rel="canonical" href="https://blog.koehntopp.info/2023/05/23/getting-rid-of-phishing-training-mails.html">

<link rel="alternate" type="application/rss+xml" href='https://blog.koehntopp.info/feed.xml' title="Die wunderbare Welt von Isotopp">
<link rel="alternate" type="application/rss+xml" href='https://blog.koehntopp.info/tags/mysql/feed.xml' title="Feed: mysql Articles for Die wunderbare Welt von Isotopp">
<link rel="alternate" type="application/rss+xml" href='https://blog.koehntopp.info/tags/review/feed.xml' title="Feed: review Articles for Die wunderbare Welt von Isotopp">


<meta name="generator" content="Hugo 0.145.0">
<meta property="og:title" content='Getting rid of phishing training mails | Die wunderbare Welt von Isotopp' />
<meta property="og:site_name" content='Die wunderbare Welt von Isotopp' />
<meta property="og:locale" content="en_US" />
<meta name="description" content='Kris Köhntopp&#39;s blog (Fedi: @isotoppinfosec.exchange)' />
<meta property="og:description" content='Kris Köhntopp&#39;s blog (Fedi: @isotoppinfosec.exchange)' />
<meta property="og:url" content="https://blog.koehntopp.info/2023/05/23/getting-rid-of-phishing-training-mails.html" />
<meta property="og:type" content="article" />
<meta name="article:published_time" content='2023-05-23T01:02:03Z' />
<meta name="fediverse:creator" content="@isotopp@infosec.exchange">
<meta property="og:image" content='https://blog.koehntopp.info/assets/img/background/schloss.jpg' />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:creator" content='@isotopp@infosec.exchange' />
<meta property="twitter:title" content='Getting rid of phishing training mails' />
<meta property="twitter:description" content='Kris Köhntopp&#39;s blog (Fedi: @isotoppinfosec.exchange)' />
<meta property="twitter:image" content='https://blog.koehntopp.info/assets/img/background/schloss.jpg' />


    



<link rel="stylesheet" href="https://blog.koehntopp.info/style.min.dd9d518fe6cac55191b6af874e18327dff051055754ffc7e106131baf826e6d3.css">


    </head>
    <body>
        

        <nav class="navbar navbar-expand-lg navbar-light px-lg-4 pt-lg-4">
    <div class="container-fluid">
        <a class="navbar-brand justify-content-center" href="https://blog.koehntopp.info/" rel="home" title="Die wunderbare Welt von Isotopp">
            <img alt="Kris" height='48' width='48' src='/assets/img/avatars/isotopp.jpg' class='p-0 me-3 d-block d-lg-inline'>
            <span class='h4 d-block d-lg-inline'>Die wunderbare Welt von Isotopp</span>
        </a>

        <button class="navbar-toggler ms-auto" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse text-center" id="navbarSupportedContent">
            <ul class="navbar-nav ms-auto">
                
                <li class="nav-item ">
                    <a class="nav-link" href="/about/">
                        <span class="">About</span>
                        
                    </a>
                </li>
                <li class="nav-item ">
                    <a class="nav-link" href="/contribute/">
                        <span class="">Contribute</span>
                        
                    </a>
                </li>
                <li class="nav-item ">
                    <a class="nav-link" href="/search/">
                        <span class=""><svg class='bi' height='1.5rem' width='1.5rem' fill='currentColor'><use xlink:href='/bootstrap-icons.svg#search'/></svg></span>
                        
                    </a>
                </li>
                <li class="nav-item ">
                    <a class="nav-link" href="/tags/">
                        <span class=""><svg class='bi' width='1.5rem' height='1.5rem' fill='currentColor'><use xlink:href='/bootstrap-icons.svg#tags-fill'/></svg></span>
                        
                    </a>
                </li>
                
            </ul>
            
        </div>

    </div>
</nav>


        <main role="main" class="container-fluid p-0">

            









<div class="page">
	<article class="getting-rid-of-phishing-training-mails-page">
		<div class='row  justify-content-center text-center my-4 mx-0'>
			<header class="headerbanner">
				<div class='col'>
					<h1 class="title mb-lg-4 text-white">
						Getting rid of phishing training mails
					</h1>
					<div class='text-uppercase text-light' style='letter-spacing: 0.1rem;'>
						<img alt='@isotopp@infosec.exchange image' src='/assets/img/avatars/isotopp.jpg' class='me-1 p-0'
						     style='width: 1.9rem; border-radius: 1rem;'>
						<a href="https://infosec.exchange/@isotopp" class='text-light text-decoration-none'>
							Kristian Köhntopp
						</a>
						
						<span class='d-none d-lg-inline'>-</span>
						<div class='d-block d-lg-inline'>May 23, 2023</div>
						
					</div>
				</div>
				
				<img alt='a featured image' src="/assets/img/background/schloss.jpg">
				
			</header>
		</div>

		<div class='row justify-content-center mx-0'>
			<div class='col-lg-4 text-center text-lg-start'>
				
				<div>
					<div class='letter-spacing-01 text-uppercase text-secondary'>
						Previous Post
					</div>
					<a class='text-decoration-none' href="https://blog.koehntopp.info/2023/05/17/50-years-in-filesystems-towards-2004-lfs.html">50 years in filesystems: towards 2004 – LFS</a>
				</div>
				
			</div>

			<div class='col-lg-4 text-lg-end mt-5 mt-lg-0 text-center'>
				
				<div>
					<div class='letter-spacing-01 text-uppercase text-secondary'>
						Next Post
					</div>
					<a class='text-decoration-none' href="https://blog.koehntopp.info/2023/06/12/what-to-do-with-self-driving-car-data.html">What to do with self-driving car data?</a>
				</div>
				
			</div>
		</div>

		<div class='row justify-content-center mx-0 mt-3 mb-5'>
			<div class="col-lg-8 mb-3">
				
			</div>
			<div class='col-lg-8'>
				<p>Just like your work computer is being infested with corporate malware as to prevent it from being taken over from other people&rsquo;s malware,
your account is also being spammed with corporate malware spam as to prevent it from being taken over by other malware spam.
And just like corporate malware <a href="/2018/06/18/websense-dlp-gives-instant-root.html">increases your machine&rsquo;s attack surface</a>

,
because it is <a href="/2017/10/20/aslr.html">badly written</a>

 and running with privileges,
corporate spam is a useless <a href="https://publikationen.bibliothek.kit.edu/1000119662" target="_blank" rel="noopener">nuisance</a>

 that
<a href="https://blog.lukaszolejnik.com/solving-phishing-is-not-simple-can-anti-phishing-training-make-it-even-worse/" target="_blank" rel="noopener">doesn&rsquo;t do what it is supposed to do</a>

.</p>
<p>Of course, working in an enterprise, you will be subjected to such campaigns anyway.
So the best outcome for you would be to identify a phishing training campaign when it runs the first time,
and then upgrade your filters so that you will never be bothered again.</p>
<p>The good news is that all phishing training campaigns have automatically detectable traits,
mostly X-Header lines, because the campaign needs to be able to deliver quantifiable results to the corporate overlords that pay for it.
And of course, we can filter for these.</p>
<h1 id="the-x-header">
    <a href="#the-x-header">
	The X-Header
    </a>
</h1>
<p>What X-Header actually is being used depends a lot on the Phishing Training service provider your company is using.
It may be something such as <code>X-KnowB4</code> or <code>X-PhishMe</code> or similar.
To find out what it is, you need to check the actual raw message content.</p>
<p>In Mail.app, select the message you have identified as phishing training mail, and select
<code>View -&gt; Message -&gt; Raw Source (⌥⌘U)</code>.
Then check for lines that start with <code>X-</code> in the header that identify the training provider or reference &ldquo;Phish&rdquo;.</p>
<p><p class="md__image">
  <img src="/uploads/2023/05/phish-06.png" alt=""  />
</p>

</p>
<p><em>See Message Raw Source in Mail.app.</em></p>
<p>In Outlook for Mac, select the message you have identified as phishing training mail, and select
<code>View Source</code>.
Then check for lines that start with <code>X-</code> in the header that identify the training provider or reference &ldquo;Phish&rdquo;.</p>
<p><p class="md__image">
  <img src="/uploads/2023/05/phish-07.png" alt=""  />
</p>

</p>
<p><em>See Message Raw Source in Outlook for Mac.</em></p>
<p>The line you are looking for might be looking like this:</p>
<p><p class="md__image">
  <img src="/uploads/2023/05/phish-08.png" alt=""  />
</p>

</p>
<p>*In our case, the line identifying the phishing training mails looks like <code>X-Phishme: Phishing_Training</code>.
In fact, we only care about the presence of the <code>X-PhishMe</code> header line and the actual value after the <code>:</code> is completely irrelevant.</p>
<p>This header, in the exact spelling shown, is what we want. It is best to copy and paste it to prevent spelling errors.</p>
<h1 id="mailapp">
    <a href="#mailapp">
	Mail.app
    </a>
</h1>
<p>I&rsquo;m on a Mac, and for a long time my corporate email was on Gmail.
Unfortunately, Gmail cannot filter on arbitrary X-headers, and registering an application to OAuth against corporate mail is complicated.
But Apple&rsquo;s <code>Mail.app</code> comes preregistered, was allowed, and can filter.</p>
<p><p class="md__image">
  <img src="/uploads/2023/05/phish-01.png" alt=""  />
</p>

</p>
<p>So I can just sacrifice another 200 MB or so to the God of Better Mail and get proper filters in return.
In any case, <code>⌘-,</code> (&ldquo;Cmd-Comma&rdquo;) gives me the <code>Rules</code> menu, and from there I can <code>Add Rule</code>.</p>
<p><p class="md__image">
  <img src="/uploads/2023/05/phish-02.png" alt=""  />
</p>

</p>
<p>You would want to add a filter on the Header-Line <code>X-PhishMe</code>.
For what, we want to create a rule that looks like this:</p>
<p><p class="md__image">
  <img src="/uploads/2023/05/phish-03.png" alt=""  />
</p>

</p>
<p><em>This is what our filter should look like, but it can&rsquo;t.
That is, because the first time around Mail.app does not know about this <code>X-</code> header.</em></p>
<p>Currently, your Mail.app does not yet understand this particular X-Header, so when you want to create this rule,
you need to <code>Edit header list...</code>.</p>
<p><p class="md__image">
  <img src="/uploads/2023/05/phish-04.png" alt=""  />
</p>

</p>
<p>and then add the header to the list of known header lines:</p>
<p><p class="md__image">
  <img src="/uploads/2023/05/phish-05.png" alt=""  />
</p>

</p>
<p>Only now can you create the filter as shown above.
In this example, I have moved the message to the Trash Bin, but you can choose any target you want.
Whatever you do, make sure that the last action you choose is &ldquo;Stop evaluating rules&rdquo;, then hit OK.</p>
<p><strong>Now drag the rule up so that it becomes the first rule in the list.</strong></p>
<p>You are done.</p>
<h1 id="outlook">
    <a href="#outlook">
	Outlook
    </a>
</h1>
<p>In Outlook for Mac, also hit <code>⌘-,</code> (&ldquo;Cmd-Comma&rdquo;) and choose <code>Rules</code>.
Create a new rule and make sure it is enabled:</p>
<p><p class="md__image">
  <img src="/uploads/2023/05/phish-09.png" alt=""  />
</p>

</p>
<p>The rule should look like this:</p>
<p><p class="md__image">
  <img src="/uploads/2023/05/phish-10.png" alt=""  />
</p>

</p>
<p>That is, move the message to a folder of your choice, and make sure to enable &ldquo;Stop processing more rules&rdquo;.
Make sure the rule is the first one in the list.</p>
<p>You are done.</p>
<h1 id="summary">
    <a href="#summary">
	Summary
    </a>
</h1>
<p>All phishing trainings need to have uniquely identifiable marks in order for the training campaign to produce the required key performance indicators.
We can find these labels and use them to filter.
Our mailer will automatically ignore subsequent runs of the phishing training, for our peace of mind.</p>

			</div>
		</div>

		
		
		<div class='row justify-content-center py-3 mb-3 mx-0'>
			<div class='col-lg-8 text-center'>
				<span class='letter-spacing-01 text-uppercase text-secondary me-2'>Tags</span>
				
				<a href="/tags/#lang_en" class='btn btn-sm btn-outline-primary mb-1'>
				<svg class="bi" width="1rem" height="1rem" fill="currentColor">
					<use xlink:href="/bootstrap-icons.svg#tag-fill"></use>
				</svg>
				lang_en
				</a>
				
				<a href="/tags/#security" class='btn btn-sm btn-outline-primary mb-1'>
				<svg class="bi" width="1rem" height="1rem" fill="currentColor">
					<use xlink:href="/bootstrap-icons.svg#tag-fill"></use>
				</svg>
				security
				</a>
				
				<a href="/tags/#spam" class='btn btn-sm btn-outline-primary mb-1'>
				<svg class="bi" width="1rem" height="1rem" fill="currentColor">
					<use xlink:href="/bootstrap-icons.svg#tag-fill"></use>
				</svg>
				spam
				</a>
				
			</div>
		</div>

		
		
		
		
		<div class='row justify-content-center py-3 mb-3 mx-0'>
			<div class='col-lg-8 text-center'>
				<a href="https://github.com/isotopp/isotopp.github.io/edit/main/content/posts/2023-05-23-getting-rid-of-phishing-training-mails.md"
				   rel="noopener noreferrer" target="_blank">
					<span class='letter-spacing-01 text-uppercase text-secondary me-2'>Suggest Changes</span>
				</a>
			</div>
		</div>
		

		<div class='row justify-content-center mx-0'>
			<div class='col-lg-4 text-center text-lg-start'>
				
				<div>
					<div class='letter-spacing-01 text-uppercase text-secondary'>
						Previous Post
					</div>
					<a class='text-decoration-none' href="https://blog.koehntopp.info/2023/05/17/50-years-in-filesystems-towards-2004-lfs.html">50 years in filesystems: towards 2004 – LFS</a>
				</div>
				
			</div>

			<div class='col-lg-4 text-lg-end mt-5 mt-lg-0 text-center'>
				
				<div>
					<div class='letter-spacing-01 text-uppercase text-secondary'>
						Next Post
					</div>
					<a class='text-decoration-none' href="https://blog.koehntopp.info/2023/06/12/what-to-do-with-self-driving-car-data.html">What to do with self-driving car data?</a>
				</div>
				
			</div>
		</div>


		
	</article>
</div>



            <footer class='row justify-content-center mb-4 pb-4 mx-0'>
  <div class='col-8 text-center'>
    <div>
      A collection of old stuff, new stuff and random stuff.
    </div>
    <div class='row text-primary mt-4'>
      <div class='col'>

        <a href='/feed.xml' title='Follow RSS feed' class='me-3 text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#rss-fill'/>
          </svg>
        </a>

        <a href='mailto:kristian.koehntopp@gmail.com' title='Email' class='me-3 text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#envelope'/>
          </svg>
        </a>

        <a href='https://github.com/isotopp' title='Follow on GitHub' class='me-3 text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#github'/>
          </svg>
        </a>

        <a rel="me" href="https://infosec.exchange/@isotopp" title='Follow on Mastodon' class='me-3 text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#mastodon'/>
          </svg>
        </a>

        
        <a href='http://steamcommunity.com/id/ixotopp' title='Follow on Steam' class='me-3 text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#steam'/>
          </svg>
        </a>

        

        <a href='https://www.youtube.com/user/isotopp' title='Follow on YouTube' class=''>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#youtube'/>
          </svg>
        </a>
      </div>
    </div>
  </div>
</footer>


        </main>

	





<script src="https://blog.koehntopp.info/js/bootstrap.js"></script>




<script src="https://blog.koehntopp.info/js/lunr.js"></script>





<script src="https://blog.koehntopp.info/js/app.js"></script>


    </body>
</html>
