<!doctype html>
<html lang="en">
    <head>
    <meta charset="utf-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<title>NAT ist kein Sicherheitsfeature | Die wunderbare Welt von Isotopp</title>
<meta name="description" content="Kris Köhntopp&#39;s blog (Fedi: @isotoppinfosec.exchange)">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" href="icon.png">
<link rel="icon" href="favicon.ico" type="image/ico">
<link rel="shortcut icon" href="favicon.ico">
<link rel="canonical" href="https://blog.koehntopp.info/2010/11/28/nat-ist-kein-sicherheitsfeature.html">

<link rel="alternate" type="application/rss+xml" href='https://blog.koehntopp.info/feed.xml' title="Die wunderbare Welt von Isotopp">
<link rel="alternate" type="application/rss+xml" href='https://blog.koehntopp.info/tags/mysql/feed.xml' title="Feed: mysql Articles for Die wunderbare Welt von Isotopp">
<link rel="alternate" type="application/rss+xml" href='https://blog.koehntopp.info/tags/review/feed.xml' title="Feed: review Articles for Die wunderbare Welt von Isotopp">


<meta name="generator" content="Hugo 0.145.0">
<meta property="og:title" content='NAT ist kein Sicherheitsfeature | Die wunderbare Welt von Isotopp' />
<meta property="og:site_name" content='Die wunderbare Welt von Isotopp' />
<meta property="og:locale" content="de_DE" />
<meta name="description" content='Kris Köhntopp&#39;s blog (Fedi: @isotoppinfosec.exchange)' />
<meta property="og:description" content='Kris Köhntopp&#39;s blog (Fedi: @isotoppinfosec.exchange)' />
<meta property="og:url" content="https://blog.koehntopp.info/2010/11/28/nat-ist-kein-sicherheitsfeature.html" />
<meta property="og:type" content="article" />
<meta name="article:published_time" content='2010-11-28T14:59:23Z' />
<meta name="fediverse:creator" content="@isotopp@infosec.exchange">
<meta property="og:image" content='https://blog.koehntopp.info/assets/img/background/schloss.jpg' />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:creator" content='@isotopp@infosec.exchange' />
<meta property="twitter:title" content='NAT ist kein Sicherheitsfeature' />
<meta property="twitter:description" content='Kris Köhntopp&#39;s blog (Fedi: @isotoppinfosec.exchange)' />
<meta property="twitter:image" content='https://blog.koehntopp.info/assets/img/background/schloss.jpg' />


    



<link rel="stylesheet" href="https://blog.koehntopp.info/style.min.dd9d518fe6cac55191b6af874e18327dff051055754ffc7e106131baf826e6d3.css">


    </head>
    <body>
        

        <nav class="navbar navbar-expand-lg navbar-light px-lg-4 pt-lg-4">
    <div class="container-fluid">
        <a class="navbar-brand justify-content-center" href="https://blog.koehntopp.info/" rel="home" title="Die wunderbare Welt von Isotopp">
            <img alt="Kris" height='48' width='48' src='/assets/img/avatars/isotopp.jpg' class='p-0 me-3 d-block d-lg-inline'>
            <span class='h4 d-block d-lg-inline'>Die wunderbare Welt von Isotopp</span>
        </a>

        <button class="navbar-toggler ms-auto" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse text-center" id="navbarSupportedContent">
            <ul class="navbar-nav ms-auto">
                
                <li class="nav-item ">
                    <a class="nav-link" href="/about/">
                        <span class="">About</span>
                        
                    </a>
                </li>
                <li class="nav-item ">
                    <a class="nav-link" href="/contribute/">
                        <span class="">Contribute</span>
                        
                    </a>
                </li>
                <li class="nav-item ">
                    <a class="nav-link" href="/search/">
                        <span class=""><svg class='bi' height='1.5rem' width='1.5rem' fill='currentColor'><use xlink:href='/bootstrap-icons.svg#search'/></svg></span>
                        
                    </a>
                </li>
                <li class="nav-item ">
                    <a class="nav-link" href="/tags/">
                        <span class=""><svg class='bi' width='1.5rem' height='1.5rem' fill='currentColor'><use xlink:href='/bootstrap-icons.svg#tags-fill'/></svg></span>
                        
                    </a>
                </li>
                
            </ul>
            
        </div>

    </div>
</nav>


        <main role="main" class="container-fluid p-0">

            









<div class="page">
	<article class="nat-ist-kein-sicherheitsfeature-page">
		<div class='row  justify-content-center text-center my-4 mx-0'>
			<header class="headerbanner">
				<div class='col'>
					<h1 class="title mb-lg-4 text-white">
						NAT ist kein Sicherheitsfeature
					</h1>
					<div class='text-uppercase text-light' style='letter-spacing: 0.1rem;'>
						<img alt='@isotopp@infosec.exchange image' src='/assets/img/avatars/isotopp.jpg' class='me-1 p-0'
						     style='width: 1.9rem; border-radius: 1rem;'>
						<a href="https://infosec.exchange/@isotopp" class='text-light text-decoration-none'>
							Kristian Köhntopp
						</a>
						
						<span class='d-none d-lg-inline'>-</span>
						<div class='d-block d-lg-inline'>November 28, 2010</div>
						
					</div>
				</div>
				
				<img alt='a featured image' src="/assets/img/background/schloss.jpg">
				
			</header>
		</div>

		<div class='row justify-content-center mx-0'>
			<div class='col-lg-4 text-center text-lg-start'>
				
				<div>
					<div class='letter-spacing-01 text-uppercase text-secondary'>
						Previous Post
					</div>
					<a class='text-decoration-none' href="https://blog.koehntopp.info/2010/11/24/freunde-und-soziale-netzwerke.html">&#34;Freunde&#34; und soziale Netzwerke</a>
				</div>
				
			</div>

			<div class='col-lg-4 text-lg-end mt-5 mt-lg-0 text-center'>
				
				<div>
					<div class='letter-spacing-01 text-uppercase text-secondary'>
						Next Post
					</div>
					<a class='text-decoration-none' href="https://blog.koehntopp.info/2010/12/15/schnitzeljagd-2010-die-rache-der-cyborgs.html">Schnitzeljagd 2010 - Die Rache der Cyborgs</a>
				</div>
				
			</div>
		</div>

		<div class='row justify-content-center mx-0 mt-3 mb-5'>
			<div class="col-lg-8 mb-3">
				
			</div>
			<div class='col-lg-8'>
				<p>Neulich hatte ich wieder einmal die Standard-Diskussion mit jemandem, der
gegen IPV6 war, weil er dann ja kein NAT mehr habe. Dadurch, so die
Argumentation, würde er ja die Sicherheitsfunktionen verlieren - derzeit
verhindere sein Türstopper-Plastikrouter halt, daß man seine internen
Rechner von außen angreifen könne.</p>
<p>Diesen Zahn zu ziehen ist oft eine schmerzhafte Operation. Aber schon immer
galt: <em>NAT ist kein Sicherheits-Feature.</em> Ganz besonders nicht das NAT, das
auf einem Türstopper-Plastikrouter läuft.</p>
<p>NAT steht für Network Address Translation, und bezeichnet in der Regel das
Umschreiben von Original-IP-Nummern und Original-Portnummern auf
Ersatz-IP-Nummern und Ersatz-Portnummern &lsquo;im Flug&rsquo;, also während des
Routingvorgangs.</p>
<p><p class="md__image">
  <img src="/uploads/network-nat-out.png" alt=""  />
</p>

</p>
<p>Ausgehendes Paket erzeugt Eintrag in der NAT State Table.</p>
<p>Im Beispiel wird ein ausgehendes IP-Paket von einem Rechner im LAN
versendet. Der Rechner hat die IP-Nummer 192.168.1.4, und das Paket wird von
Port 33231 aus abgesendet. Es ist an einen Rechner 134.245.74.3 addressiert,
und ist vermutlich ein Webzugriff, da es dort an den Port 80 zugestellt
werden soll.</p>
<p>Die Nummer 192.168.1.4 ist eine Nummer aus einem sogenannten RFC-Netz
(gemeint ist <a href="http://tools.ietf.org/html/rfc1918" target="_blank" rel="noopener">RFC 1918</a>

, der IP-Nummern
für die Verwendung in privaten Netzwerken definiert). Sie kann draußen, im
&lsquo;richtigen Internet&rsquo; nicht verwendet werden und muß durch NAT ersetzt
werden, damit der Rechner im privaten Netz überhaupt auf das Netz zugreifen
kann.</p>
<p>Der Router, der die Verbindung in das Internet aufrecht erhält, hat nur eine
einzige externe IP-Nummer, da
<a href="http://www.potaroo.net/tools/ipv4/index.html" target="_blank" rel="noopener">IP V4 Adressen knapp sind</a>

.
Er wandelt die Absender-Adresse 192.168.1.4 in seine eigene Adresse um - und
setzt im Beispiel 198.32.16.8 ein. Er überschreibt auch die Portnummer 33231
mit einer Portnummer, die bei ihm frei ist, im Beispiel also 2001.</p>
<p>Dann sendet er das modifizierte Paket ins Internet.</p>
<p><p class="md__image">
  <img src="/uploads/network-nat-in.png" alt=""  />
</p>

</p>
<p>Durch den Eintrag in der State Table wird jedes auf Port 2001 eingehende
Paket an den internen Host weiter geleitet.</p>
<p>So weit so gut. Der Router muß aber auch mit einem Antwortpaket fertig
werden und dies an den internen Rechner zustellen können. Er legt sich also
eine Tabelle an, in der er vermerkt: &ldquo;Eintreffende Pakete auf Port 2001 an
192.168.1.4:33231 zurück leiten&rdquo;. Durch diese NAT State Table kann er für
ein auf Port 2001 eintreffendes Paket die Rückumwandlung vornehmen.</p>
<p>Dies ist die einfachste Mögliche NAT-Implementierung (ein
<a href="http://en.wikipedia.org/wiki/Network_address_translation#Types_of_NAT" target="_blank" rel="noopener">Full Cone NAT</a>

 nach
<a href="http://tools.ietf.org/html/rfc3489" target="_blank" rel="noopener">RFC 3489</a>

) - und die, die am wenigsten
Speicher verbraucht, denn diese Variante verbraucht pro aktiver &ldquo;Verbindung&rdquo;
am wenigsten Speicher, und Speicher ist auf einem Plastik-Türstopper nun
einmal begrenzt.</p>
<p>Und selbst dann kann diese interne Tabelle so groß machen, daß der Speicher
des Türstoppers einfach überläuft und er sich spontan resettet, etwa wenn
das innere Netz eine WG ist, auf der 3 oder 4 Leute gleichzeitig
P2P-Programme laufen lassen, von denen jedes pro Download an die 200
Einträge in der NAT State Table belegt.</p>
<p>Leider ist diese NAT-Implementierung so einfach, daß bei auf Port 2001
eintreffenden Paketen keine Information darüber vorliegt, von wo diese
eintreffen dürfen. Jedes beliebige Paket von Port 2001 wird also nach innen
weitergeleitet - das solche, die von irgendwelchen anderen IP-Nummern außen
aus dem Internet abgesendet werden.</p>
<p>Bessere Sicherheit bietet ein volles Verbindungstracking, das ein richtiges
symmetrisches NAT zur Verfügung stellt, und das insbesondere auch TCP
versteht und das Ende einer Verbindung erkennt, um in diesem Fall den
Eintrag in der NAT State Table zeitgerecht wieder abzuräumen.</p>
<p>Wenn man diese Logik aber erst einmal implementiert hat, dann kann man auch
gleich eine vollständige Firewall mit Connection Tracking implementieren
(oder kostenlos dazu bekommen, weil man in diesem Fall wahrscheinlich
sowieso ein embedded Linux auf dem Router am Laufen hat), und dann kommt die
Sicherheit nicht vom NAT, sondern von der Firewall.</p>
<p>Wer also sein Netzwerk schützen will, der sollte nicht NAT verwenden,
sondern sich eine gescheite Firewall installieren und dann sinnvoll
konfigurieren. Machen andere Läden mit
<a href="http://www.heise.de/newsticker/meldung/Bundeswehr-verzichtet-auf-NAT-1138736.html" target="_blank" rel="noopener">erhöhten Sicherheitsanforderungen</a>


auch genau so.</p>

			</div>
		</div>

		
		
		<div class='row justify-content-center py-3 mb-3 mx-0'>
			<div class='col-lg-8 text-center'>
				<span class='letter-spacing-01 text-uppercase text-secondary me-2'>Tags</span>
				
				<a href="/tags/#computer" class='btn btn-sm btn-outline-primary mb-1'>
				<svg class="bi" width="1rem" height="1rem" fill="currentColor">
					<use xlink:href="/bootstrap-icons.svg#tag-fill"></use>
				</svg>
				computer
				</a>
				
				<a href="/tags/#internet" class='btn btn-sm btn-outline-primary mb-1'>
				<svg class="bi" width="1rem" height="1rem" fill="currentColor">
					<use xlink:href="/bootstrap-icons.svg#tag-fill"></use>
				</svg>
				internet
				</a>
				
				<a href="/tags/#security" class='btn btn-sm btn-outline-primary mb-1'>
				<svg class="bi" width="1rem" height="1rem" fill="currentColor">
					<use xlink:href="/bootstrap-icons.svg#tag-fill"></use>
				</svg>
				security
				</a>
				
				<a href="/tags/#lang_de" class='btn btn-sm btn-outline-primary mb-1'>
				<svg class="bi" width="1rem" height="1rem" fill="currentColor">
					<use xlink:href="/bootstrap-icons.svg#tag-fill"></use>
				</svg>
				lang_de
				</a>
				
			</div>
		</div>

		
		
		
		
		<div class='row justify-content-center py-3 mb-3 mx-0'>
			<div class='col-lg-8 text-center'>
				<a href="https://github.com/isotopp/isotopp.github.io/edit/main/content/posts/2010-11-28-nat-ist-kein-sicherheitsfeature.md"
				   rel="noopener noreferrer" target="_blank">
					<span class='letter-spacing-01 text-uppercase text-secondary me-2'>Suggest Changes</span>
				</a>
			</div>
		</div>
		

		<div class='row justify-content-center mx-0'>
			<div class='col-lg-4 text-center text-lg-start'>
				
				<div>
					<div class='letter-spacing-01 text-uppercase text-secondary'>
						Previous Post
					</div>
					<a class='text-decoration-none' href="https://blog.koehntopp.info/2010/11/24/freunde-und-soziale-netzwerke.html">&#34;Freunde&#34; und soziale Netzwerke</a>
				</div>
				
			</div>

			<div class='col-lg-4 text-lg-end mt-5 mt-lg-0 text-center'>
				
				<div>
					<div class='letter-spacing-01 text-uppercase text-secondary'>
						Next Post
					</div>
					<a class='text-decoration-none' href="https://blog.koehntopp.info/2010/12/15/schnitzeljagd-2010-die-rache-der-cyborgs.html">Schnitzeljagd 2010 - Die Rache der Cyborgs</a>
				</div>
				
			</div>
		</div>


		
	</article>
</div>



            <footer class='row justify-content-center mb-4 pb-4 mx-0'>
  <div class='col-8 text-center'>
    <div>
      A collection of old stuff, new stuff and random stuff.
    </div>
    <div class='row text-primary mt-4'>
      <div class='col'>

        <a href='/feed.xml' title='Follow RSS feed' class='me-3 text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#rss-fill'/>
          </svg>
        </a>

        <a href='mailto:kristian.koehntopp@gmail.com' title='Email' class='me-3 text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#envelope'/>
          </svg>
        </a>

        <a href='https://github.com/isotopp' title='Follow on GitHub' class='me-3 text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#github'/>
          </svg>
        </a>

        <a rel="me" href="https://infosec.exchange/@isotopp" title='Follow on Mastodon' class='me-3 text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#mastodon'/>
          </svg>
        </a>

        
        <a href='http://steamcommunity.com/id/ixotopp' title='Follow on Steam' class='me-3 text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#steam'/>
          </svg>
        </a>

        

        <a href='https://www.youtube.com/user/isotopp' title='Follow on YouTube' class=''>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#youtube'/>
          </svg>
        </a>
      </div>
    </div>
  </div>
</footer>


        </main>

	





<script src="https://blog.koehntopp.info/js/bootstrap.js"></script>




<script src="https://blog.koehntopp.info/js/lunr.js"></script>





<script src="https://blog.koehntopp.info/js/app.js"></script>


    </body>
</html>
