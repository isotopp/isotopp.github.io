<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Die wunderbare Welt von Isotopp</title>
    <link>https://blog.koehntopp.info/</link>
    <description>Recent content on Die wunderbare Welt von Isotopp</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <managingEditor>kris-blog@koehntopp.de (Kristian Köhntopp)</managingEditor>

    
    <webMaster>kris-blog@koehntopp.de (Kristian Köhntopp)</webMaster>

    
    <lastBuildDate>Wed, 04 Jun 2025 12:16:00 +0000</lastBuildDate><atom:link href="https://blog.koehntopp.info/feed.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Recommended</title>
      <link>https://blog.koehntopp.info/2025/06/04/recommended.html</link>
      <pubDate>Wed, 04 Jun 2025 04:05:06 +0000</pubDate><author>kris-blog@koehntopp.de (Kristian Köhntopp)</author>

      <guid>https://blog.koehntopp.info/2025/06/04/recommended.html</guid>
      <description>&lt;p&gt;&lt;a href=&#34;https://www.europesays.com/uk/156725/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;France forces TikTok to ban #SkinnyTok but harmful content still persists&lt;/a&gt;

.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Under pressure from the French government, TikTok has banned the hashtag #SkinnyTok,
a controversial trend linked to the glorification of extreme thinness and unhealthy weight-loss advice.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Tiktok bans many words and tags.
People notice and work around it.&lt;/p&gt;
&lt;p&gt;Babbel: &lt;a href=&#34;https://www.babbel.com/en/magazine/tiktok-language&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;How Censorship Is Creating A New TikTok Language&lt;/a&gt;

&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;From here, people will always find ways to use language that allows them to get around auto-censorship.
Whether anyone will be saying “cornucopia” or “nip nops” a decade from now is anyone’s guess,
though it’s probably unlikely.
Still, certain terms could stand the test of time if they fill a specific need.
If social media companies keep cracking down, however, the terminology will continue to evolve.
No matter what the barrier to communication put in place is,
language (and the people who use it) will find a way through.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;In face, language matters even less.&lt;/p&gt;
&lt;p&gt;LLMs encode the meanings of terms as vectors along many semantic dimensions in a semantic space (&amp;ldquo;latent space&amp;rdquo;).
A concept, then, is a position in that space with a certain diameter — a kind of fuzziness or vagueness.&lt;/p&gt;
&lt;p&gt;When I type something into ChatGPT or a recommender system, the input is broken down into tokens,
and these tokens are mapped to such vectors.&lt;/p&gt;
&lt;p&gt;“I want pizza” becomes:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;I&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;want&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;pizza&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;.&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The tokens are then internally mapped to embeddings, vectors that encode meaning.
So this happens:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;“&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cat&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;”&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;→&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.24&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;1.12&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.58&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;…&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;  
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;“&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dog&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;”&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;→&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.22&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;1.09&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.60&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;…&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;That is, a list of numbers (often normalized between -1 and 1).
But usually there are far more dimensions than shown here — an embedding typically has thousands of dimensions.&lt;/p&gt;
&lt;p&gt;The latent space — the semantic space, what things mean — is self-organizing.
That happens during training.
We don’t know what each dimension in the space represents,
but to the LLM it&amp;rsquo;s how it stores things, their meaning and their relation.&lt;/p&gt;
&lt;p&gt;The encoding has some kind of meaning.
We can check that:
When we look at the vectors for &amp;ldquo;man&amp;rdquo; and &amp;ldquo;woman&amp;rdquo;
and for &amp;ldquo;king&amp;rdquo; and &amp;ldquo;queen&amp;rdquo;,
we can substract &amp;ldquo;man&amp;rdquo; from &amp;ldquo;woman&amp;rdquo; and &amp;ldquo;king&amp;rdquo; from &amp;ldquo;queen&amp;rdquo;
and compare the difference vectors.
They are almost, but not quite the same –
because the difference between these words to us is almost, but not quite the same, in meaning.&lt;/p&gt;
&lt;p&gt;LLMs use these embeddings and their internal model to “compute the next output token.”&lt;/p&gt;
&lt;p&gt;Recommender systems use such embeddings to compare vectors
and find things that are similar to the thing we already have.&lt;/p&gt;
&lt;p&gt;So a recommender learns everything that’s relevant to a user,
and a modern recommender represents the user through a collection of vectors:&lt;/p&gt;
&lt;p&gt;&amp;ldquo;This user is interested in travel, digital policy, databases, bikes.&amp;rdquo;&lt;/p&gt;
&lt;p&gt;These concepts may have other concepts nearby concepts in latent space.
To the model this means they are conceptually related.&lt;/p&gt;
&lt;p&gt;At the same time, the recommender classifies content in the same space,
and can find content that lies close to one of the user’s sub-interests — or content that’s new, but still compatible.&lt;/p&gt;
&lt;p&gt;A modern recommender separates a user’s various interests into distinct areas
and can decide what the user is interested in right now —
meaning,
which of the various user interests is currently active.
Then, this time, it might only serve database content, and next time only bike content.&lt;/p&gt;
&lt;p&gt;A modern recommender will also deliberately serve content that almost — but not quite —
matches the user’s interests, to test how wide the bubble is around the center of that interest vector.
So a bike session might also include urbanism, city development, and other nearby topics.
The recommender will watch carefully to see what kind of response that triggers —
refining its recommendations based on that feedback.&lt;/p&gt;
&lt;p&gt;A modern recommender will also know where the available content clusters are,
and prioritize content that is both relevant to the user and performs well or has current production capacity.
In other words, where user interest and available content overlap well.&lt;/p&gt;
&lt;p&gt;And a modern recommender will reevaluate every twenty minutes
(“Pomodoro”, or “method shift” in educational theory) and attempt to shift the theme —
to test whether another known interest can be reactivated.
If that works, the recommender may manage to keep the user active for a longer time,
exposing them to more ads.&lt;/p&gt;
&lt;p&gt;That’s how TikTok works.&lt;/p&gt;
&lt;p&gt;You can ban a hashtag on TikTok (&lt;code&gt;#skinnytok&lt;/code&gt;).&lt;/p&gt;
&lt;p&gt;But as long as related concepts are marketable and socially accepted — or even demanded — that won’t prevent anything.&lt;/p&gt;
&lt;p&gt;As soon as you browse categories like “model,” “weight loss”, “fitness”, &amp;ldquo;thigh gap&amp;rdquo;, &amp;ldquo;visible collarbone&amp;rdquo;,
or “slim,” TikTok will slowly and systematically pull you into the same region,
and the end result will be the same.&lt;/p&gt;
&lt;p&gt;The actual language, the meaning,
is encoded in the tokens of the latent space of the model, not in the words that are used
(or prohibited).&lt;/p&gt;
&lt;p&gt;And the content density in the models coordinate system will gently push things into certain clusters.
If you feed the system with the right interests, you will always drift – relatively quickly even –
into the same neighborhood and then learn their current slang to get there with a single word.&lt;/p&gt;
&lt;p&gt;No matter what the word actually is.&lt;/p&gt;
&lt;p&gt;A similar example, using GenAI instead of a recommender:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Draw a superheroine, an Amazon warrior that can fly and deflect bullets,
running over a battlefield in the first world war.&amp;quot;&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;These 21 words do not say &amp;ldquo;Wonder Woman&amp;rdquo;, they do not even go near comics, DC, or similar things.&lt;/p&gt;
&lt;p&gt;Yet they draw a thousand-dimensional hyberbubble in latent space, the totality of knowledge known to ChatGPT,
and the end result leaves just one choice – produce this blatant copyright violation.&lt;/p&gt;
&lt;p&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2025/06/recommender-01.png&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/p&gt;
&lt;p&gt;I can trigger content with intent, not even going near the keywords that would be associated with it.&lt;/p&gt;
&lt;p&gt;This is how jailbreaks work in LLMs, and that is also how you jailbreak Tiktok bans.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>MySQL: FLUSH HOSTS</title>
      <link>https://blog.koehntopp.info/2025/05/13/mysql-flush-hosts.html</link>
      <pubDate>Tue, 13 May 2025 05:06:07 +0000</pubDate><author>kris-blog@koehntopp.de (Kristian Köhntopp)</author>

      <guid>https://blog.koehntopp.info/2025/05/13/mysql-flush-hosts.html</guid>
      <description>&lt;p&gt;Sometimes, MySQL throws an error like this:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Host &amp;lsquo;&amp;hellip;&amp;rsquo; is blocked because of many connection errors&lt;/p&gt;
&lt;p&gt;Unblock with &amp;lsquo;mysqladmin flush-hosts&amp;rsquo;&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;This typically means that MySQL has blocked a host after too many connection errors. The usual fix is to run:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;mysqladmin flush-hosts
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;or&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-mysql&#34; data-lang=&#34;mysql&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;mysql&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;FLUSH&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;HOSTS&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;/* deprecated since 8.0.23; invalid in 8.4 */&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mysql&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;TRUNCATE&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;TABLE&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;performance_schema&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;host_cache&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;/* recommended since 5.6.5 */&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;A host is blocked, because of many connection errors, specifically more connection errors than &lt;code&gt;max_connect_errors&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;So&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;what counts as a connection error?&lt;/li&gt;
&lt;li&gt;what is counted per what?&lt;/li&gt;
&lt;li&gt;and how is the error count cleared?&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;max_connect_errors&#34;&gt;
    &lt;a href=&#34;#max_connect_errors&#34;&gt;
	&lt;code&gt;max_connect_errors&lt;/code&gt;
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;There is a configuration variable, &lt;code&gt;max_connect_errors&lt;/code&gt;.
It is documented here:
&lt;a href=&#34;https://dev.mysql.com/doc/refman/8.4/en/server-system-variables.html#sysvar_max_connect_errors&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;MySQL 8.4: &lt;code&gt;max_connect_errors&lt;/code&gt;&lt;/a&gt;

.&lt;/p&gt;
&lt;p&gt;The variable is a 64 bit integer, so it can be set to very large values.
It can be configured via command-line or config file (using dashes instead of underscores), or dynamically at runtime:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-mysql&#34; data-lang=&#34;mysql&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kt&#34;&gt;SET&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;GLOBAL&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;max_connect_errors&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;18446744073709551614&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Check it with&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-mysql&#34; data-lang=&#34;mysql&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;SELECT&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;@@&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;global&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;max_connect_errors&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;By default, it’s set to 100.&lt;/p&gt;
&lt;p&gt;According to MySQL’s documentation,
a host is blocked after more than &lt;code&gt;max_connect_errors&lt;/code&gt; connection attempts from that host fail without a successful connection in between.&lt;/p&gt;
&lt;p&gt;This means:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The error count is tracked per host.&lt;/li&gt;
&lt;li&gt;A successful connection resets the counter, but only if it happens before the threshold is exceeded.&lt;/li&gt;
&lt;li&gt;Once blocked, a host remains blocked indefinitely unless the cache is cleared.&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;unblocking&#34;&gt;
    &lt;a href=&#34;#unblocking&#34;&gt;
	Unblocking
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;MySQL tracks blocked hosts using a structure called the host cache.&lt;/p&gt;
&lt;p&gt;Before MySQL 5.6.5, there was no way to inspect the host cache.
You could run &lt;code&gt;FLUSH HOSTS&lt;/code&gt; to reset it, but you couldn’t see which hosts were blocked or how many errors they had.&lt;/p&gt;
&lt;p&gt;That was lamented by many people, among them yours truly &lt;a href=&#34;https://bugs.mysql.com/bug.php?id=24906&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;in 2006&lt;/a&gt;

.
And Daniel van Eeden &lt;a href=&#34;https://bugs.mysql.com/bug.php?id=59404&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;in 2011&lt;/a&gt;

, on behalf of Booking.com.
That was converted into &lt;a href=&#34;https://dev.mysql.com/worklog/task/?id=5259&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ML#5259&lt;/a&gt;

,
the implementation of &lt;code&gt;PERFORMANCE_SCHEMA.HOST_CACHE&lt;/code&gt;.
It was implemented by Marc Alff starting in 7e3ba778349e8e2bd01b60d6b22f44f7f098d731 in 2-Aug 2011
(released in 5.6.5, after 29-Mar-2012).&lt;/p&gt;
&lt;p&gt;Since then, you can query host cache details directly:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-mysql&#34; data-lang=&#34;mysql&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;SELECT&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;FROM&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;performance_schema&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;host_cache&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;You can also reset it with:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-mysql&#34; data-lang=&#34;mysql&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;TRUNCATE&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;TABLE&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;performance_schema&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;host_cache&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;This works exactly like &lt;code&gt;FLUSH HOSTS&lt;/code&gt;, but uses different permissions:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;FLUSH HOSTS&lt;/code&gt; requires the &lt;code&gt;RELOAD&lt;/code&gt; privilege.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;TRUNCATE TABLE performance_schema.host_cache&lt;/code&gt; requires &lt;code&gt;DROP&lt;/code&gt; privilege on that table.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; &lt;code&gt;FLUSH HOSTS&lt;/code&gt; has been &lt;strong&gt;deprecated as of MySQL 8.0.23 and is removed in MySQL 8.4.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;There is no way to unblock just one host—only clearing the entire host cache resets the counters and unblocks all hosts.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; Changing the host cache size using the &lt;code&gt;host_cache_size&lt;/code&gt; global dynamic variable also flushes the host cache.
This requires the &lt;code&gt;SYSTEM_VARIABLES_ADMIN&lt;/code&gt; privilege (formerly &lt;code&gt;SUPER&lt;/code&gt;).&lt;/p&gt;
&lt;h1 id=&#34;the-host-cache-is-not-a-cache&#34;&gt;
    &lt;a href=&#34;#the-host-cache-is-not-a-cache&#34;&gt;
	The Host Cache is not a cache
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;Despite its name, the host cache does more than traditional caching.&lt;/p&gt;
&lt;p&gt;A cache is a data structure that stores unchanging data locally, because retrieving the data again would be expensive.
A cache can be expired or fully deleted at any time without losing information,
because the original information can be (at cost) retrieved again.&lt;/p&gt;
&lt;p&gt;But MySQL’s host cache stores stateful data—specifically, security-related error counters.
Deleting a host cache entry removes:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;the ip-to-hostname mapping (which can be rebuilt)&lt;/li&gt;
&lt;li&gt;the host&amp;rsquo;s connection error history (which can&amp;rsquo;t)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;This means that resetting the host cache has security implications.
That is increasingly unimportant in modern environments
such as K8s clusters or virtualized environments with a control plane and a service mesh.
In other, more traditional environments it might not be.&lt;/p&gt;
&lt;h1 id=&#34;what-happens-on-connection&#34;&gt;
    &lt;a href=&#34;#what-happens-on-connection&#34;&gt;
	What Happens on Connection
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;When a client connects, MySQL runs &lt;code&gt;sql_connect.cc:check_connection()&lt;/code&gt;, which checks the client’s IP address.&lt;/p&gt;
&lt;p&gt;If &lt;code&gt;name-resolve&lt;/code&gt; is enabled, which it is unless you run with &lt;code&gt;skip-name-resolve&lt;/code&gt;,
MySQL attempts a reverse DNS lookup via &lt;code&gt;hostname_cache.cc:ip_to_hostname()&lt;/code&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;If the IP is already in the host cache and marked valid, DNS lookup is skipped.&lt;/li&gt;
&lt;li&gt;Otherwise, MySQL tries to resolve the IP to a hostname (PTR record),
then resolve the hostname back to an IP (A record).
This is known as Forward Confirmed Reverse DNS (FCR).&lt;/li&gt;
&lt;li&gt;Only hostnames that pass both lookups are marked as &amp;ldquo;validated&amp;rdquo;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The host cache keeps track of connection errors in &lt;code&gt;ip_to_hostname()&lt;/code&gt;
and will block the host if it exceeds the threshold set in &lt;code&gt;max_connect_errors&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;The function also uses the host cache itself, and will avoid DNS resolution if there is an entry that matches this IP.
It maintains error counts and will perform host blocking, if the error count exceeds &lt;code&gt;max_connect_errors&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;The cache uses LRU (Least Recently Used) eviction policy.
If more IPs try to connect than the cache can hold, old entries are removed—including their error counters.
This means that blocked hosts can become unblocked over time if they’re evicted.&lt;/p&gt;
&lt;p&gt;Modern MySQL defaults host_cache_size to &lt;code&gt;-1&lt;/code&gt;, which means it auto-sizes between 128 and 2000 based on &lt;code&gt;max_connections&lt;/code&gt;.
In older versions the size was fixed.&lt;/p&gt;
&lt;p&gt;None of the above will happen if the server is running with &lt;code&gt;skip-name-resolve&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Specifically, the code in &lt;code&gt;sql_connect.cc:check_connection()&lt;/code&gt; will, among other things, not even call &lt;code&gt;ip_to_hostname()&lt;/code&gt;,
thus there will be no usage of the host cache, as no DNS resolution happens.
There will also be no blocking of hosts due to connection errors.&lt;/p&gt;
&lt;h1 id=&#34;recommendations-for-proxy-and-k8s-users&#34;&gt;
    &lt;a href=&#34;#recommendations-for-proxy-and-k8s-users&#34;&gt;
	Recommendations for Proxy and K8s users
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;&lt;strong&gt;TIP:&lt;/strong&gt; Run &lt;code&gt;SHOW PROCESSLIST&lt;/code&gt; multiple times, and check the visible connections.
If they are all always the same host, this recommendation applies to you.&lt;/p&gt;
&lt;p&gt;You may be running MySQL in Kubernetes with a service mesh,
or you may be running MySQL with MySQL Router or MySQL Proxy.
In that case, all connections the server sees will originate from a single IP.&lt;/p&gt;
&lt;p&gt;That means any error by any client will be attributed to the only IP the server sees.
Any single client running with a wrong password will block the only IP your system sees with failed login attempts.
It will lock out all users for all applications with no timeout.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;If the origin IP is &lt;code&gt;127.0.0.1&lt;/code&gt; or &lt;code&gt;[::1]&lt;/code&gt;, no entry in the host cache will be made,
as these addresses are specifically checked for, and are exempt.&lt;br&gt;
&lt;strong&gt;You do not need to act.&lt;/strong&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;If that IP number is fixed, but not one of these two special local addresses,
you &lt;strong&gt;SHOULD&lt;/strong&gt; turn off &lt;code&gt;name-resolve&lt;/code&gt; by running with &lt;code&gt;skip-name-resolve&lt;/code&gt;.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;This will disable the DNS resolution.&lt;/li&gt;
&lt;li&gt;You now need to write access control entries with IP numbers
(&lt;code&gt;GRANT ... TO user@32.16.8.4 ...&lt;/code&gt;),
because names will no longer be resolved.&lt;/li&gt;
&lt;li&gt;Your server will no longer make DNS queries.&lt;/li&gt;
&lt;li&gt;No host blocking on IP will occur.
You will be protected from clients hammering the server with a wrong password.&lt;/li&gt;
&lt;li&gt;You are not losing anything security-wise, as the server has no useful IP information anyway.
Security must be handled by the service mesh.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;You &lt;strong&gt;COULD&lt;/strong&gt; also set the &lt;code&gt;host-cache-size=0&lt;/code&gt; for the same effect, but that will still generate DNS queries,
and a lot of them (two, PTR and A, per connection attempt).
They will always be for that single IP, so they are easily cacheable in external caches.&lt;/p&gt;
&lt;p&gt;You &lt;strong&gt;SHOULD&lt;/strong&gt; set &lt;code&gt;max_connect_errors&lt;/code&gt; to a large value (&lt;code&gt;2^64-1&lt;/code&gt;) to prevent the host cache from locking out any host.
This has no additional benefits over running with &lt;code&gt;skip-name-resolve&lt;/code&gt;: There will be only one host cache entry,
and there will be no per-host error counters, as all connections are seemingly coming from a single host.&lt;/p&gt;
&lt;p&gt;All these measures are compatible, and you can deploy all three of them.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Thermometer</title>
      <link>https://blog.koehntopp.info/2025/04/06/thermometer.html</link>
      <pubDate>Fri, 28 Feb 2025 13:05:06 +0000</pubDate><author>oliof@example.com (Harald Wagener)</author>

      <guid>https://blog.koehntopp.info/2025/04/06/thermometer.html</guid>
      <description>&lt;h1 id=&#34;thermometer&#34;&gt;
    &lt;a href=&#34;#thermometer&#34;&gt;
	Thermometer
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;Eine der wesentlichen Kenngrössen für die Behaglichkeit in den eigenen vier
Wänden ist die Umgebungstemperatur.&lt;/p&gt;
&lt;p&gt;Üblicherweise betrachten wir die Temperatur im Zusammenspiel mit Heizung in der
kalten Jahreszeit. Aufgrund des Klimawandels gewinnt der Aspekt der
Raumtemperaturkühlung aber zunehmend an Bedeutung.&lt;/p&gt;
&lt;p&gt;Thermostate verwenden wir im wesentlichen für drei Dinge: Beobachten, Messen,
und Steuern.&lt;/p&gt;
&lt;h2 id=&#34;beobachten-messen-steuern&#34;&gt;
    &lt;a href=&#34;#beobachten-messen-steuern&#34;&gt;
	Beobachten, Messen, Steuern
    &lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;Diese Begriffe sind natürlich beliebig von mir gewählt, mir hat diese Taxonomie
aber geholfen zu verstehen, was ich an verschiedenen Thermometern gut oder
schlecht fand.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Beobachten: Punktuelle Überprüfung von Umweltfaktoren. Thermometer die für
die Beobachtung geeignet sind, haben ein eigenes Display und die Möglichkeit
weitere Referenzwerte wie die Uhrzeit anzuzeigen.&lt;/li&gt;
&lt;li&gt;Messen: Kontinuierliche Erfassung von Umweltfaktoren. Hier ist wichtig, dass
die Messreihe konsistent und regelmässig aktualisiert wird.&lt;/li&gt;
&lt;li&gt;Steuern: Verwendung von Messwerten um andere Geräte (Heizung, Kühlung,
Verschattung) zu steuern.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Für welchen Zweck sich ein bestimmtes Thermometer eignet, hängt im wesentlichen
von zwei Eigenschaften ab:&lt;/p&gt;
&lt;h2 id=&#34;präzision-und-auflösung&#34;&gt;
    &lt;a href=&#34;#pr%c3%a4zision-und-aufl%c3%b6sung&#34;&gt;
	Präzision und Auflösung
    &lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;Wir sprechen hier über Digitalthermometer, die in der Regel eine hohe Präzision
haben &amp;ndash; sie geben für eine bestimmte Temperatur am Messpunkt in der Regel den
gleichen Wert wieder. In der Regel sind sie aber nicht &lt;em&gt;genau&lt;/em&gt;: Sie werden im
Vergleich zu anderen Thermometern einen anderen Wert wiedergeben, meistens aber
mit feststehenden Differenzen / Offsets. Ein anderer Punkt in dem sich
Thermometer unterscheiden ist die Auflösung, also in welchen Teilschritten sie
Temperaturwerte messen und anzeigen.&lt;/p&gt;
&lt;p&gt;Einige Beispiele:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Die IKEA Vindstyrka Raum-Messgeräte liefern Informationen zu Temperatur,
Luftfeuchtigkeit, und Feinstaubbelastung. Und obwohl in den Geräten
hochsensitive Sensoren von Sensirion verbaut sind, zeigt das Gerät nur
ganzzahlige Temperaturwerte an (und liefert ohne Veränderungen am Gerät
auch nur ganzzahlige Werte). Diese Ausführung eignet sich meiner Meinung
nach für Beobachtung: Ich schaue aufs Display und habe eine grobe Idee, wie
sich die Umweltwerte in der aufgestellten Umgebung zueinander verhalten.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.koehntopp.info/uploads/2025/04/vindstyrka.jpeg&#34;&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2025/04/vindstyrka.jpeg&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/a&gt;

&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Ein IKEA Vindstyrka in einem Bücherregal&lt;/em&gt;&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Ein Shelly HT G3 liefert mir auf dem ePaper Display und Online
Temperaturwerte mit einer Auflösung von 0.1 Grad Celsius, die angezeigten
und über die Shelly API gelieferten Werte stimmen im wesentlichen überein.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.koehntopp.info/uploads/2025/04/shelly-htg3.jpeg&#34;&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2025/04/shelly-htg3.jpeg&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/a&gt;

&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Shelly HT G3 mit externer Stromversorgung&lt;/em&gt;&lt;/p&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;Ein mit freier Alternativfirmware bestücktes Xiaomi MMC MHO-C401(N) zeigt
auf dem ePaper-Display eine Auflösung von 0.1 Grad Celsius an, aber über
die BTHome API liefert es Werte mit einer Auflösung von 0.01 Grad Celsius.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.koehntopp.info/uploads/2025/04/MHO-C401.jpeg&#34;&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2025/04/MHO-C401.jpeg&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/a&gt;

&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Ein MHO-C401(N) mit der &lt;a href=&#34;https://pvvx.github.io/MHO_C401/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;alternativen Firmware für BTHome
Support&lt;/a&gt;

. Es sei angemerkt, dass es für C401
und C401N unterschiedliche Firmware gibt. Wenn man die falsche verwendet hat,
aktualisiert sich das Display nicht; man kann dann aber einfach die andere
flashen.&lt;/em&gt;&lt;/p&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;Ein Aqara Zigbee Thermostat liefert Werte mit einer Auflösung von 0.1 Grad
Celsius.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.koehntopp.info/uploads/2025/04/aqara_ths.jpeg&#34;&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2025/04/aqara_ths.jpeg&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/a&gt;

&lt;/p&gt;
&lt;ol start=&#34;5&#34;&gt;
&lt;li&gt;Ein Sonoff SNZB-02P liefert Werte mit einer Auflösung von 0.1 Grad Celsius.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.koehntopp.info/uploads/2025/04/sonoff-ths.jpeg&#34;&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2025/04/sonoff-ths.jpeg&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/a&gt;

&lt;/p&gt;
&lt;ol start=&#34;6&#34;&gt;
&lt;li&gt;Tasmota unterstützt verschiedene Thermostate von DHT22 bis BME820, die
jeweils entsprechend der technischen Kapazitäten Werte liefern.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Ein weiterer Grund warum &lt;em&gt;Präzision&lt;/em&gt; und nicht &lt;em&gt;Genauigkeit&lt;/em&gt; relevant sind:
Wenn es um Hausautomatisierung geht, ist die Frage welche Temperatur angenehm
ist und welche nicht, bereits subjektiv. Insofern sind &amp;ldquo;meine&amp;rdquo; 19.5 Grad
Raumtemperatur vielleicht angenehmer für mich als Kris&amp;rsquo; 21 Grad Raumtemperatur.
(Es sei auch angemerkt, dass die klassischen Raumsteuerungen für
Fussbodenheizungen mit Bimetall-Technik auch nur eine Genauigkeit von +-0,5
Grad haben).&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.koehntopp.info/uploads/2025/04/Raumregler.jpeg&#34;&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2025/04/Raumregler.jpeg&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/a&gt;

&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Ein temperaturgeführter Raumregler für Stellventile einer Flächenheizung. Im
Inneren bewährte, unkaputtbare Bimetalltechnik. Leider nutzlos, weil die
Heizung &amp;rsquo;normally open&amp;rsquo; betrieben wird.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Eine hohe Auflösung der Messwerte hat nicht nur Vorteile: Es bedeutet auch,
dass kleinste Veränderungen in der Umwelt (zum Beispiel: Ein Mensch der 100W
Abwärme erzeugt sitzt in der Nähe eines Raumthermometers) zu unmittelbaren
Veränderungen in den Messwerten führen. Wenn dies in der Nähe eines
Schwellwertes geschieht, der zur Steuerung verwendet wird (zum Beispiel:
Heizung an/aus); dann kann es zu Taktung kommen: Das geschaltete Gerät wird
in (zu) schneller Folge ab und wieder angeschaltet. In diesem Fall empfiehlt es
sich, den Messwert zu glätten, bevor man ihn zur Schaltung verwendet. Das
verzögert den Steuerungsvorgang in der Regel, aber die Taktung wird
vermieden.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.koehntopp.info/uploads/2025/04/Heizleistung12Gaeste.png&#34;&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2025/04/Heizleistung12Gaeste.png&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/a&gt;

&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Die Heizleistung von 12 Personen auf einer Party.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Es gibt noch zwei weitere Aspekten von Thermometern, die wichtig sind, um das
richtige Thermometer für den richtigen Anwendungszweck auszuwählen:&lt;/p&gt;
&lt;h2 id=&#34;stromverbrauch-und-aktualisierungs-frequenz&#34;&gt;
    &lt;a href=&#34;#stromverbrauch-und-aktualisierungs-frequenz&#34;&gt;
	Stromverbrauch und Aktualisierungs-Frequenz
    &lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;Beim Stromverbrauch gehört eigentlich noch die Art der Stromversorgung hinzu.
Die gängigen Spielarten sind: Stromversorgug über USB (Vindstyrka, Shelly HT,
Tasmota), CR2032 (Aqara Zigbee, Xiaomai MHO-C401(N), und Sonderformate wie
CR2450 (Sonoff SNZB-02P). Batteriebetriebene Thermometer haben maximale
Freiheitsgrade bei der Aufstellung, aber je nach Implementierung halten die
Batterien nur wenige Monate. Gerade die Zigbee Thermometer optimieren ihren
Stromverbrauch, indem sie Updates nur schicken, wenn sich die Temperatur um ein
bestimmtes Delta verändert haben, und dann noch alle X Minuten, auch wenn sich
nichts geändert hat. Bei einigen Zigbee Sensoren sind die Schwellwerte über
gewisse API Calls anpassbar &amp;ndash; bei mir hat das aber nie funktioniert.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.koehntopp.info/uploads/2025/04/batterien.png&#34;&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2025/04/batterien.png&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/a&gt;

&lt;/p&gt;
&lt;p&gt;Wer Batterien vermeiden möchte, hat die Wahl zwischen&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;IKEA Vindstyrka, aber aufgrund des aktiven Lüfters im Gerät, eignet sich
dieses Gerät nicht für die Aufstellung in Räumen mit hohen Anforderungen an
die Ruhe. Und wegen der niedrigen Auflösung der Werte (ohne massive
Modifikationen), eignet sich dieses Gerät auch nicht für Messen oder
Steuern.&lt;/li&gt;
&lt;li&gt;Shelly HT G3: Hoher Home Aesthetics Adequacy Factor, und mit Stromversorgung
aus der Steckdose auch hohe Aktualisierungs-Frequenz. Aber die Konfiguration
des Shelly HT G3 setzt das Drücken eines Knopf hinter der hinteren Abdeckung
voraus, für die man die externe Stromversorgung abziehen muss. Meiner
Meinung nach ein eklatanter Fehler im Design.&lt;/li&gt;
&lt;li&gt;Tasmota-Selbstbau: Ob das eine bessere oder schlechtere Lösung ist als ein
Vindstyrka zu modifizieren, sei der geneigten Leserschaft als Übung
überlassen. Die selbst konfigurierbare Aktualisierungs-Frequenz und
weitestgehend freie Wahl des Sensors entbehrt aber nicht einer gewissen
Attraktivität, genauso wie die Einbindung über MQTT anstatt Zigbee oder
BTHome &amp;hellip;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Wenn es Batterien sein dürfen:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;sowohl die Aqara THS als auch die MHO-C401(N) verwenden einfache CR2032
Batterien und laufen damit deutlich länger als ein Jahr. Ja, es gibt
aufladbare CR2032 Zellen, aber deren Leistung ist stark eingeschränkt; ob
man hier wirklich gewinnt sei dahin gestellt. Es gibt auch Adapterzellen, um
entweder 2xAAA oder gleich USB anzuschliessen, damit habe ich aber keine
Erfahrung.&lt;/li&gt;
&lt;li&gt;Die Sonoff SNZB-02P verwenden CR2045 Batterien. Diese sind gross, und selten
also teurer, und weil diese Thermometer LCD-Displays verwenden, sind die
Batterien auch eher nach 6-8 Monaten leer als nach 12-15.&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;aktualisierungsfrequenz&#34;&gt;
    &lt;a href=&#34;#aktualisierungsfrequenz&#34;&gt;
	Aktualisierungsfrequenz
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;Wie bereits erwähnt, unterscheiden sich diese Geräte in ihrer
Aktualisierungsfrequenz. Die MHO-C401(N)s aktualisieren sich ca einmal pro
Minute, Shelly HT G3 im Netzbetrieb ebenso (im Batteriebetrieb ca alle drei
Minuten). Aqara THS aktualisieren sich ca einmal alle 3-5 Minuten (oder wenn
die Temperatur sich um 0.1 Grad ändert), die SNZB-02P ca einmal alle 15 Minuten
oder wenn die Temperatur sich um 0.2 Grad ändert.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.koehntopp.info/uploads/2025/04/CheckinsThermometer.png&#34;&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2025/04/CheckinsThermometer.png&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/a&gt;

&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Vergleich der Aktualisierung der Werte in HomeAssistant von verschiedenen
Thermometern, die direkt nebeneinander stehen. &amp;lsquo;rettemp&amp;rsquo; ist ein DS18B20 an
meinem EMS-ESP zur Referenz; Aqara, Shelly, und Sonoff sind die im weiteren
Text erwähnten Geräte. Man sieht, dass der Shelly etwa alle drei Minuten ein
Update schickt, und Sonoff und Aqara in den gezeigten 2 Stunden nur eine
handvoll Updates liefert, während der DS18B20 unmittelbare Werte liefert,
sobald sich die Temperatur ändert.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Meiner Erfahrung nach eignen sich Geräte mit einer niedrigen
Aktualisierungsfrequenz im wesentlichen nur für die Beobachtung: Also wenn ich
grob wissen will, was Sache ist und mir Tages- oder Wochen-Trends ausreichen.
Für Werte die ich innerhalb einer Stunde oder schneller mit anderen Dingen
korrelieren möchte, brauche ich eine zügigere Aktualisierung. Und schliesslich,
wenn ich Wärme- oder Kälte-Erzeugung aktiv steuern will, ist es unerlässlich,
einen schnellen Sensor zu haben &amp;ndash; selbst wenn ich die Messwerte zur Vermeidung
von Taktung durch einen Tiefpassfilter schicke oder eine Zweipunktschaltung
implementiere.&lt;/p&gt;
&lt;p&gt;Wir haben als über Genauigkeit, Präzision, Auflösung, Stromverbrauch, und
Aktualisierungs-Frequenzen gesprochen. Für die praktische Anwendung im Home
Assistant Umfeld ist noch ein weiterer Aspekt wichtig:&lt;/p&gt;
&lt;h2 id=&#34;protokoll-konformität&#34;&gt;
    &lt;a href=&#34;#protokoll-konformit%c3%a4t&#34;&gt;
	Protokoll-Konformität
    &lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;Ich habe Erfahrung mit Zigbee, BTHome, Shelly, und Tasmota/MQTT &amp;ndash; andere
Protokolle und Implementierungen wie ESPHome, Matter, etc. sind hier nicht
berücksichtigt, weil ich zu ihnen nichts sagen kann. Es soll aber nicht
ausschliessen, dass sie für verschiedenste Anwendungsfälle geeignet sind.&lt;/p&gt;
&lt;dl&gt;
&lt;dt&gt;Zigbee&lt;/dt&gt;
&lt;dd&gt;Meiner Erfahrung nach ist ein Gutteil der als Zigbee-kompatibel
ausgewiesenen Thermometer leider dergestalt, dass die Hersteller ihre
eigenen Protokollvarianten fahren, die es erschweren bis verunmöglichen,
diese Thermostate in einer offenen Umgebung wie Home Assistant zuverlässig
einzubinden oder dauerhaft zu betreiben.
&lt;p&gt;Home Assistant bringt für hunderte
von Zigbee Geräten &amp;ldquo;Quirks&amp;rdquo; Definitionen mit, also gerätespezifische
Anpassungen, damit das Gerät auch funktioniert. Leider sind die
Gerätehersteller nicht in der Lage, ein Gerät mit einer Ausführung von
Hardware und Firmware sauber zu benennen. Deswegen ist die Frage ob ein
bestimmtes Zigbee-Thermometer mit Home Assistant funktioniert, immer mit
&amp;ldquo;möglicherweise&amp;rdquo; zu beantworten. Das ganze ist insofern besonders
verstörend, weil die meisten Thermometer, egal wie sie gebranded sind,
entweder von Xiaomi oder Aqara hergestellt werden. Das ganze Theater ist
also konsumentenfeindliche Marktzersplitterung.&lt;/p&gt;
&lt;p&gt;Bei HomeAssistant kommt noch
dazu, dass es unterschiedliche Implementierungen von Zigbee gibt: ZHA und
Z2M. ZHA kommt von NabuCasa, der Firma hinter HomeAssistant, Z2M bindet den
ganzen Zigbee-Kram über MQTT an HomeAssistant an. Die oben erwähnten Quirks
unterscheiden sich, und so unterscheidet sich auch, ob ein Gerät mit
HomeAssistant gut funktioniert, hin und wieder aufgrund einer Entscheidung
für ZHA oder Z2M. Man kann theoretisch beides parallel fahren, wenn man zwei
Zigbee Coordinators hat, aber ob das eine Lösung ist? Für mich zumindest
nicht.&lt;/p&gt;
&lt;p&gt;Deswegen hier gleich die erste &lt;strong&gt;Nicht-Empfehlung&lt;/strong&gt;: Finger weg von
allem, was Tuya in der Beschreibung hat! Viele der Tuya-Geräte sprechen
nominell Zigbee, haben aber zum Beispiel proprietäre Kopplungsprozesse oder
andere Eigenheiten, die eine Verwendung im HomeAssistant stark
verkomplizieren bis verunmögligen. Das gilt übrigens nicht nur für
Thermometer (OSRAM LEDVANCE, I&amp;rsquo;m looking at you!). Die LocalTuya
Integration, die einen Developer Account bei Tuya voraussetzt und auch
ansonsten wirre Dinge tut, ist für mich Teil des Problems und nicht der
Lösung.&lt;/p&gt;
&lt;/dd&gt;
&lt;dt&gt;BTHome&lt;/dt&gt;
&lt;dd&gt;BTHome ist ein Protokoll aus dem Hause Shellly und Bestandteil der
&lt;a href=&#34;https://www.openhomefoundation.org/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Open Home Foundation&lt;/a&gt;

. Ich muss gestehen, dass ich wenig Lust hatte, meinem
Home Assistant einen weiteren Dongle für Bluetooth und eine weitere
Integration anzutun, aber am Ende war es die richtige Entscheidung. Was ich
ganz elegant finde: Die Geräte werden über den Webbrowser geflasht, man muss
also weder das Gerät öffnen noch irgendwelche wilden Buildchains
installieren.&lt;/dd&gt;
&lt;dt&gt;Shelly&lt;/dt&gt;
&lt;dd&gt;Shelly hat sein eigenes proprietäres Protokoll, aber die Integration
mit HomeAssistant ist lokal und funktioniert im wesentlichen sehr gut. Als
europäisches Produkt zahlt man für Shelly-Lösungen etwas mehr, aber
insgesamt finde ich die Qualität stimmt. (Wer keine Lust auf einen eigenen
lokalen Home Assistant hat, ist mit der Shelly Cloud Lösung vermutlich auch
ganz gut bedient, ich verwende das nicht).&lt;/dd&gt;
&lt;dt&gt;Tasmota&lt;/dt&gt;
&lt;dd&gt;Tasmota verwendet MQTT und ist lokal, Wifi basiert, und für mich
zum Beispiel im Bereich Smart Plugs bereits das Protokoll meiner Wahl. Wer
Freude am Basteln hat, bekommt hier a) den Sensor in der Ausführung der Wahl
und b) eine Integration die keine weiteren Dongles benötigt.&lt;/dd&gt;
&lt;/dl&gt;
&lt;h1 id=&#34;abschliessende-empfehlung&#34;&gt;
    &lt;a href=&#34;#abschliessende-empfehlung&#34;&gt;
	Abschliessende Empfehlung
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;Die bisher besten Erfahrungen mit über einem halben Dutzend Thermometer-Modelle
lässt für mich nur zwei Empfehlungen zu: Aqara Temp and Humidity Sensor für
Anwendung ohne Display und mit nur einfachen Steuerungen, für alle anderen
Anwendungen Xiaomi MMC MHO-C401(N) mit der BTHome Firmware. Der Shelly HT G3
ist aufgrund seiner Größe und der oben genannten Design-Fehler nur abgeschlagen
auf dem Dritten Platz. Tasmota nur für Leute die sinnvoll selbst Geräte bauen
können, dann aber meiner Erfahrung nach am Flexibelsten.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Panasonic Comfort Cloud</title>
      <link>https://blog.koehntopp.info/2025/04/03/panasonic-comfort-cloud.html</link>
      <pubDate>Thu, 03 Apr 2025 03:04:05 +0000</pubDate><author>kris-blog@koehntopp.de (Kristian Köhntopp)</author>

      <guid>https://blog.koehntopp.info/2025/04/03/panasonic-comfort-cloud.html</guid>
      <description>&lt;p&gt;As discussed &lt;a href=&#34;https://blog.koehntopp.info/2025/03/10/going-fully-electric.html&#34;&gt;previously&lt;/a&gt;

,
we have replaced our home heating with Air-Air-Heatpumps,
that is, air-conditioning units that have a reverse-mode.&lt;/p&gt;
&lt;p&gt;In our case, the indoor units are Panasonic Etherea Z (CS-Z25ZKEW and CS-Z20ZKEW),
which are connected to a multi-split outdoor unit,
a 3x on the north side, and a 5x (one blind) on the south side, for a total of seven units.&lt;/p&gt;
&lt;h1 id=&#34;adding-cs-zxxzkew-units-to-panasonic-comfort-cloud&#34;&gt;
    &lt;a href=&#34;#adding-cs-zxxzkew-units-to-panasonic-comfort-cloud&#34;&gt;
	Adding CS-ZxxZKEW units to Panasonic Comfort Cloud
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;These units have integrated Wifi, and can be connected to the Panasonic comfort cloud.
This was problematic, because the manual and the labeling was unclear, and led into the wrong direction.&lt;/p&gt;
&lt;p&gt;For each indoor unit there is a remote that came with a sticker.
The sticker has a QR-code, which leads to an install link for the Panasonic Comfort Cloud application.&lt;/p&gt;
&lt;p&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2025/04/comfort-01.jpg&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/p&gt;
&lt;p&gt;&lt;em&gt;QR-code for the Panasonic Comfort Cloud installation.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;You need to make an account,
and then end up in a very empty screen with a single &amp;ldquo;+&amp;rdquo; sign that allows you to start the &amp;ldquo;add device&amp;rdquo; workflow.&lt;/p&gt;
&lt;p&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2025/04/comfort-02.jpg&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Comfort Cloud start screen after making an account.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;The next steps seem are straight forward: Add an air-conditioner:&lt;/p&gt;
&lt;p&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2025/04/comfort-03.jpg&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/p&gt;
&lt;p&gt;Select the kind with a wireless remote controller:&lt;/p&gt;
&lt;p&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2025/04/comfort-04.jpg&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/p&gt;
&lt;p&gt;And then, choose what kind of device you have:&lt;/p&gt;
&lt;p&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2025/04/comfort-06.jpg&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/p&gt;
&lt;p&gt;Look at the device and decide what kind of device this is:&lt;/p&gt;
&lt;p&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2025/04/comfort-05.jpg&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/p&gt;
&lt;p&gt;Now, if you think you have a device with &lt;strong&gt;ONE&lt;/strong&gt; front panel sticker, you&amp;rsquo;d be wrong, and things will not work.&lt;/p&gt;
&lt;p&gt;If you choose that, the device will instruct you to turn on the WiFi on the wall unit (that is correct):&lt;/p&gt;
&lt;p&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2025/04/comfort-07.jpg&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/p&gt;
&lt;p&gt;The cellphone will then try to join the WiFi &lt;code&gt;Panasonic-CS-wirelessAP&lt;/code&gt;:&lt;/p&gt;
&lt;p&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2025/04/comfort-08.jpg&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/p&gt;
&lt;p&gt;and that will not work, because the wall unit starts up the WiFi &lt;code&gt;Panasonic-CS-V2-eM00&lt;/code&gt;.
Wall unit and telephone are using different WiFi ESSIDs, and will not see each other, configuration will fail.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;This is a unit without a front panel sticker!&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;So the following flow works:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Start the App.&lt;/li&gt;
&lt;li&gt;Inside the App, lie to the app and say &amp;ldquo;No QR Code&amp;rdquo;&lt;/li&gt;
&lt;li&gt;The App then says &amp;ldquo;Open the flap&amp;rdquo;, and you can say &amp;ldquo;Right, there is a QR code inside, thanks.&amp;rdquo;&lt;/li&gt;
&lt;li&gt;The App (not iOS) then wants to scan the very same QR Code.&lt;/li&gt;
&lt;li&gt;This then takes ages, but adds the unit using a secret config Bluetooth.&lt;/li&gt;
&lt;li&gt;This is not the workflow described in the manual delivered with the unit.&lt;/li&gt;
&lt;li&gt;But it works.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2025/04/comfort-10.jpg&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/p&gt;
&lt;p&gt;Add the units one after the other.&lt;/p&gt;
&lt;h1 id=&#34;home-assistant-integration-with-panasonic-comfort-cloud&#34;&gt;
    &lt;a href=&#34;#home-assistant-integration-with-panasonic-comfort-cloud&#34;&gt;
	Home Assistant Integration with Panasonic Comfort Cloud
    &lt;/a&gt;
&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;Install HACS.&lt;/li&gt;
&lt;li&gt;Install Panasonic Comfort Cloud from HACS. &lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2025/04/comfort-12.jpg&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/li&gt;
&lt;li&gt;Settings -&amp;gt; Devices and Services -&amp;gt; Add Integration -&amp;gt; Panasonic Comfort Cloud &lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2025/04/comfort-13.jpg&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/li&gt;
&lt;li&gt;Configure Panasonic Comfort Cloud Integration, device discovery runs&lt;/li&gt;
&lt;li&gt;For each device,
we get 13 valid entities and several others
that are implemented but not valid for our device type. &lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2025/04/comfort-14.jpg&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/li&gt;
&lt;li&gt;The entity &lt;code&gt;climate.&amp;lt;device name&amp;gt;&lt;/code&gt; yields a useful control panel. &lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2025/04/comfort-15.jpg&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/li&gt;
&lt;li&gt;Dashboard the shit out of everything for profit.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;I can now turn the air conditioners on and off using HASS.
I will be able to create air conditioner automations that keep the house in a sane temperature range automatically.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Going fully electric</title>
      <link>https://blog.koehntopp.info/2025/03/10/going-fully-electric.html</link>
      <pubDate>Mon, 10 Mar 2025 03:04:05 +0000</pubDate><author>kris-blog@koehntopp.de (Kristian Köhntopp)</author>

      <guid>https://blog.koehntopp.info/2025/03/10/going-fully-electric.html</guid>
      <description>&lt;p&gt;End of April 2022, we got &lt;a href=&#34;https://blog.koehntopp.info/2022/05/02/a-solar-roof.html&#34;&gt;our solar roof&lt;/a&gt;

.&lt;/p&gt;
&lt;p&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2022/05/solar-03.png&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Using gas, we are heating this house using 1100-1300 m^3 gas per year.
That&amp;rsquo;s 11-13 MWh primary energy. At 156 qm, that is between 72 kWh/(qm * year) and
76 kWh/(qm * year).&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;In the Netherlands, this is good for an energielabel &amp;ldquo;A&amp;rdquo;,
in Germany 75 kWh/(qm * year) is the border between &amp;ldquo;B&amp;rdquo; and &amp;ldquo;C&amp;rdquo;.&lt;/p&gt;
&lt;h1 id=&#34;getting-rid-of-natural-gas-heating-and-cooling-the-top-floor&#34;&gt;
    &lt;a href=&#34;#getting-rid-of-natural-gas-heating-and-cooling-the-top-floor&#34;&gt;
	Getting rid of natural gas heating and cooling the top floor
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;Our objective for 2025 was to get rid of the gas heating,
and install electrical heating based on heat pumps.
Additionally, I needed cooling, because upstairs it can get rather warm in the summer.&lt;/p&gt;
&lt;p&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2025/03/electric-1.jpg&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/p&gt;
&lt;p&gt;&lt;em&gt;In summer, the temperature upstairs won&amp;rsquo;t fall below 24ºC, even at night.
During these times, I can&amp;rsquo;t sleep upstairs anymore.
I would migrate to the first floor overnight, and suffer during the day.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;After shopping around a bit, we decided to go for a set of Panasonic Multisplit Airconditioners (Air-Air Heatpumps):
Two multi-split outdoor units, and a total of seven indoor units.&lt;/p&gt;
&lt;p&gt;A 5x outdoor unit would be positioned at the south wall, driving 4 indoor units,
and the 3x outdoor unit would be sitting at the north wall, driving 3 indoor units.&lt;/p&gt;
&lt;p&gt;Warm water would be supplied by a heat pump boiler.&lt;/p&gt;
&lt;p&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2025/03/electric-2.jpg&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/p&gt;
&lt;p&gt;&lt;em&gt;A Panasonic indoor unit, wall mounted under the roof of the room.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;The indoor units get wall mounted on either the north or south wall of the house.
They require two insulated copper pipes for the refrigerant, a power cable and a plastic hose for condensate water
to the passed to the outside, through the wall.&lt;/p&gt;
&lt;p&gt;For that, an 80 mm hole is being drilled into the wall to pass the connectors to the outside.
On the south side, we have been able to remove the wood paneling of the house,
and run these things over the outside insulation under the wood panels.
On the north side, the connections run to the wide of the house,
and are passed downstairs under the wood panels of the large windows.
They are then led to the outdoor unit on the ground.
Condensate is spilled directly to the ground (into the plants),
and power and refrigerant connections are led to the outdoor units.&lt;/p&gt;
&lt;p&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2025/03/electric-3.jpg&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/p&gt;
&lt;p&gt;&lt;em&gt;This is what the wall mount and the hole look like, under the indoor units.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Running the plumbing and the wires under the wood hides all the ugly pipes quite well,
but required quite some effort with the house.&lt;/p&gt;
&lt;p&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2025/03/electric-4.jpg&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/p&gt;
&lt;p&gt;&lt;em&gt;The 5x outdoor unit, already in place. No plumbing is connected, so far,
but the wood panels are already removed, ready to take the pipes.&lt;/em&gt;&lt;/p&gt;
&lt;h1 id=&#34;fixing-the-fuse-box&#34;&gt;
    &lt;a href=&#34;#fixing-the-fuse-box&#34;&gt;
	Fixing the Fuse Box
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;The air conditioners require single phase connections, and dedicated fuses, each.
Making this change would have overloaded our fuse box,
which was in a desolate state after 20 years of incremental changes anyway.
So an additional task of the installation process was a complete renewal of the fuse box,
including newly added differential breakers, more space and a general cleanup.
I also got some wall sockets in the fuse box, for the fiber connection and the fiber modem,
plus some spares.&lt;/p&gt;
&lt;p&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2025/03/electric-5.jpg&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/p&gt;
&lt;p&gt;&lt;em&gt;The fuse box and electrical meter, after the cleanup.
There are still two additional Shelley meters that need to go in.&lt;/em&gt;&lt;/p&gt;
&lt;h1 id=&#34;warm-water&#34;&gt;
    &lt;a href=&#34;#warm-water&#34;&gt;
	Warm Water
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;The largest and most ugly part of the installation is the warm water boiler.
In the photo you see it before installation: a 200l tank with a heat pump on top.
For installation, it needs to be fixated, connected and requires two 160mm pipes to the roof
for air-in and air-out. These are not yet visible in the image.&lt;/p&gt;
&lt;p&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2025/03/electric-6.jpg&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/p&gt;
&lt;p&gt;Normally, you would install it in the place where the old gas boiler was.
Since we are keeping the gas boiler around for at least another 1-2 years as a backup,
that was not (yet) possible.&lt;/p&gt;
&lt;p&gt;This device is also the loudest of all parts.
When running, it creates a 43 dBa noise level,
39 dBa in 1.5m distance.&lt;/p&gt;
&lt;p&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2025/03/electric-7.jpg&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/p&gt;
&lt;p&gt;We typically run it at 11:00 in the morning.
At that time, we have sufficient solar energy to drive the heat pump (500 W intake),
and the outside air is already warm, making it easier for the heat pump to do its work.&lt;/p&gt;
&lt;p&gt;Warming up 200 kg of water from 15ºC to 50ºC takes around 8.13 kWh of energy,
and the heat pump is rated with a COP of slightly under 3 for 7ºC air-in temperature.
That means an initial &amp;ldquo;heat-pump only&amp;rdquo; run will take about 3 kWh of energy at 500 W power,
so warming up the entire thing will have an initial run-time of 6 hours.&lt;/p&gt;
&lt;p&gt;Or you press the &amp;ldquo;Boost&amp;rdquo; button, which will enable an additional electrical heater inside,
adding another 1500 W of energy intake to speed things up.&lt;/p&gt;
&lt;p&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2025/03/electric-8.jpg&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/p&gt;
&lt;p&gt;&lt;em&gt;A teenage boy has showered late in the evening. The heat pump brings the water reservoir up to spec again.
This used 1.1 kWh (around 30 cent).
You can see how the heat pump uses more power to warm up the water the warmer the water in storage gets.
The difference from 40ºC to 50ºC is almost 100 Watt.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;During a normal day, we have to replace the used water and warm it up,
that will take around 2 hours of time and circa 1.5 kWh of energy on a normal day.&lt;/p&gt;
&lt;h1 id=&#34;redesigning-space-on-the-top-floor&#34;&gt;
    &lt;a href=&#34;#redesigning-space-on-the-top-floor&#34;&gt;
	Redesigning Space on the Top Floor
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;Also, an additional task in the installation process was to wall off the top floor from the staircase and the rest of the house.
We also wanted to make the airspace smaller above the staircase, and install some unheated storage space.&lt;/p&gt;
&lt;p&gt;This will keep the cool air generated upstairs (where it is warmest in summer) upstairs,
and give us some much needed storage space for some things.&lt;/p&gt;
&lt;p&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2025/03/electric-9.jpg&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/p&gt;
&lt;p&gt;&lt;em&gt;In the staircase to the top floor, looking up. A wooden lattice is being constructed, strong enough to carry some weight.
Insulation will go into the lattice, Rigips is installed on the lower side, and will be painted over.
A wooden floor goes on top.
An retractable staircase will go into the larger rectangle.
The staircase will get walls from floor to top, with an aluminium frame and acrylic glass, and a door.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2025/03/electric-10.jpg&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Roof, retractable staircase, and a half-installed air-conditioner, top floor.&lt;/em&gt;&lt;/p&gt;
&lt;h1 id=&#34;did-it-all-work&#34;&gt;
    &lt;a href=&#34;#did-it-all-work&#34;&gt;
	Did it all work?
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2025/03/electric-11.jpg&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/p&gt;
&lt;p&gt;Ten days into March, we are at 0 m^3 gas usage.
So we are natural-gas free.&lt;/p&gt;
&lt;p&gt;We are using as much electrical energy as we produce, which is normal for early March.
Currently, we are coming out at net 13 kWh consumed for the first ten days.&lt;/p&gt;
&lt;p&gt;Electricity usage is definitively up. A lot.&lt;/p&gt;
&lt;p&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2025/03/electric-12.jpg&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/p&gt;
&lt;p&gt;&lt;em&gt;The first ten days of March, compared to the last 10 days of September, and air temperatures of early march.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;We can see that the house baselined at around or below 10 kWh/day in September,
with the spikes being days where the car was being charged.&lt;/p&gt;
&lt;p&gt;In March, the car was charged on March, 1st, for 15.34 kWh,
leading to a usage spike of 42.6 kWh and a grid draw of 32.9 kWh, for a total net draw of 23.63 kWh.
Doing the math leaves us with approximately 17 kWh electrical energy for heating,
at an assumed COP of 3 this yields 50-ish kWh of heat energy, or a gas equivalent of 5 m^3.
That is not too shabby for a day with freezing at night and around 8ºC during the day.&lt;/p&gt;
&lt;p&gt;Energy used is roughly proportional to the outdoor temperature.
Especially the last three days have been warm and sunny,
so all indoor units but the one in the living room on the first floor have been off.&lt;/p&gt;
&lt;p&gt;For the night of the 9th of March, things looked like this (compared to September):&lt;/p&gt;
&lt;p&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2025/03/electric-13.jpg&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Baseline usage in September was around 300 Watt. We are now at around 700-750 Watt with a single unit running.
This keeps the temperature stable in the living room, and kitchen.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;The first floor is roughtly &amp;ldquo;J&amp;rdquo;-shaped:
The long side of the J is the living room, with a indoor unit at the top of the J, the south wall.
The bow of the J is the eating place, and the short side of the J is the kitchen.
The north wall, and the bow of the J, has a second indoor unit.&lt;/p&gt;
&lt;p&gt;For this night, I kept the living room indoor unit running at 23ºC.
The north wall unit in the kitchen was kept off.
The kitchen door was left half-open to give the entree and guest bathroom a bit of warmth.&lt;/p&gt;
&lt;p&gt;Apparently 23ºC measured at the indoor unit (almost under the roof of the room) are 21ºC measured at the Honeywell
wall thermostat used by the old has heating, and 20.0ºC at knee height in the living room.
We get 20.7ºC at 1.80m height in the kitchen.
The single active wall unit was set to &amp;ldquo;quiet&amp;rdquo; mode, which is exactly that:
there is air movement, it is almost hearable but can be felt,
and sometimes you can hear the mechanics in the indoor unit reposition the air-guides, quietly and carefully.&lt;/p&gt;
&lt;p&gt;Learnings:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;At 8ºC dropping to 3ºC outdoor temperature at night, a single indoor unit in quiet mode can keep the ground floor stable.&lt;/li&gt;
&lt;li&gt;You need to set temperatures agressively, 23ºC at 2.20m room height are 21ºC at 1.60m and 20ºC at 70cm height,
there is clear thermal layering.&lt;/li&gt;
&lt;li&gt;21ºC in the living room are 20.7ºC in the kitchen, which is way better than expected.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The original estimate was using 4 MWh/year electrical power for heating (around 1200 Euro/year), instead of 12 MWh gas
(around 1500 Euro/year at current pricing).
I do not expect to overshoot this,
but it may be that we actually end up with considerably less energy usage in the coming year.&lt;/p&gt;
&lt;p&gt;All in all the solution works, and performs at least as well as projected.&lt;/p&gt;
&lt;p&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2025/03/electric-14.jpg&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;


&lt;em&gt;NE-roof: Solar Array, the outside air-ducts for the warm water boiler, and the gas boiler is active.
It&amp;rsquo;s the final day of natural gas usage for heating.&lt;/em&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Discords Börsengang</title>
      <link>https://blog.koehntopp.info/2025/03/06/discords-boersengang.html</link>
      <pubDate>Thu, 06 Mar 2025 04:05:06 +0000</pubDate><author>kris-blog@koehntopp.de (Kristian Köhntopp)</author>

      <guid>https://blog.koehntopp.info/2025/03/06/discords-boersengang.html</guid>
      <description>&lt;p&gt;Heise berichtet:
&lt;a href=&#34;https://www.heise.de/news/Bericht-Discord-strebt-offenbar-Boersengang-noch-2025-an-10306706.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Discord strebt offenbar Börsengang noch 2025 an&lt;/a&gt;

&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Die Verantwortlichen hinter der Chatplattform erwägen laut einem Medienbericht,
ihr Unternehmen an die Börse zu bringen und führen erste Gespräche.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Aus meinem Mastodon-Thread:&lt;/p&gt;
&lt;p&gt;Das ist schade, Discord war eine gute Chatplatform.
Mit dem Börsengang wird es natürlich zwingend, das Unternehmen auf Kosten der User-Experience auf Profit zu trimmen.
Erfahrungsgemäß wird eine Plattform damit binnen drei Jahren unbrauchbar.
Wir haben also Stand heute noch in etwa vier Jahre an Discord gut, bevor wir eine Alternative brauchen.&lt;/p&gt;
&lt;p&gt;Eine Menge Leute lästern über Discord, aber das ist meist entweder Mangel an Erfahrung oder sinnfreier OSS-Fundamentalismus.&lt;/p&gt;
&lt;p&gt;Discord ist von allen Lösungen für synchrone Kommunikation, die ich regelmäßig nutze, die einzig richtig Gute.&lt;/p&gt;
&lt;p&gt;Sie ist praktisch im Handumdrehen einzurichten, hat sinnvolle Defaults,
und kann Communities mit 3 Benutzern genau so abbilden wie solche mit 30k Users.&lt;/p&gt;
&lt;p&gt;Sie kann Umgebungen für Streaming und Audiochat genau so realisieren wie solche,
die lang laufende Text-Unterhaltungen realisieren –
und zwar lineare wie auch solche, die stark strukturiert in Threads oder FAQ/Support-Cases aufgebaut sind.&lt;/p&gt;
&lt;p&gt;Discord beherrscht Markdown-Text mit Syntax-Highlighting,
kann Bilder und Emojis einbetten,
und der Chat kann auch als Filesharing/Dateitransport-Dienst verwendet werden.&lt;/p&gt;
&lt;p&gt;Der Dienst ist auch nicht föderiert, und der Client einigermaßen kontrolliert.
Das heisst, man hat 95 % des Spam-Problems nicht, das zum Beispiel Google Hangouts vor 10 Jahren
durch Förderation mit XMPP Instanzen hatte, die speziell zum Versenden von Spam gebaut wurden.
Google konnte das Probem  am Ende nur durch die Abriegelung von Hangouts lösen.
Außerdem gibt so genau eine offizielle Timeline, und es gibt keinen Lag durch Nachrichten-Ausbreitung zwischen Servern.&lt;/p&gt;
&lt;p&gt;Und während es nicht-offizielle Discord Clients oder Patches für die originale Electron-App gibt,
sind die alle inoffiziell, können also den Dienstleister nicht daran hindern,
den Featureset zentral weiterzuentwickeln.
Bei Systemen ohne bindend offiziellen Client gibt es oft Gejammer von Menschen,
deren Client das neue Feature noch nicht kann, oder nie können wird,
und die deswegen unbedingt wollen, dass wir alle das Feature dann nicht haben.&lt;/p&gt;
&lt;p&gt;Und das alles hosted, für einen Spottpreis (nämlich erst mal frei, oder halt für 120 Euro/Jahr, wenn man Nitro kauft).&lt;/p&gt;
&lt;p&gt;Es wird schade sein, das alles an ungebremste Monetarisierung zu verlieren.&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;Ich halte die Abwesenheit von Föderation und E2E-Encryption für einen Vorteil.&lt;/p&gt;
&lt;p&gt;Beides sind Features, die den Server und den Client notlos kompliziert machen,
und die für eine schlechte und verwirrende UX sorgen.
Die meisten Leute wollen halt nicht den antifaschistischen Widerstand abhörsicher in ihrem Chat organisieren,
oder ein Frauenhaus und eine Abtreibungsberatung organisieren,
sondern einen öffentlichen Guild-Server für ihre Gilde haben oder über ihre 3D-Drucker chatten.
Und das tut um mindestens drei Größenordnungen weniger weh,
wenn man sich Föderation und E2EE schenkt,
um sich auf Client-Features zu konzentrieren – und weil der Dienst dann einfach und immer tut.&lt;/p&gt;
&lt;p&gt;Mit Föderation hat man, wie oben schon angedeutet,&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;unterschiedliche Server-Versionsstände und entsprechend nicht einheitlich funktionierende Features.&lt;/li&gt;
&lt;li&gt;Propagation-Delay, und damit einen Chat, der nicht mehr kontrollierbare Lags hat.
Es entsteht eine nicht-einheitliche Sicht auf die Timeline.
Da kann man gegenan arbeiten, indem man pro Channel deförderiert
(es gibt einen führenden Server pro Channel, und alle Clients müssen da hinschreiben,
und da gibt es die authoritative Timeline für den Channel).&lt;/li&gt;
&lt;li&gt;dedizierte Serverimplementierungen, deren einziger Zweck es ist, nicht existende Client-Profile im Server zu simulieren
und Marketing-Nachrichten in echte Server mit echten Usern einzuspielen (also Spam).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Und sobald man E2EE macht, hat man&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;pro Client verschlüsselte Nachrichten mit bekanntem Inhalt (also ein known Plaintext Problem).&lt;/li&gt;
&lt;li&gt;ein Key-Distribution-Problem außerordentlichen Ausmaßes, das man absolut nicht braucht.&lt;/li&gt;
&lt;li&gt;das man durch Föderation und Lag noch verschärfen kann.&lt;/li&gt;
&lt;li&gt;ein unlesbares Backlog für neu hereinkommende Clients.&lt;/li&gt;
&lt;li&gt;ein Problem bei Identitäten (&amp;ldquo;Isotopp&amp;rdquo;) mit mehreren Clients (Desktop, Mobile, Tablet),
das Du in der Key Distribution Infrastruktur abbilden musst,
einschließlich Gerätewechsel (&amp;ldquo;neues Handy&amp;rdquo;) und Backlog-Synchronisation.&lt;/li&gt;
&lt;li&gt;desynchroniserte Clients, die technisch Mitglied im Kanal sind, aber nicht teilnehmen können (&amp;ldquo;Keysplit&amp;rdquo;)&lt;/li&gt;
&lt;li&gt;keine zentrale, indizierte Suche und kein Archiv.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;und das alles notlos, weil für mehr als 99 % aller Anwendungsfälle E2EE ein Antifeature ist.
Der Dienst würde profitieren, wenn er das Feature nicht hätte,
da die Inhalte im virtuellen Server im Grunde öffentlich sind (jedenfalls nicht geheim),
und man nun arbeiten muß, um die oben angedeuteten Eigenschaften bereit zu stellen.&lt;/p&gt;
&lt;p&gt;Ein Dienst, den man sich anschauen sollte, ist das &lt;a href=&#34;https://itsfoss.com/revolt/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;hier reviewte Revolt&lt;/a&gt;

.
Dem fehlen noch eine Reihe von Features für Parity, aber es scheint ein sehr guter Ansatz zu sein.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Drei Winter mit eigener Heizung</title>
      <link>https://blog.koehntopp.info/2025/02/28/3-winter-mit-eigener-heizung.html</link>
      <pubDate>Fri, 28 Feb 2025 13:05:06 +0000</pubDate><author>oliof@example.com (Harald Wagener)</author>

      <guid>https://blog.koehntopp.info/2025/02/28/3-winter-mit-eigener-heizung.html</guid>
      <description>&lt;h1 id=&#34;2022&#34;&gt;
    &lt;a href=&#34;#2022&#34;&gt;
	2022
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;Im November 2022 ziehe ich mit meiner Frau in das Haus ein, dass unser
&amp;ldquo;Alterswohnsitz&amp;rdquo; werden soll. Das Gebäude ist aus dem frühen 15. Jahrhundert,
steht innen wie aussen unter Denkmalschutz, aber wurde von den Vorbesitzern
2017-2019 komplett saniert: Dach, Dämmung, Strom, Wasser und natürlich
Heizung.&lt;/p&gt;
&lt;p&gt;Wie das bei neu gebackenen Hausbesitzern so ist, kollidieren eigene Wünsche zu
Umbaumaßnahmen (&amp;ldquo;Photovoltaik!&amp;rdquo;, &amp;ldquo;Wärmepumpe!&amp;rdquo;) mit den Realitäten vor Ort. Und
man hat erstmal das Gefühl verloren, wieviel bewegliches Kapital noch vorhanden
ist, nachdem eine Immobilie angeschafft wurde. Das setzt dem Investitionswillen
eine mentale Bremse.&lt;/p&gt;
&lt;p&gt;Die Fakten sind:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Das Haus steht in Reihe und hat relative dicke Aussenwände (60-70cm) in den
ersten beiden Stockwerken.&lt;/li&gt;
&lt;li&gt;In der Rückwand ist Dämmung eingeblasen, das Dach ist teilgedämmt und
verfügt über einen Kaltboden. Die Fenster sind doppelt verglast.&lt;/li&gt;
&lt;li&gt;Diese beiden Punkte bedeuten, dass das Haus energetisch große Vorteile
gegenüber einem freistehenden Einfamilienhaus hat.&lt;/li&gt;
&lt;li&gt;Die einzigartige Gestaltung der oberen Front bringt dünnere Wände mit sich.
Beim Schlafzimmer in Kombination mit einer zum Dachfirst geöffneten Decke
geht ein Gutteil der Vorteile aus den ersten beiden Punkten direkt wieder flöten.&lt;/li&gt;
&lt;li&gt;Die im Keller verbaute Gasheizung verantwortet die Warmwasserbereitung über
einen 145l Wassertank und ist Wärmequelle für die Heizung. Die
Warmwasserleitung erstreckt sich aufgrund baulicher Eigenheiten über ca. 15m,
bis sie im Bad ankommt.&lt;/li&gt;
&lt;li&gt;Die Heizung wird über einen Aussentemperaturfühler gesteuert und verfügt über
eine Internet-Anbindung über eine proprietäre App, die einfache Einstellungen
ermöglicht und den Gasverbrauch für Warmwasser und Heizung ausweist.&lt;/li&gt;
&lt;li&gt;Es ist überall (ausser im Keller) Fussbodenheizung in Trockenbauweise verlegt.
Die Raumthermostate zur Steuerung der Stellventile sind einfache Bimetall-Thermometer
(laut Hersteller mit einer Auflösung von ca. 0,5 Grad).&lt;/li&gt;
&lt;li&gt;Das Haus steht dreifach unter Denkmalschutz: Einmal als Teil des
Altstadt-Ensembles der Stadt Wismar, einmal von aussen, und einmal von
innen. Das bedeutet: Das Denkmalschutzamt hat eine innige Beziehung zu dem Haus
und alle nicht rückbaufähigen Baumaßnahmen sind genehmigungspflichtig (bis hin
zur Abgabe von Materialproben der Wandfarbe).&lt;/li&gt;
&lt;li&gt;Die Altstadtlage bedeutet neben baulichen Details wie Verschattung durch die
höheren Nachbarhäuser auch, dass eine Photovoltaikanlage auf dem Dach hohen
bürokratischen Aufwand bei fraglicher Leistung für das Haus mit sich bringen
würde. Der Anbieter für Miet-PV-Anlagen, der alle Werbeplätze in den Bereichen
Energie und Heizungsbau einkauft, hat sich auch entschieden, mich durch Ghosten
darüber in Kenntnis zu setzen, dass sie in einer Beauftragung durch mich eher
ein Risiko als eine Chance sehen.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Aus der Faktenlage ergibt sich: Es ist besonders empfehlenswert, ohne
wesentliche bauliche Maßnahmen und Investitionen erste Einsparungen zu
realisieren, die während der Genehmigungsverfahren und der Wartezeit auf einen
tatsächlichen Umbautermin schon greifen.&lt;/p&gt;
&lt;h1 id=&#34;mein-einstieg-in-die-heizungsoptimierung&#34;&gt;
    &lt;a href=&#34;#mein-einstieg-in-die-heizungsoptimierung&#34;&gt;
	Mein Einstieg in die Heizungsoptimierung
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;Die über die App abrufbaren Energieverbrauchswerte gehen um 12 Monate zurück.
Die Werte werden in einfachen Balkendiagrammen dargestellt und sind zunächst
auch nicht exportierbar. Die 12-Monatsgrenze bedeutet auch, dass ich &lt;em&gt;diesen&lt;/em&gt;
Dezember nicht mit dem &lt;em&gt;vorigen&lt;/em&gt; Dezember vergleichen kann. In Wirklichkeit
vergisst die Internetbox die historischen Werte auch gerne mal, zum Beispiel
wenn die Heizungssteuerung abstürzt, oder die Heizung während der Wartung eine
Stunde stromlos geschaltet wird&amp;hellip;.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.koehntopp.info/uploads/2025/02/mybuderus-first-look.png&#34;&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2025/02/mybuderus-first-look.png&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/a&gt;

&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Ein Beispiel-Screenshot der MyBuderus App. In einer Wochenansicht Ende Oktober
werden Tagesverbrauchswerte für die letzten beiden Tage angezeigt, darüber
liegt eine Temperaturkurve. Die Tageswerte liegen bei 6 und 26 kWh, die
Aussentemperatur schwankt im Tagesmittel zwischen 12 und 14 Grad Celsius)&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Da die Heizung von Buderus ist, spricht sie sowohl für die Anbindung von
Erweiterungen wie Funkmodul und Mischer, als auch für die Internetbox, das
Protokoll EMS (genauer EMS+). Genau wie alle anderen Hersteller macht Buderus
um dieses Protokoll ein Geheimnis, aber es gibt zu meinem Glück Leute, die das
Protokoll reverse engineered haben und über ein &lt;a href=&#34;https://emsesp.org&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ESP Modul&lt;/a&gt;


eine Schnittstelle zu Lösungen wie Home Assistant bereitstellen. Weil ich mich
in Sachen Löten und Mikro-Elektronik für &amp;ldquo;zu schlecht für Heizungssachen&amp;rdquo;
halte, kaufe ich eine fertige EMS-ESP Box von
&lt;a href=&#34;https://bbqkees-electronics.nl/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;BBQKees&lt;/a&gt;

.&lt;/p&gt;
&lt;p&gt;Über EMS-ESP bekomme ich anstelle einer ausgewählten Auswahl von Informationen
und Einstellungsmöglichkeiten über einhundert Entities zu meiner Heizung
geliefert, die man teilweise auch schreiben/ändern kann. Ich begnüge mich aber
zunächst damit, den Zustand der Heizung zu beobachten. Änderungen an der Konfiguration
nehme ich weiterhin über die offizielle App vor.&lt;/p&gt;
&lt;p&gt;Der Winter 2022/2023 ist für mich extrem frustrierend. Ich &lt;em&gt;weiss&lt;/em&gt;, dass die
Heizung nicht ideal läuft, und ich kann es wenigstens sehen. Relativ schnell
erkenne ich folgende Unzulänglichkeiten:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Der Aussentemperaturfühler sitzt an einer ungünstigen Stelle. Aus der
denkmalschutzrechtlichen Situation und der Ausrichtung der freistehenden
Hausseiten ergibt sich, dass der Aussentemperaturfühler im Luftschacht zum
Keller sitzt und die gemessenen Temperaturen insbesondere im Winter stark
von den eigentlichen Aussentemperaturen abweichen.&lt;/li&gt;
&lt;li&gt;Das Heizsystem ist auf Auslieferunsgszustand mit Nachtabsenkung auf 16 Grad
und Tagheizung auf 21 Grad gestellt. Das führt mit den naiv auf ca. 20 Grad
eingestellten Raumthermostaten zu kräftigem Temperaturabfall nachts, den die
Heizung am Morgen dann versucht aufzuholen.&lt;/li&gt;
&lt;li&gt;Die Trockenbauweise der Fussbodenheizung hat unter anderem nicht die
Eigenschaft von in Estrich verlegten Heizungen, die Fussbodentemperatur
lange auf hohem Niveau zu halten.&lt;/li&gt;
&lt;li&gt;Die Warmwasserbereitung läuft kontinuierlich und verbraucht ca 12 kWh am Tag.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Ändern kann ich auf Anhieb nur die Punkte 2 und 4:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Ich stelle das Heizprogramm auf 19,5 und 19 Grad um. Dadurch sinkt der
Gasverbrauch für das Heizen um ca. 20%, bei deutlich verbessertem
Wärmekomfort.&lt;/li&gt;
&lt;li&gt;Die Warmwassererzeugung beschränke ich auf zwei Zeitfenster morgens und
abends, und senke hier den Verbrauch auf 7-8 kWh am Tag (immer noch viel zu
viel, aber ich nehme erstmal was ich kriegen kann).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.koehntopp.info/uploads/2025/02/taktung.png&#34;&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2025/02/taktung.png&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/a&gt;

&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Verlaufskurve der Temperatur im Heizkreislauf über drei Tage. Man erkennt ein
Sägezahnmuster, das auf Taktung hindeutet. Unterstützt wird die Hypothese durch
einen darüberliegenden Balken in dem mit Gelb angezeigt wird, wenn die Heizung
an ist, und mit grau, wenn sie aus ist. In den ersten 60% der Kurve wechselt
dieser Balken regelmässig zwischen grau und gelb. In den letzten 40% ist die
Sägezahnkurve durch eine weitestgehend gerade Linie ersetzt, und der Balken ist
durchgehend gelb&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Mit den neu eingestellten Werten ergibt sich nun ein neues Problem: Die Heizung
fängt an zu &amp;ldquo;takten&amp;rdquo;: Dadurch, dass die Raumthermostate niedrig eingestellt
sind ist die Wärmeanforderung so gering, dass die Heizung sich schnell
abschaltet und dann aber bald wieder einschaltet. Diese hohe Taktung ist einer
der Hauptgründe für vorzeitige Alterung und sollte vermieden werden. Es dauert
einige Zeit bis ich darauf komme, einfach die Raumthermostate weiter
aufzudrehen. Dazu später mehr.&lt;/p&gt;
&lt;p&gt;Und dann ist plötzlich die Heizperiode vorbei. Ich weiß, dass mein
Warmwasserspeicher tagsüber zu viel Temperatur verliert, die Ursache
hierfür ist mir aber noch nicht klar. Auch dazu später mehr.&lt;/p&gt;
&lt;h1 id=&#34;20232024&#34;&gt;
    &lt;a href=&#34;#20232024&#34;&gt;
	2023/2024
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.koehntopp.info/uploads/2025/02/beginn-heizperiode-23.png&#34;&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2025/02/beginn-heizperiode-23.png&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/a&gt;

&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Im Winter 2023/2024 beginnt die Heizperiode bereits Anfang Oktober. In der
MyBuderus-App sieht man wieder die beginnenden Heiztage, dieses mal bei von 12
auf 9 Grad fallende Aussentemperaturen mit Verbrauchswerten zwischen drei und
15 kWh&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;In diesem Winter versuche ich im Wesentlichen, meine Einstellungen aus dem
vorigen Winter zu validieren. Ich verändere wenig an der Steuerung, aber ich
beginne systematisch, das Haus mit Raumthermometern zu versorgen, um besser zu
verstehen, wann und wo Wärme notwendig ist. Im Januar 2024 kommt dann die
Gasabrechnung für das Jahr 2023 und &amp;hellip; unser Gasverbrauch liegt bei ca. 50%
des angenommenen Durchschnittswertes für ein Haus unserer Größe.
Und die Energiemenge liegt deutlich unter der unserer alten, wesentlich kleineren Mietwohnung in Berlin.&lt;/p&gt;
&lt;p&gt;Ich mache einen ersten Vorstoß hinsichtlich einer Brauchwasserwärmepumpe, da
übers Jahr gesehen die Warmwasserbereitung 20-25% meines Gasverbrauchs
ausmacht. Da aber Heizungsinstallateure sich ihre Projekte aussuchen können,
werde ich bei verschiedenen Anfragen geghostet, weil eine Sonderimmobilie eben
schwieriger ist, als in einer Neubausiedlung Wärmepumpen in Serie zu verbauen.&lt;/p&gt;
&lt;p&gt;Ich lerne aber in Gesprächen mit meinem Schornsteinfeger und dem
Heizungsmenschen, der meine Heizung wartet, dass ich hier in Wismar vermutlich
der einzige bin, der eine historische Datenaufzeichnung über das Verhalten und
den Verbrauch seiner Heizungsanlage hat und auswertet, und daraus bessere
Einstellungen ableitet. Konkret sagt mir ein Heizungsinstallateur etwas
neidisch, dass sie solche Informationen für keine einzige Anlage im Bestand bekommen
können. Ich bin also potentiell ein schwieriger Kunde, weil ich eigene
Vorstellungen und Ideen habe &amp;hellip;&lt;/p&gt;
&lt;p&gt;Im Sommer 2024 versuche ich weiter das Thema Wärmepumpe anzugehen, aber auch
hier verlieren Heizungsinstallateure nach ersten Gesprächen das Interesse und
ghosten mich. Nebenbei erweitere ich meine Home Assistant Views im Versuch,
Zusammenhänge besser zu visualisieren.&lt;/p&gt;
&lt;h1 id=&#34;20242025&#34;&gt;
    &lt;a href=&#34;#20242025&#34;&gt;
	2024/2025
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;Nachdem ich zwei Winter lang EMS-ESP und Home Assistant im Wesentlichen zur
Beobachtung des Heizungssystems verwendet habe, mache ich mich nun an weitere
Optimierungen des Heizsystems:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Ich schliesse eine Handvoll DS18B20 Temperatursensoren an die (aktualisierte)
EMS-ESP Box an und messe nun Vor- und Rücklauftemperatur an der
hydraulischen Weiche sowie die Trinkwassertemperatur bei Zu- und Abfluss des
Wasserspeichers.&lt;/li&gt;
&lt;li&gt;Da ich sehe, dass das Energie-Reporting der MyBuderus App und von EMS-ESP
weit auseinanderliegen, installiere ich noch einen Hall-Effekt-Zähler am Gaszähler.&lt;/li&gt;
&lt;li&gt;Zunächst korrigiere ich die Einstellung der Zirkulationspumpe, die einfach
auf Maximum steht, anstatt der notwendigen Förderpumpenhöhe entsprechend
eingestellt zu sein. Da die Zirkulationspumpe zusätzlich zur Pumpe im Gasboiler
läuft, kann ich auch die Leistung der internen Pumpe herunterstellen.&lt;/li&gt;
&lt;li&gt;Danach korrigiere ich die Einstellung der Raumthermostate. Da das Haus innen
im Wesentlichen einen offenen Aufbau hat, ist eine raumspezifische Einstellung
der Heizkreisläufe sowieso nicht wirklich möglich. Also stelle ich überall die
Raumthermostate auf Maximum, um einen gleichmässigen Volumenstrom über den
gesamten Heizstrang zu gewährleisten.&lt;/li&gt;
&lt;li&gt;Dann simuliere ich mithilfe von EMS-ESP ein
&lt;a href=&#34;https://docs.emsesp.org/Special-Functions/#remote-thermostats&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Raumthermostat&lt;/a&gt;

,
um die mangelhafte Positionierung des Aussentemperaturfühlers durch
raumtemperaturgeführte Steuerung mit Ausseneinfluss zu kompensieren.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Zum letzten Punkt sei gesagt: Es wäre ein leichtes gewesen, bei der letzten
Sanierung des Hauses ein Raumthermometer mit Anschluss an die Heizung zu
installieren; der EMS Bus funktioniert über ca. 100 Meter Länge. Die
Vorbesitzer haben an dieser Stelle meiner Meinung nach am falschen Ende gespart
und sind vom Heizungsbauer nicht gut beraten worden (das will ich dem
Heizungsbauer nicht vorwerfen, das ist aber eine andere Geschichte).&lt;/p&gt;
&lt;p&gt;Zum Gaszähler eine Anmerkung: Ich habe hier festgestellt, dass die MyBuderus Box
zwischen 10% und 25% zu wenig Verbrauch anzeigt, im Vergleich mit den Werten von
EMS-ESP, die ja aus dem gleichen System kommen. Das begründet sich darin, dass
die MyBuderus Box nur alle 90 Sekunden den Mittelwert des Boilers abfragt, und
EMS-ESP alle 20 Sekunden. Kurze Spitzen glättet die MyBuderus Box also weg. Der
Gaszähler hingegen scheint bis zu 10% &lt;em&gt;zuviel&lt;/em&gt; Kubikmeter zu zählen; vermutlich
weil bei bestimmten Stellgraden des Magneten am Zähler zum Hall-Effect-Sensor
kein Debounce stattfindet. Ich mache also zusätzlich noch jeden Monat ein Foto
vom Zähler &amp;hellip;&lt;/p&gt;
&lt;p&gt;In dieser Zeit beginne ich, meine Heizungserfahrungen im Fediverse zu verbloggen
(zu Finden mit einer Suche nach &lt;code&gt;from:oliof@social.treehouse.systems #heizung&lt;/code&gt;),
was mit einigem Interesse aufgenommen wird. Dieser und folgende Artikel sollen
die Inhalte zur einfacheren Referenzierung nochmal in aufgearbeiteter Form
wiedergeben.&lt;/p&gt;
&lt;p&gt;Ausserdem lese ich einschlägige Foren wie haustechnikdialog und heizungsforum
(keine Links gesetzt, findet ihr selbst) quer, der Ton dort ist mir aber zu
rau, als dass ich mich direkt einbringen wollen würde. Aus diesen Foren und
den Unterhaltungen zu meinen Posts lerne ich unter anderem zu Volumenstrom,
voll geöffneten Heizthermostaten, Heizkurve, alternativen Steuerungsansätzen
wie der Bajorath-Steuerung, und mein Verständnis dessen was ich tue entwickelt
sich von steuern, beobachten, messen, nachsteuern, zu gezielteren Experimenten.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.koehntopp.info/uploads/2025/02/ha-panel.png&#34;&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2025/02/ha-panel.png&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/a&gt;

&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Ein komplexes Panel aus HomeAssistant, das viele verschiedene Heizungswerte
und Diagramme zeigt: Aktuelle Einstellung des Thermostats, Raumtemperaturen,
Raumeinfluss auf die Vorlauftemperatur, Warmwassertemperatur, Betriebszustände
von Boiler, Warmwasserbereitung, Aussentemperaturkurven,
Heizkreislauftemperaturauswertung, und vieles mehr. Dieses Panel braucht seine
eigene Artikelserie &amp;hellip;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Ich schaue mir auch andere Optionen zur Heizungssteuerung an, zum Beispiel
&lt;a href=&#34;https://github.com/Alexwijn/SAT&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Smart Autotune Thermostat&lt;/a&gt;

, das eine bessere
Steuerung für &lt;a href=&#34;https://opentherm.eu&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Opentherm&lt;/a&gt;

 basierte Heizungen insbesondere
bei niedriger Heizlast liefert. Denn das ist bei mir ein Problem: Bei den
mittleren Temperaturen (6-10 Grad) läuft die Heizung zwar auf niedrigster
Modulation, damit wird aber immer noch zuviel Wärme produziert, also zuviel Gas
verbrannt.. Zu dieser Zeit wird SAT Version 4.0 veröffentlicht, dass auch die
Steuerung von EMS basierten Heizungen in einer ersten Fassung unterstützt.
Allerdings müsste ich dafür das RC310 meiner Gasheizung abklemmen, da die
EMS-Boiler anders als OpenTherm-Heizungen nicht so funktionieren, dass man ein
anderes Thermostat als Hauptsteuerung anmelden kann.&lt;/p&gt;
&lt;p&gt;Was ich aber durch die Auseinandersetzung mit SAT lerne: Meine Raumthermometer
sind zu träge für effektive Heizungssteuerung und ich ersetze die stabil
funktionierenden, aber langsam aktualisierenden Sonoff
&lt;a href=&#34;https://www.amazon.de/dp/B0BZCV658S&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SNZB-02D&lt;/a&gt;

 im Referenzraum durch
&lt;a href=&#34;https://blakadder.com/xiaomi-mho-c401-zigbee/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;MHO-C401&lt;/a&gt;

 &amp;ndash; die sprechen mit
einer &lt;a href=&#34;https://pvvx.github.io/MHO_C401/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;alternativen Firmware&lt;/a&gt;

 BTHome oder
Zigbee und aktualisieren häufiger als einmal pro Minute.&lt;/p&gt;
&lt;p&gt;Als Alternative zu SAT zur Kompensation des hohen Verbrauchs bei Niedriglast
implementiere ich in Home Assistant eine &lt;a href=&#34;https://docs.emsesp.org/tips-and-tricks/#low-load-optimisation-of-a-buderus-gb172-gas-boiler&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;einfache
Zweipunktsteuerung&lt;/a&gt;

,
um die Heizung bei Erreichen der Raumtemperatur abzuschalten, und bei
Unterschreiten der Raumtemperatur wieder einzuschalten. Dadurch spare ich bei
den Mitteltemperaturen zwischen 30 und 50 Prozent Heizenergie, und selbst bei den
Tiefsttemperaturen in diesem Winter kommen noch 10% Abschaltzeiten dazu. Ob
diese allerdings tatsächlich Energie-Einsparungen in entsprechender Höhe
bedeuten, oder die Heizung in anderen Zeiten gegen heizen muss, sei
dahingestellt.&lt;/p&gt;
&lt;p&gt;Mit den niedrigen Energieverbrauchszahlen für die Heizung drängt sich nun das
Thema Warmwasserbereitung in den Vordergrund. Ich beobachte weiterhin 1,2 Grad
Verlust der Wärme im Wasserspeicher pro Stunde. Wenn ich die
Zirkulationsleitung sperre, fällt der Wärmeverlust auf eher den Umständen
entsprechende Wärmeverluste von 0,4 Grad pro Stunde.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.koehntopp.info/uploads/2025/02/wwwverlust.png&#34;&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2025/02/wwwverlust.png&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/a&gt;

&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Ein Temperaturgraph, der einen stetigen Temperaturverlust anzeigt: Erst steil,
dann weniger steil, dann wieder steil. Zum Zeitpunkt des weniger steilen
Temperaturverlusts war die Zirkulationsleitung gesperrt.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Hier offenbart sich der Nachteil der EMS-ESP Lösung &amp;ndash; viele der Werte sind
nicht gut dokumentiert. Ich brauche mehrere Anläufe bis ich wirklich die
Entität finde, mit der ich den Betrieb der Zirkulationspumpe effektiv
unterbinden kann. Um Legionellenbildung in der Zirkulationsleitung zu
vermeiden, läuft die Warmwasserzirkulation nun jedes Mal einmal, wenn die
Warmwasseraufbereitung läuft, sobald die Zieltemperatur erreicht wird. Damit
reduziere ich den Kaltwasservorlauf von ca 10l auf im Mittel 5. Ich tausche
effektiv 10% Gesamtjahresenergieaufwand gegen 3% mehr Wasserverbrauch.&lt;/p&gt;
&lt;h1 id=&#34;vorläufiges-fazit&#34;&gt;
    &lt;a href=&#34;#vorl%c3%a4ufiges-fazit&#34;&gt;
	Vorläufiges Fazit
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;Meine Umwege und Lerngeschenke mal aussen vor gelassen, habe ich mit einem
mittelgut gedämmten Haus und einer nicht ganz so alten Bestandsanlage mit Hilfe
von angekoppelter Visualisuerung und ein paar Digitalthermometern eine
Optimierung meiner Heizung hinbekommen, die gegenüber den Einstellungen bei
Übernahme des Gebäudes bei fast gleichbleibendem (teilweise verbessertem)
Komfort ca. 50% des Energieverbrauchs fürs Heizen einspart. Das ist natürlich
gut, aber es legt die Meßlatte für die Zukunft entsprechend hoch.&lt;/p&gt;
&lt;p&gt;Es sei noch angemerkt, dass unterschiedliche bauliche Eigenschaften,
persönliches Behaglichkeitsempfinden, Möglichkeiten baulicher Anpassungen, etc.
absolut dazu führen werden, dass Dritte sich meine Beschreibung durchlesen, und
wenig bis nichts von meinen Maßnahmen direkt anwendbar ist. Wichtig ist aber
die Methodik:&lt;/p&gt;
&lt;p&gt;a) Messen&lt;br&gt;
b) Grösste Verbrauchsmomente identifizieren&lt;br&gt;
c) Diese Verbrauchsmomente eliminieren oder reduzieren&lt;br&gt;
d) Messen&lt;br&gt;
e) Eigenes Verhalten überprüfen und anpassen&lt;br&gt;
f) Messen&lt;/p&gt;
&lt;p&gt;Die Messbarkeit und Vergleichbarkeit mit vorherigen Einstellungen ist bei einem
trägen System wie der Heizung extrem wichtig, um die Wirksamkeit über ein
persönliches Bauchgefühl hinaus nachweisen zu können. Im folgenden Bild zum
Beispiel kann man den Effekt zweier warmer Körper und eines grossen
Flachbildschirms auf die Raumtemperatur sehen &amp;ndash; die Raumtemperatur geht um
0.25 Grad nach oben. Ist ja auch kein Wunder, schliesslich entspricht die
Wärmeentwicklung dieser drei Dinge in etwa 20% des Wärmebedarfs des fraglichen
Raumes &amp;hellip;&lt;/p&gt;
&lt;p&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2025/02/humanheating.png&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Ausschnitt aus einer Temperaturkurve, die in kurzer Zeit einen steilen Anstieg
der gemessenen Temperatur verzeichnet.&lt;/em&gt;&lt;/p&gt;
&lt;h1 id=&#34;2025-und-später&#34;&gt;
    &lt;a href=&#34;#2025-und-sp%c3%a4ter&#34;&gt;
	2025 und später
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;Ich habe endlich einen Heizungsinstallateur, der das Wärmepumpenprojekt mit mir
ernsthaft vorantreibt. Im Moment ist hier noch die Bauplanung und die
Genehmigung durch das Denkmalschutzamt anhängig, wir werden sehen, was daraus
wird.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Keine Windkraft zu Hause</title>
      <link>https://blog.koehntopp.info/2024/12/20/keine-windkraft-zu-hause.html</link>
      <pubDate>Fri, 20 Dec 2024 04:05:06 +0000</pubDate><author>kris-blog@koehntopp.de (Kristian Köhntopp)</author>

      <guid>https://blog.koehntopp.info/2024/12/20/keine-windkraft-zu-hause.html</guid>
      <description>&lt;p&gt;Auf Mastodon hieß es als Antwort auf einen Heim-Solar-Artikel:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Es fehlt irgendwie die haushaltstaugliche Windkraftanlage.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Die kann es nicht geben.
Mehrere physikalische Grundlagen sprechen gegen so etwas:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Bebaute Flächen und raue Untergründe zerstören den laminaren Flow des Windes.
In Wohngebieten weht der Wind instabil, stoßweise und aus wechselnden Richtungen.&lt;/li&gt;
&lt;li&gt;Generell muss man in mindestens 100 Meter Höhe über dem Boden arbeiten, in der &lt;a href=&#34;https://de.wikipedia.org/wiki/Ekman-Schicht&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Ekman-Schicht&lt;/a&gt;

.
Dies gilt idealerweise für die Untergrenze des Rotorblattes.&lt;/li&gt;
&lt;li&gt;Die Fläche eines Windrades steigt quadratisch mit dem Rotordurchmesser an.
Der Windenergie-Ertrag steigt mit
&lt;a href=&#34;https://energiewende.eu/warum-werden-windraeder-immer-groesser/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;der dritten Potenz der Windgeschwindigkeit&lt;/a&gt;


an (die in der Ekman-Schicht stabil und gleichmäßig hoch ist).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Das heißt, ein sinnvolles Windrad ist groß, steht &amp;ldquo;weit draußen&amp;rdquo; in der Fläche und ragt weit in den Bereich 100 m –
1000 m Höhe störungsfreier laminarer Strömung hinein.
Das wird nie in Wohngebieten sein.&lt;/p&gt;
&lt;p&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2024/12/windkraft-zu-haus-01.png&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/p&gt;
&lt;p&gt;Es gibt immer mal Ideen für &amp;ldquo;Windräder, die mit Wind aus wechselnden Richtungen&amp;rdquo; klar kommen,
aber die Instabilität bodennaher Winde ist nur der kleinere Teil des Problems.
Die Energie, die man ab-ernten will, ist in bodennahen und verwirbelten Schichten nicht vorhanden.
Man muß nach oben in die stabilen laminaren Schichten, um die Energie da heraus zu holen.&lt;/p&gt;
&lt;p&gt;Die Folge ist:
Zwar ist die Summe von Wind- und Sonnenenergie-Ertrag im Jahr in unseren Breiten im Mittel ungefähr konstant,
aber Du kannst Windstrom nicht autonom daheim erzeugen.&lt;/p&gt;
&lt;p&gt;Das heisst, Du wirst vier Monate im Jahr Strom aus dem Netz beziehen.&lt;/p&gt;
&lt;p&gt;Das heißt auch, dass wir Wind und Sonnenenergie balanciert ausbauen müssen.
Ein einziger Ausbau wird nicht funktionieren.&lt;/p&gt;
&lt;p&gt;Und weil der Ertrag nur ein Teil der Nennleistung ist, werden wir außerdem überbauen müssen, ggf. um den Faktor 2-3.
Das heisst, dass wir an ertragreichen Tagen einen Stromüberschuss haben werden –
und entweder abregeln oder Wasser elektrolysieren werden, auch wenn das ineffizient ist.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Windows abschalten</title>
      <link>https://blog.koehntopp.info/2024/11/26/windows-abschalten.html</link>
      <pubDate>Tue, 26 Nov 2024 04:05:06 +0000</pubDate><author>kris-blog@koehntopp.de (Kristian Köhntopp)</author>

      <guid>https://blog.koehntopp.info/2024/11/26/windows-abschalten.html</guid>
      <description>&lt;h1 id=&#34;an&#34;&gt;
    &lt;a href=&#34;#an&#34;&gt;
	An
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;Ich kann meinen Windows-Rechner anschalten.
Also ohne hin zu gehen:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; cat bin/wake-steam
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt;! /bin/sh
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;wakeonlan 70:8b:cd:4f:4d:5e
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;und dann geht er an, loggt sich ein, startet Steam und ich kann mich von einem richtigen Computer aus mit Stream verbinden.&lt;/p&gt;
&lt;h1 id=&#34;aus&#34;&gt;
    &lt;a href=&#34;#aus&#34;&gt;
	Aus
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;Ich will den Spielerechner auch abschalten.
Ich könnte warten.
Dann geht er nach 30 Minuten idle aus.
Aber das sind 30 Minuten 80 Watt für nix.&lt;/p&gt;
&lt;p&gt;Man kann einem Windows auf der Kommandozeile sagen, daß es ritellen Selbstmord begehen soll:
&lt;a href=&#34;https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/shutdown&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Shutdown Command&lt;/a&gt;

&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;C:\Users\Admin&amp;gt; shutdown /s /f /t 0&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ich kann also OpenSSH auf dem Windows installieren, mich remote auf der Kiste anmelden und das Kommando ausführen.&lt;/p&gt;
&lt;p&gt;Oder gleich ganz remote:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; ssh Admin@rtx.local &lt;span class=&#34;s2&#34;&gt;&amp;#34;shutdown /s /f /t 0&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Password:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Das Paßwort stört.&lt;/p&gt;
&lt;h1 id=&#34;passwordless-ssh-for-admininstrators&#34;&gt;
    &lt;a href=&#34;#passwordless-ssh-for-admininstrators&#34;&gt;
	Passwordless &lt;code&gt;ssh&lt;/code&gt; for &lt;code&gt;Admininstrators&lt;/code&gt;
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;&lt;strong&gt;HINWEIS:&lt;/strong&gt; Die folgenden Instruktionen sind für Windows 11. In Windows 10 ist das nicht so.&lt;/p&gt;
&lt;p&gt;Macht ja nix, ich kann ja meinen Key installieren:
&lt;a href=&#34;https://learn.microsoft.com/en-us/windows-server/administration/openssh/openssh_keymanagement&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Key-based authentication in OpenSSH for Windows&lt;/a&gt;

&lt;/p&gt;
&lt;p&gt;Für Standard-User:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;The contents of your public key (&lt;code&gt;\.ssh\id_ecdsa.pub&lt;/code&gt;)
needs to be placed on the server into a text file called &lt;code&gt;authorized_keys&lt;/code&gt; in &lt;code&gt;C:\Users\username\.ssh\&lt;/code&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Aber: Das funktioniert nicht, wenn der User Mitglied in der &lt;code&gt;Administrators&lt;/code&gt; Group ist.
Dann ist es so:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;The contents of your public key (&lt;code&gt;\.ssh\id_ecdsa.pub&lt;/code&gt;)
needs to be placed on the server into a text file called &lt;code&gt;administrators_authorized_keys&lt;/code&gt; in &lt;code&gt;C:\ProgramData\ssh\&lt;/code&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Beachte, dass das nicht per User ist, sondern Shared für alle User, die in &lt;code&gt;Administrators&lt;/code&gt; sind.&lt;/p&gt;
&lt;p&gt;Nun gut, ist ja eine Personal Workstation, gibt also nur einen User und der ist immer Administrator, also muß das immer nach da und nie nach &lt;code&gt;%HOME%\.ssh&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Get the public key file generated previously on your client
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;authorizedKey&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; Get-Content -Path &lt;span class=&#34;nv&#34;&gt;$env&lt;/span&gt;:USERPROFILE&lt;span class=&#34;se&#34;&gt;\.&lt;/span&gt;ssh&lt;span class=&#34;se&#34;&gt;\i&lt;/span&gt;d_ecdsa.pub
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Generate the PowerShell to be run remote that will copy the public key file generated previously on your client to the authorized_keys file on your server
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;remotePowershell&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;powershell Add-Content -Force -Path &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$env&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;:ProgramData\ssh\administrators_authorized_keys -Value &amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$authorizedKey&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#39;&amp;#39;&amp;#39;;icacls.exe &amp;#34;&amp;#34;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$env&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;:ProgramData\ssh\administrators_authorized_keys&amp;#34;&amp;#34; /inheritance:r /grant &amp;#34;&amp;#34;Administrators:F&amp;#34;&amp;#34; /grant &amp;#34;&amp;#34;SYSTEM:F&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Connect to your server and run the PowerShell using the &lt;span class=&#34;nv&#34;&gt;$remotePowerShell&lt;/span&gt; variable
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;ssh username@domain1@contoso.com $remotePowershell
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;localization&#34;&gt;
    &lt;a href=&#34;#localization&#34;&gt;
	Localization
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;Und dann, damit alle, alles zerbricht:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;For non-English localized versions of the operating system, the script will need to be modified to reflect group names accordingly. 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Mein Windows ist English, also geht es, aber die armen Würste, die Windows scripten müssen.&lt;/p&gt;
&lt;p&gt;Aber nein:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;remotePowershell&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;powershell Add-Content -Force -Path &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$env&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;:ProgramData\ssh\administrators_authorized_keys -Value &amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$authorizedKey&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#39;&amp;#39;&amp;#39;;icacls.exe &amp;#34;&amp;#34;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$env&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;:ProgramData\ssh\administrators_authorized_keys&amp;#34;&amp;#34; /inheritance:r /grant &amp;#34;&amp;#34;*S-1-5-32-544:F&amp;#34;&amp;#34; /grant &amp;#34;&amp;#34;SYSTEM:F&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Und bei Microsoft wundern sich hochbezahlte Marketingmenschen wieso Linux die Welt erobert hat.&lt;/p&gt;
&lt;h1 id=&#34;andere-methoden&#34;&gt;
    &lt;a href=&#34;#andere-methoden&#34;&gt;
	Andere Methoden
    &lt;/a&gt;
&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://superuser.com/questions/1746456/windows-11-net-rpc-shutdown&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Samba: NET RPC SHUTDOWN -f -I 192.168.0.147 -U user%password&lt;/a&gt;


File and Printer Sharing must be enabled in &lt;code&gt;Settings &amp;gt; Network &amp;amp; Internet &amp;gt; Status &amp;gt; Network and Sharing Centre &amp;gt; Change advanced sharing settings&lt;/code&gt;.
The firewall must allow File and Printer Sharing through in &lt;code&gt;Start &amp;gt; Windows Defender Firewall with Advanced Security &amp;gt; Inbound Rules&lt;/code&gt;. All of them.&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/brann0n/SleepOnLan&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SleepOnLAN&lt;/a&gt;

&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>MySQL: dual passwords</title>
      <link>https://blog.koehntopp.info/2024/10/31/mysql-dual-passwords.html</link>
      <pubDate>Mon, 28 Oct 2024 05:06:07 +0000</pubDate><author>kris-blog@koehntopp.de (Kristian Köhntopp)</author>

      <guid>https://blog.koehntopp.info/2024/10/31/mysql-dual-passwords.html</guid>
      <description>&lt;p&gt;Account password rotation is often a regulatory requirement.
For that very reason, MySQL allows you to have multiple passwords on a single account.&lt;/p&gt;
&lt;p&gt;I have written about this in
&lt;a href=&#34;https://blog.koehntopp.info/2023/02/20/rotating-accounts-or-passwords.html&#34;&gt;Rotating Accounts or Passwords?&lt;/a&gt;

.&lt;/p&gt;
&lt;p&gt;Of course, if something is a regulatory requirement, you also need to prove that you are meeting it.&lt;/p&gt;
&lt;p&gt;So Percona has a nice article
&lt;a href=&#34;https://www.percona.com/blog/tracking-dual-passwords-in-mysql/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tracking Dual Passwords in MySQL&lt;/a&gt;


which shows how can (not) track dual password usage.&lt;/p&gt;
&lt;p&gt;While it is somewhat possible to generate a report that shows you which accounts have dual passwords,
other things are hard.
Finding out which accounts have used what password last, or
if an old account password is still being used (and from what machine) is either painful or downright impossible.&lt;/p&gt;
&lt;p&gt;There is no native view or reporting query that can give you an overview over all accounts,
when they logged in last time with password1 or password2.
Instead, one has to do painful log analysis with elevated log levels.&lt;/p&gt;
&lt;p&gt;Less than ideal, and also not good feature planning.
I mean, if you implement such a feature, you&amp;rsquo;d would ask yourself &amp;ldquo;What for?&amp;rdquo;, and,
if it is a security feature, you&amp;rsquo;d also always ask &amp;ldquo;How can I prove that it is working as intended?&amp;rdquo;
Somehow that has not happened, yet, for this particular feature – for almost two years now?&lt;/p&gt;
&lt;p&gt;Until then, my advice would be doing as suggested in my 2023 article, and rotate accounts for machine logins.
It is much easier to account for,
you are generating machine accounts automatically anyway and
use a mechanism such as Vault or similar to distribute login information to client applications.&lt;/p&gt;
&lt;p&gt;Rotating accounts should be a no-brainer and simple logins are very easy to track.&lt;/p&gt;
&lt;p&gt;Check if outdated accounts are still used.
Once usage stops, drop them.
If usage does not stop within a week, alert on that,
and grab the application owner for a talk because somebody is illegally caching credentials.&lt;/p&gt;
&lt;p&gt;If accounts are no longer used at all,
after some timeout check with the application owner if the application is still needed,
and block the credentials.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>MySQL: information_schema.tables performance regression</title>
      <link>https://blog.koehntopp.info/2024/10/28/mysql-information-schema-table-performance-regression.html</link>
      <pubDate>Mon, 28 Oct 2024 05:06:07 +0000</pubDate><author>kris-blog@koehntopp.de (Kristian Köhntopp)</author>

      <guid>https://blog.koehntopp.info/2024/10/28/mysql-information-schema-table-performance-regression.html</guid>
      <description>&lt;p&gt;In IRC &lt;code&gt;libera:#mysql&lt;/code&gt; somebody asked about the performance of
&lt;code&gt;SHOW TABLES LIKE &#39;name&#39;&lt;/code&gt;
in MySQL 8.0, which was slow for them, but fast in 5.7.
They pointed to
&lt;a href=&#34;https://forums.mysql.com/read.php?24,706979,706979&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;a forum article from 2022&lt;/a&gt;


that had a similar problem with a &lt;code&gt;select&lt;/code&gt;-statement on &lt;code&gt;I_S.TABLES&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Both cases had in common a large number of tables in a single schema.
The person in IRC had around 40k tables,
the person in the forum article 500k tables.&lt;/p&gt;
&lt;p&gt;I wrote about
&lt;a href=&#34;https://blog.koehntopp.info/2021/09/10/mysql-million-challenge.html&#34;&gt;the Million Challenge&lt;/a&gt;


in 2021, but was unable to follow through for personal reasons.
This question prompted me to pick this up.&lt;/p&gt;
&lt;h1 id=&#34;making-a-million-tables&#34;&gt;
    &lt;a href=&#34;#making-a-million-tables&#34;&gt;
	Making a million tables
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;Code to make a million tables in a schema is cheap.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-mysql&#34; data-lang=&#34;mysql&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;mysql&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;create&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;database&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;million&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mysql&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;grant&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;all&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;on&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;million&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;to&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;kris&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;@&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;localhost&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mysql&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;grant&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;all&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;on&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;million&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;to&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;kris&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;@&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;192.168.1.0/24&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;and&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;ch&#34;&gt;#! /usr/bin/env python&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;sys&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;MySQLdb&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;MySQLdb.cursors&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;click&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;db_config&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;dict&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;host&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;127.0.0.1&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;user&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;kris&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;passwd&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;...&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;db&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;million&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;cursorclass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;MySQLdb&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cursors&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;DictCursor&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;db&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MySQLdb&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;connect&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;**&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;db_config&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nd&#34;&gt;@click.group&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;help&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Create a million tables&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;sql&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;():&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;pass&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;run_template&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;template&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;basename&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;count&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;count&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;cmd&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;template&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;format&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;basename&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;basename&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;count&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;100&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;sa&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cmd&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;end&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\r&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;try&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;db&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cursor&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;execute&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cmd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;except&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MySQLdb&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Error&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;as&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;click&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;sa&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;MySQL Error: &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;sys&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;exit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nd&#34;&gt;@sql.command&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nd&#34;&gt;@click.option&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;--count&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;default&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1000000&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;help&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;number of tables to drop.&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nd&#34;&gt;@click.option&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;--basename&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;default&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;testtable&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;help&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;base name of tables.&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;drop&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;count&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;basename&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;template&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;drop table if exists &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{basename}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;_&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{count:06d}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;run_template&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;template&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;template&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;basename&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;basename&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;count&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;count&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nd&#34;&gt;@sql.command&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nd&#34;&gt;@click.option&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;--count&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;default&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1000000&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;help&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;number of tables to drop.&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nd&#34;&gt;@click.option&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;--basename&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;default&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;testtable&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;help&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;base name of tables.&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;create&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;count&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;basename&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;template&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;create table if not exists &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{basename}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;_&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{count:06d}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; (id serial, d varchar(200), e varchar(200), f varchar(200), i integer, j integer)&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;run_template&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;template&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;template&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;basename&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;basename&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;count&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;count&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;sql&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;its-slow&#34;&gt;
    &lt;a href=&#34;#its-slow&#34;&gt;
	It&amp;rsquo;s slow
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;When running this in &lt;code&gt;create&lt;/code&gt; mode with defaults,
it creates around 900 tables per minute.&lt;/p&gt;
&lt;p&gt;This is on an AMD Ryzen 7 5700G, 128 GB RAM, 64 GB buffer pool,
XFS on a 100G partition on a Crucial NVME (CT4000P3PSSD8).
&lt;code&gt;iostat&lt;/code&gt; shows close to 100% utilization, at 16 MB/s disk writes and around 1000 w/s.&lt;/p&gt;
&lt;p&gt;I am not impressed with the creation rate.&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;.ibd&lt;/code&gt; files created are empty and take 114688 Bytes (7 pages) on disk, each.
A million of these &lt;code&gt;.ibd&lt;/code&gt; files will take slightly over 100 GB of disk space.&lt;/p&gt;
&lt;p&gt;I didn&amp;rsquo;t make this calculation in advance, and my disk filled up overnight with 313k tables.
Running &lt;code&gt;ls&lt;/code&gt; in &lt;code&gt;/var/lib/mysql/million&lt;/code&gt; takes 1.781s realtime (with 1s system time).
Running &lt;code&gt;ls -l&lt;/code&gt; takes 3.156s realtime (with 2.177s system time).&lt;/p&gt;
&lt;h1 id=&#34;its-even-slower-in-the-database&#34;&gt;
    &lt;a href=&#34;#its-even-slower-in-the-database&#34;&gt;
	It&amp;rsquo;s even slower in the database
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;Asking for a table in the &lt;code&gt;million&lt;/code&gt; schema is slow.
It is not a buffer pool caching problem, it is slow immediately after, asking for the same table:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-mysql&#34; data-lang=&#34;mysql&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;mysql&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;select&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;table_name&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;as&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;from&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;information_schema&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;kp&#34;&gt;tables&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;where&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;table_name&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;like&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;testtable_033478&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+------------------+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;             &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+------------------+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;testtable_033478&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+------------------+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;row&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;in&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;22&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mysql&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;select&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;table_name&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;as&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;from&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;information_schema&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;kp&#34;&gt;tables&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;where&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;table_name&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;like&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;testtable_033478&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+------------------+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;             &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+------------------+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;testtable_033478&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+------------------+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;row&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;in&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;22&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Even asking for tables from another schema with only 6 tables is slow:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-mysql&#34; data-lang=&#34;mysql&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;mysql&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;select&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;table_name&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;as&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;from&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;information_schema&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;kp&#34;&gt;tables&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;where&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;table_name&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;like&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;ek_dict&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+---------+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+---------+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ek_dict&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+---------+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;row&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;in&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;22&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Adding &lt;code&gt;table_schema&lt;/code&gt; helps in that case:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-mysql&#34; data-lang=&#34;mysql&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;mysql&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;select&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;table_name&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;as&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;from&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;information_schema&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;kp&#34;&gt;tables&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;where&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;table_name&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;like&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;ek_dict&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;and&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;table_schema&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;kris&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+---------+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+---------+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ek_dict&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+---------+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;row&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;in&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;00&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mysql&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;select&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;table_name&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;as&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;from&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;information_schema&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;kp&#34;&gt;tables&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;where&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;table_name&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;like&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;ek_dict&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+---------+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+---------+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ek_dict&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+---------+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;row&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;in&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;21&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;the-hidden-tables-of-data-dictionary&#34;&gt;
    &lt;a href=&#34;#the-hidden-tables-of-data-dictionary&#34;&gt;
	The hidden tables of data dictionary
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;Looking at the plan, we see that &lt;code&gt;I_S.TABLES&lt;/code&gt; is really a view that queries hidden tables in &lt;code&gt;mysql.*&lt;/code&gt;.
These hidden tables are the data dictionary:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-mysql&#34; data-lang=&#34;mysql&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;mysql&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;explain&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;select&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;table_name&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;as&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;from&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;information_schema&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;kp&#34;&gt;tables&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;where&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;table_name&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;like&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;ek_dict&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;and&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;table_schema&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;kris&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+----+-------------+-------+------------+--------+--------------------+------------+---------+-------------------------+-------+----------+-------------+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;select_type&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;table&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;partitions&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;possible_keys&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key_len&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ref&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                     &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;rows&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;filtered&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Extra&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+----+-------------+-------+------------+--------+--------------------+------------+---------+-------------------------+-------+----------+-------------+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SIMPLE&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cat&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;no&#34;&gt;NULL&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;index&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;PRIMARY&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;194&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;     &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;no&#34;&gt;NULL&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                    &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;     &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;100&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;00&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;Using&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;index&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SIMPLE&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sch&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;no&#34;&gt;NULL&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;eq_ref&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;PRIMARY&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;catalog_id&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;catalog_id&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;202&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;     &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mysql&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cat&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;const&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;     &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;100&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;00&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;Using&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;index&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SIMPLE&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tbl&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;no&#34;&gt;NULL&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ref&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;schema_id&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;schema_id&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mysql&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;34844&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;11&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;11&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;Using&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;where&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SIMPLE&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;col&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;no&#34;&gt;NULL&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;eq_ref&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;PRIMARY&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;PRIMARY&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mysql&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tbl&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;collation_id&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;     &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;100&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;00&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;Using&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;index&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SIMPLE&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ts&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;no&#34;&gt;NULL&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;eq_ref&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;PRIMARY&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;PRIMARY&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mysql&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tbl&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tablespace_id&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;     &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;100&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;00&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;Using&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;index&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SIMPLE&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;stat&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;no&#34;&gt;NULL&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;eq_ref&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;PRIMARY&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;PRIMARY&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;388&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;     &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;const&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mysql&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tbl&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;     &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;100&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;00&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;Using&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;index&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+----+-------------+-------+------------+--------+--------------------+------------+---------+-------------------------+-------+----------+-------------+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;In this case, we have an initial &lt;code&gt;index&lt;/code&gt; lookup on the &lt;code&gt;name&lt;/code&gt; index in the invisible &lt;code&gt;cat&lt;/code&gt; table.
Then a bunch of &lt;code&gt;eq_ref&lt;/code&gt; primary key relations,
and one lookup that stands out, a &lt;code&gt;type=ref&lt;/code&gt; in &lt;code&gt;tbl&lt;/code&gt; using the &lt;code&gt;schema_id&lt;/code&gt; index against &lt;code&gt;mysql.sch.id&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;This yields a badness of 34844 (11% of 313k).
This is an optimizer mis-guess, because our schemas are heavily imbalanced:
&lt;code&gt;kris&lt;/code&gt; is much better and has only 6 tables.
The query is much faster than estimated, thanks to the imbalance.&lt;/p&gt;
&lt;p&gt;Leaving off the &lt;code&gt;table_schema = &amp;quot;kris&amp;quot;&lt;/code&gt; clause gives us a worse plan:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-mysql&#34; data-lang=&#34;mysql&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;mysql&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;explain&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;select&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;table_name&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;as&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;from&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;information_schema&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;kp&#34;&gt;tables&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;where&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;table_name&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;like&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;ek_dict&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+----+-------------+-------+------------+--------+--------------------+------------+---------+-------------------------------+-------+----------+-------------+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;select_type&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;table&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;partitions&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;possible_keys&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key_len&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ref&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                           &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;rows&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;filtered&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Extra&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+----+-------------+-------+------------+--------+--------------------+------------+---------+-------------------------------+-------+----------+-------------+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SIMPLE&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cat&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;no&#34;&gt;NULL&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;index&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;PRIMARY&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;194&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;     &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;no&#34;&gt;NULL&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                          &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;     &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;100&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;00&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;Using&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;index&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SIMPLE&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sch&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;no&#34;&gt;NULL&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ref&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;PRIMARY&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;catalog_id&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;catalog_id&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mysql&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cat&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                  &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;     &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;100&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;00&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;Using&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;index&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SIMPLE&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tbl&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;no&#34;&gt;NULL&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ref&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;schema_id&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;schema_id&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mysql&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                  &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;34844&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;11&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;11&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;Using&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;where&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SIMPLE&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;col&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;no&#34;&gt;NULL&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;eq_ref&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;PRIMARY&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;PRIMARY&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mysql&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tbl&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;collation_id&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;     &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;100&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;00&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;Using&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;index&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SIMPLE&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ts&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;no&#34;&gt;NULL&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;eq_ref&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;PRIMARY&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;PRIMARY&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mysql&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tbl&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tablespace_id&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;     &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;100&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;00&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;Using&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;index&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SIMPLE&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;stat&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;no&#34;&gt;NULL&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;eq_ref&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;PRIMARY&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;PRIMARY&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;388&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;     &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mysql&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mysql&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tbl&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;     &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;100&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;00&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;Using&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;index&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+----+-------------+-------+------------+--------+--------------------+------------+---------+-------------------------------+-------+----------+-------------+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Here we now have two &lt;code&gt;ref&lt;/code&gt; with a badness of 6 and 34844 against &lt;code&gt;mysql.cat.id&lt;/code&gt; and &lt;code&gt;mysql.sch.id&lt;/code&gt; respectively.&lt;/p&gt;
&lt;p&gt;The actual runtime is identical to asking for a table from the &lt;code&gt;million&lt;/code&gt; schema:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-mysql&#34; data-lang=&#34;mysql&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;mysql&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;select&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;table_name&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;as&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;from&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;information_schema&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;kp&#34;&gt;tables&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;where&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;table_name&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;like&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;ek_dict&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+---------+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+---------+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ek_dict&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+---------+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;row&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;in&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;23&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The command &lt;code&gt;show tables like&lt;/code&gt; is also affected by the slowdown:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-mysql&#34; data-lang=&#34;mysql&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;mysql&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;show&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kp&#34;&gt;tables&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;like&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;testtable_033478&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+--------------------------------------+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Tables_in_million&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;testtable_033478&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+--------------------------------------+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;testtable_033478&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                     &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+--------------------------------------+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;row&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;in&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;23&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;is-that-bad&#34;&gt;
    &lt;a href=&#34;#is-that-bad&#34;&gt;
	Is that bad?
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;Yes.&lt;/p&gt;
&lt;p&gt;Queries against &lt;code&gt;i_s.tables&lt;/code&gt; should be fast and scale to a million tables.
They are running often, and not just when sending them explicitly to the server,
but they are also used internally and implicitly when doing other things.&lt;/p&gt;
&lt;p&gt;Here is what happens when I &lt;code&gt;drop database million&lt;/code&gt; with 313k tables in it:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-mysql&#34; data-lang=&#34;mysql&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;mysql&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;drop&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;database&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;million&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;freeze&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;and&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-mysql&#34; data-lang=&#34;mysql&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;mysql&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;show&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;processlist&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+-----+-----------------+-----------+---------+---------+------+------------------------+-----------------------+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Id&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;User&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Host&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;db&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Command&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;Time&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;State&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                  &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Info&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                  &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+-----+-----------------+-----------+---------+---------+------+------------------------+-----------------------+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;event_scheduler&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;localhost&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;no&#34;&gt;NULL&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Daemon&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;6678&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Waiting&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;on&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;queue&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;no&#34;&gt;NULL&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                  &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;28&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;root&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;localhost&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mysql&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Query&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;init&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                   &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;show&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;processlist&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;597&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;root&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;localhost&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;million&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Query&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;18&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;checking&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;permissions&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;drop&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;database&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;million&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+-----+-----------------+-----------+---------+---------+------+------------------------+-----------------------+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The database freezes on a MDL, with &lt;code&gt;checking permission&lt;/code&gt;, individually,
slowly, at a rate of 4 per second (0.23s query runtime),
before it can begin to process the &lt;code&gt;drop database&lt;/code&gt; command.&lt;/p&gt;
&lt;p&gt;Please don&amp;rsquo;t.&lt;/p&gt;
&lt;h1 id=&#34;tldr&#34;&gt;
    &lt;a href=&#34;#tldr&#34;&gt;
	TL;DR
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;MySQL 8.x uses hidden InnoDB tables in &lt;code&gt;mysql.*&lt;/code&gt; to store a data dictionary (DD).&lt;/p&gt;
&lt;p&gt;Some queries against the DD do not scale well, in my case against 313k tables in a single database.&lt;/p&gt;
&lt;p&gt;Queries are being run against DD very often and often implicitly.
Not only are explicit queries against &lt;code&gt;I_S.TABLES&lt;/code&gt; and &lt;code&gt;SHOW TABLES LIKE&lt;/code&gt; statements slow,
a &lt;code&gt;drop database&lt;/code&gt; on a schema with 313k tables will never terminate.&lt;/p&gt;
&lt;h1 id=&#34;see-also&#34;&gt;
    &lt;a href=&#34;#see-also&#34;&gt;
	See Also
    &lt;/a&gt;
&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://jfg-mysql.blogspot.com/2024/10/impressed-by-disabling-innodb-redo-logs.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Disabling InnoDB Redo Logging for Creating Tables as Fast as Possible&lt;/a&gt;

 by J-F Gagné&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>Abnormal</title>
      <link>https://blog.koehntopp.info/2024/10/21/abnormal.html</link>
      <pubDate>Mon, 21 Oct 2024 04:05:06 +0000</pubDate><author>kris-blog@koehntopp.de (Kristian Köhntopp)</author>

      <guid>https://blog.koehntopp.info/2024/10/21/abnormal.html</guid>
      <description>&lt;p&gt;&lt;a href=&#34;https://www.deloitte.com/de/de/Industries/tmt/media-consumer-survey.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Deloitte Media Consumer Survey 2024&lt;/a&gt;

&lt;/p&gt;
&lt;p&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2024/10/abnormal-01.png&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;


&lt;em&gt;Mediennutzung 2021 vs. 2024: Auch 2021 hat Deloitte im Rahmen der Media Consumer Survey 2.000 Konsument:innen zur TV- und Videonutzung befragt. Was hat sich seitdem verändert?&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;2021 Immer mehr Zuschauer wenden sich vom linearen TV ab // 2024 Trotz weiterer Zuschauerverluste schauen weiterhin 81% überwiegend linear.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;2021 Eine deutliche Mehrzahl der TV-Geräte ist mit dem Internet verbunden // 2024 Der Anteil der mit dem Internet verbundenen TV-Geräte hat um 20 Prozentpunkte zugenommen.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;What the actual fuck?&lt;/p&gt;
&lt;p&gt;Wenn ich hier im Winter morgens zur Bushaltestelle gehe, dann kann ich – es sind die Niederlande – durch die Fenster der Nachbarn sehen, wie sie am Frühstückstisch den Tag beginnen.
Es ist unhöflich, so etwas zu tun oder zu erwähnen, aber kaum zu vermeiden.&lt;/p&gt;
&lt;p&gt;In den weitaus meisten Haushalten hier steht in Sichtweite des Esstisches ein Fernseher und er ist morgens an.&lt;/p&gt;
&lt;p&gt;Etwas, das in dem Kontext, in dem ich aufgewachsen bin und den ich lebe vollkommen ausgeschlossen ist.
Allerdings war bei uns daheim oft NDR2 an, in der Küche oder im Bad.
Das ist allerdings auch schon lange nicht mehr der Fall.&lt;/p&gt;
&lt;h1 id=&#34;mp3&#34;&gt;
    &lt;a href=&#34;#mp3&#34;&gt;
	MP3
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;Als es losging mit MP3-Dateien, habe ich meine erste ATA-Festplatte gekauft – vorher hatte ich immer nur SCSI-Platten.
Aber ich brauchte billigen Platz.
Ich habe meine CD-Sammlung komplett gerippt, und bin dann mit der Platte und ihrem Inhalt bei meinen Freunden vorbei und habe sie gefragt, ob ich deren CDs ausleihen kann.&lt;/p&gt;
&lt;p&gt;&amp;ldquo;Ja, klar. Welche denn?&amp;rdquo; &amp;ldquo;Äh, alle?&amp;rdquo;&lt;/p&gt;
&lt;p&gt;Ich habe dann auch deren CDs gerippt, in die Sammlung eingefügt,
und die CDs mit einer Kopie der Platte zurückgegeben.&lt;/p&gt;
&lt;p&gt;Das war spannend.
Egal wie oft ich das gemacht habe (und es sind inzwischen nicht ganz 100k Titel),
der Overlap zwischen den Beständen war minimal,
einzelne Alben aus Sammlungen von hunderten von Titeln – mit Ausnahme von Soundtracks und Filmmusik.&lt;/p&gt;
&lt;p&gt;Das war die Zeit, als auf Radio Schleswig-Holstein
der Djingle &amp;ldquo;Eine Million für Zehn!&amp;rdquo; für deren Gewinnspiel tot gedudelt wurde,
und meine fast ein halbes Jahr dauernde Aktion war im Grunde eine direkte Reaktion darauf.
Das Ding hat irgendetwas in mir abgetötet und danach war mir dann alles egal.&lt;/p&gt;
&lt;p&gt;Seitdem ist das Radio weitgehend aus.&lt;/p&gt;
&lt;p&gt;Also, auch wortwörtlich – sie haben es dann ja auf ein digitales Format umgestellt (DAB),
dann gleich noch einmal auf ein anderes digitales Format (DAB2? DAB+? Egal),
und ich hatte so gar keine Motivation, ein Empfangsgerät dafür zu beschaffen.&lt;/p&gt;
&lt;p&gt;Das aktuelle Auto hat offenbar irgendein Digitalradio, aber das hat noch nie jemand benutzt,
denn das aktuelle Auto hat auch Internet.&lt;/p&gt;
&lt;h1 id=&#34;tv&#34;&gt;
    &lt;a href=&#34;#tv&#34;&gt;
	TV
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;Etwas später, kurz nach 2000, hat ein Arbeitskollege mich zum Mediamarkt genommen,
und gesagt &amp;ldquo;Kauf das da&amp;rdquo;.
&amp;ldquo;Das da&amp;rdquo; war ein Schneider PrimeTimer DVR, und der konnte – das war die wichtigste Funktion, +30s Skippen.&lt;/p&gt;
&lt;p&gt;Das war die letzte Werbung, die ich je im Fernsehen gesehen habe.&lt;/p&gt;
&lt;p&gt;Die zweitwichtigste Funktion war die Serienautomatik,
und so war immer was zum Gucken auf der Platte und für lineares Fernsehen war keine Zeit mehr.&lt;/p&gt;
&lt;p&gt;Der analoge Fernseher ging kaputt, und analoges Fernsehen auch.
Elgato hatte aber einen Digitalfernseh-Stick und Software dafür,
die im Wesentlichen genau das tat,
was der Prime Timer auch machte – also kam ein Mac Mini unter den Fernseher und blieb da,
bis er durch einen anderen Mini ersetzt wurde.&lt;/p&gt;
&lt;p&gt;Der aktuelle Mini ist der 3. in 20 Jahren, das kleinste M1 Modell (kein RAM, keine Platte).&lt;/p&gt;
&lt;p&gt;Der Mini macht VPN zum deutschen Dedi, Mediathekwebview, Youtube-DL und Youtube im Browser mit uBlock origin,
BBC, und VLC vom Fileserver.
Der Fileserver hat irgendwo ein wenig mehr als ein TB ungesehenes Zeug rumliegen.&lt;/p&gt;
&lt;p&gt;Wir haben eine Decoder-Box für niederländisches Fernsehen über IP,
weil die mit dem Internet mit kam.
Die war auch mal an, um zu gucken, dass sie funktioniert.&lt;/p&gt;
&lt;p&gt;Der aktuelle Fernseher ist ein 4K Spionage-Gerät von LG, das sich vor allen Dingen dadurch auszeichnet,
dass es viele HDMI-Eingänge hat.
Es gibt eine eiserne Regel, das Gerät nicht mit dem Internet zu verbinden – egal wie doll es darum bittet.
Es darf sich keinesfalls irgendwie Updaten oder Anmelden können, denn es funktioniert gut!&lt;/p&gt;
&lt;p&gt;Am Gerät hängen der besagte Mini, die Decoderbox und ein Steamlink.
Das Steamlink ersetzt die Google Chromecast, die ja durch die Werbeinvasion auf Youtube unbenutzbar geworden ist.&lt;/p&gt;
&lt;h1 id=&#34;abnormal&#34;&gt;
    &lt;a href=&#34;#abnormal&#34;&gt;
	Abnormal
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;Und so kommt es, dass ich hier jetzt knapp 25 Jahre Werbefrei und Nichtlinear bin.&lt;/p&gt;
&lt;p&gt;Laut Studie definitiv abnormal.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Immich</title>
      <link>https://blog.koehntopp.info/2024/10/14/immich.html</link>
      <pubDate>Mon, 14 Oct 2024 04:05:06 +0000</pubDate><author>kris-blog@koehntopp.de (Kristian Köhntopp)</author>

      <guid>https://blog.koehntopp.info/2024/10/14/immich.html</guid>
      <description>&lt;p&gt;&lt;a href=&#34;https://immich.app&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Immich&lt;/a&gt;

 is a web application for self-hosting that emulates the Google Photos interface on the web,
and that has Android and iOS Cellphone applications for automatic upload and photo management.
It also features metadata storage, machine learning for face recognition and object labeling.&lt;/p&gt;
&lt;h1 id=&#34;podman-composeyml&#34;&gt;
    &lt;a href=&#34;#podman-composeyml&#34;&gt;
	&lt;code&gt;podman-compose.yml&lt;/code&gt;
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;I am running Immich on my local server, using Rootless Podman, with the following &lt;code&gt;podman-compose.yml&lt;/code&gt; file,
which exposes port 3001.&lt;/p&gt;
&lt;p&gt;Using Rootless Podman means creating a user &lt;code&gt;immich:immich&lt;/code&gt;, putting the &lt;code&gt;podman-compose.yml&lt;/code&gt; into
the &lt;code&gt;/home/immich&lt;/code&gt; directory and ending up with the image data in &lt;code&gt;/home/immich/library&lt;/code&gt; plus a
&lt;code&gt;/home/immich/postgres&lt;/code&gt; directory for the metadata database.&lt;/p&gt;
&lt;p&gt;Podman stores images in &lt;code&gt;/home/immich/.local&lt;/code&gt;.&lt;/p&gt;
&lt;details class=&#34;reveal&#34;&gt;
	&lt;summary class=&#34;reveal&#34;&gt;podman-compose.yml&lt;/summary&gt;
	&lt;div class=&#34;reveal&#34;&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;immich&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;services&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;immich-server&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;container_name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;immich_server&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;image&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;ghcr.io/immich-app/immich-server:${IMMICH_VERSION:-release}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# extends:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;#   file: hwaccel.transcoding.yml&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;#   service: cpu # set to one of [nvenc, quicksync, rkmpp, vaapi, vaapi-wsl] for accelerated transcoding&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;volumes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# Do not edit the next line. If you want to change the media storage location on your system, edit the value of UPLOAD_LOCATION in the .env file&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;${UPLOAD_LOCATION}:/usr/src/app/upload&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;/etc/localtime:/etc/localtime:ro&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;env_file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;.env&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;ports&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;- &lt;span class=&#34;m&#34;&gt;3001&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;3001&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;depends_on&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;redis&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;database&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;restart&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;always&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;healthcheck&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;disable&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;immich-machine-learning&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;container_name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;immich_machine_learning&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# For hardware acceleration, add one of -[armnn, cuda, openvino] to the image tag.&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# Example tag: ${IMMICH_VERSION:-release}-cuda&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;image&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;ghcr.io/immich-app/immich-machine-learning:${IMMICH_VERSION:-release}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# extends: # uncomment this section for hardware acceleration - see https://immich.app/docs/features/ml-hardware-acceleration&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;#   file: hwaccel.ml.yml&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;#   service: cpu # set to one of [armnn, cuda, openvino, openvino-wsl] for accelerated inference - use the `-wsl` version for WSL2 where applicable&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;volumes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;model-cache:/cache&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;env_file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;.env&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;restart&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;always&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;healthcheck&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;disable&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;redis&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;container_name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;immich_redis&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;image&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;docker.io/redis:6.2-alpine@sha256:2d1463258f2764328496376f5d965f20c6a67f66ea2b06dc42af351f75248792&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;healthcheck&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;test&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;redis-cli ping || exit 1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;restart&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;always&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;database&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;container_name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;immich_postgres&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;image&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;docker.io/tensorchord/pgvecto-rs:pg14-v0.2.0@sha256:90724186f0a3517cf6914295b5ab410db9ce23190a2d9d0b9dd6463e3fa298f0&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;environment&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;POSTGRES_PASSWORD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;${DB_PASSWORD}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;POSTGRES_USER&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;${DB_USERNAME}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;POSTGRES_DB&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;${DB_DATABASE_NAME}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;POSTGRES_INITDB_ARGS&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;--data-checksums&amp;#39;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;volumes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# Do not edit the next line. If you want to change the database storage location on your system, edit the value of DB_DATA_LOCATION in the .env file&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;${DB_DATA_LOCATION}:/var/lib/postgresql/data&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;healthcheck&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;test&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;pg_isready --dbname=&amp;#39;${DB_DATABASE_NAME}&amp;#39; --username=&amp;#39;${DB_USERNAME}&amp;#39; || exit 1; Chksum=&amp;#34;$$(psql --dbname=&amp;#39;${DB_DATABASE_NAME}&amp;#39; --username=&amp;#39;${DB_USERNAME}&amp;#39; --tuples-only --no-align --command=&amp;#39;SELECT COALESCE(SUM(checksum_failures), 0) FROM pg_stat_database&amp;#39;)&amp;#34;; echo &amp;#34;checksum failure count is $$Chksum&amp;#34;; [ &amp;#34;$$Chksum&amp;#34; = &amp;#39;0&amp;#39; ] || exit 1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;interval&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;5m&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;start_interval&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;30s&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;start_period&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;5m&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;command&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;postgres&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;-c&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;shared_preload_libraries=vectors.so&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;-c&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;search_path=&amp;#34;$$user&amp;#34;, public, vectors&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;-c&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;logging_collector=on&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;-c&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;max_wal_size=2GB&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;-c&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;shared_buffers=512MB&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;-c&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;wal_compression=on&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;restart&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;always&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;volumes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;model-cache&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/details&gt;

&lt;h1 id=&#34;env&#34;&gt;
    &lt;a href=&#34;#env&#34;&gt;
	&lt;code&gt;.env&lt;/code&gt;
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;The &lt;code&gt;.env&lt;/code&gt; file the &lt;code&gt;podman-compose.yml&lt;/code&gt; above depends on is just the default.&lt;/p&gt;
&lt;details class=&#34;reveal&#34;&gt;
	&lt;summary class=&#34;reveal&#34;&gt;.env&lt;/summary&gt;
	&lt;div class=&#34;reveal&#34;&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c&#34;&gt;# You can find documentation for all the supported env variables at https://immich.app/docs/install/environment-variables&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# The location where your uploaded files are stored&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;l&#34;&gt;UPLOAD_LOCATION=./library&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# The location where your database files are stored&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;l&#34;&gt;DB_DATA_LOCATION=./postgres&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# To set a timezone, uncomment the next line and change Etc/UTC to a TZ identifier from this list: https://en.wikipedia.org/wiki/List_of_tz_database_time_zones#List&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;l&#34;&gt;TZ=Europe/Amsterdam&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# The Immich version to use. You can pin this to a specific version like &amp;#34;v1.71.0&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;l&#34;&gt;IMMICH_VERSION=release&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# Connection secret for postgres. You should change it to a random password&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# Please use only the characters `A-Za-z0-9`, without special characters or spaces&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;l&#34;&gt;DB_PASSWORD=secret&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# The values below this line do not need to be changed&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;###################################################################################&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;l&#34;&gt;DB_USERNAME=postgres&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;l&#34;&gt;DB_DATABASE_NAME=immich&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/details&gt;

&lt;h1 id=&#34;reverse-proxy&#34;&gt;
    &lt;a href=&#34;#reverse-proxy&#34;&gt;
	Reverse Proxy
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;I am using an Apache Webserver with a reverse proxy for the TLS-site to port 3001.&lt;/p&gt;
&lt;details class=&#34;reveal&#34;&gt;
	&lt;summary class=&#34;reveal&#34;&gt;Apache Config Macro&lt;/summary&gt;
	&lt;div class=&#34;reveal&#34;&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-apacheconf&#34; data-lang=&#34;apacheconf&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c&#34;&gt;# autogenerated by /usr/local/bin/deploy, overwritten on next run.&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;Use&lt;/span&gt; ProxyVHost immich.home.koehntopp.de &lt;span class=&#34;m&#34;&gt;3301&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c&#34;&gt;# vim: syntax=apache ts=4 sw=4 sts=4 sr noet&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/details&gt;

&lt;p&gt;with the macro &lt;code&gt;ProxyVHost&lt;/code&gt;:&lt;/p&gt;
&lt;details class=&#34;reveal&#34;&gt;
	&lt;summary class=&#34;reveal&#34;&gt;Macro ProxyVHost&lt;/summary&gt;
	&lt;div class=&#34;reveal&#34;&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-apacheconf&#34; data-lang=&#34;apacheconf&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;&amp;lt;Macro&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;ProxyVHost $host $toport&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nt&#34;&gt;&amp;lt;VirtualHost&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;*:80&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nb&#34;&gt;ServerName&lt;/span&gt; $host
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nb&#34;&gt;ServerAdmin&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;user&lt;/span&gt;@example.com
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nb&#34;&gt;ErrorLog&lt;/span&gt; &lt;span class=&#34;sx&#34;&gt;/var/log/httpd/error-&lt;/span&gt;$host.log
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nb&#34;&gt;CustomLog&lt;/span&gt; &lt;span class=&#34;sx&#34;&gt;/var/log/httpd/access-&lt;/span&gt;$host.log combined
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nb&#34;&gt;RewriteEngine&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;On&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nb&#34;&gt;RewriteRule&lt;/span&gt; ^(.*)$ https://%{HTTP_HOST}$1 [R=301,L]
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nt&#34;&gt;&amp;lt;/VirtualHost&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nt&#34;&gt;&amp;lt;VirtualHost&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;*:443&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nb&#34;&gt;ServerName&lt;/span&gt; $host
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nb&#34;&gt;ServerAdmin&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;user&lt;/span&gt;@example.com
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nb&#34;&gt;ErrorLog&lt;/span&gt; &lt;span class=&#34;sx&#34;&gt;/var/log/httpd/error-&lt;/span&gt;$host.log
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nb&#34;&gt;CustomLog&lt;/span&gt; &lt;span class=&#34;sx&#34;&gt;/var/log/httpd/access-&lt;/span&gt;$host.log combined
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nb&#34;&gt;SSLEngine&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;on&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nb&#34;&gt;ProxyPreserveHost&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;On&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nb&#34;&gt;ProxyPass&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;/&amp;#34;&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;http://127.0.0.1:$toport/&amp;#34;&lt;/span&gt; nocanon
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nb&#34;&gt;ProxyPassReverse&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;/&amp;#34;&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;http://127.0.0.1:$toport/&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nb&#34;&gt;RequestHeader&lt;/span&gt; set X-Forwarded-Proto %{REQUEST_SCHEME}s
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nb&#34;&gt;RequestHeader&lt;/span&gt; set X-Forwarded-For %{REMOTE_ADDR}s
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nb&#34;&gt;RequestHeader&lt;/span&gt; set X-Real-IP %{REMOTE_ADDR}s
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nb&#34;&gt;AllowEncodedSlashes&lt;/span&gt; NoDecode
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nt&#34;&gt;&amp;lt;/VirtualHost&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;&amp;lt;/Macro&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/details&gt;

&lt;p&gt;After that, I installed &lt;code&gt;brew install immich-cli&lt;/code&gt; (there is also &lt;code&gt;immich-go&lt;/code&gt;) as a command line interface,
and imported my existing local PhotoLibrary.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://apps.apple.com/us/app/immich/id1613945652&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Immich&lt;/a&gt;

 on the iOS App Store&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://play.google.com/store/apps/details?id=app.alextran.immich&amp;amp;hl=en&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Immich&lt;/a&gt;

 on the Google Play Store&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>Cloud Cost vs. On-Premises Cost</title>
      <link>https://blog.koehntopp.info/2024/09/30/cloud-cost-vs-on-premises-cost.html</link>
      <pubDate>Mon, 30 Sep 2024 04:05:06 +0000</pubDate><author>kris-blog@koehntopp.de (Kristian Köhntopp)</author>

      <guid>https://blog.koehntopp.info/2024/09/30/cloud-cost-vs-on-premises-cost.html</guid>
      <description>&lt;p&gt;Ich wurde gefragt:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Hast Du eine Idee, wie ich seriös die Kosten für Cloud, reguläres und selbst Hosting vergleichen kann?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Seriös nicht, weil das ein Problem mit mehreren Schichten ist und keine dieser Schichten irgendwie schön ist.&lt;/p&gt;
&lt;h1 id=&#34;rahmenbedingungen&#34;&gt;
    &lt;a href=&#34;#rahmenbedingungen&#34;&gt;
	Rahmenbedingungen
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;Der Haupttreiber bei der ganzen Sache ist die simple Tatsache, dass wir immer mehr Transistoren auf einen Chip bekommen.
Der Chip wird zwar nicht mehr schneller, weil bei circa 3 GHz Takt Dauerleistung Schluss ist,
aber weil die Strukturen immer noch kleiner werden bekommen wir immer mehr Cores und Cache.&lt;/p&gt;
&lt;p&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2024/09/01-cloud-on-prem.png&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Fortschritte bei der Chipentwicklung über Zeit.
Die y-Ache ist logarithmisch. Wir sehen, wie die Anzahl der Transistoren pro Chip ungebrochen hoch geht.
Circa 2005 haben wir jedoch ein Taktlimit erreicht – bei 3 GHz Dauertakt ist bei Silizium Schluss.
Die Performance pro Core geht noch durch Verlagerung gewisser Funktionen in Hardware
und effizientere Prozessor-Architekturen langsam weiter hoch.
Stattdessen steigt seit 2005 die Anzahl der Cores pro Chip an – die
Gewinne an Transistoren gehen also an mehr Cores, nicht in schnellere Cores.
Zugleich sinkt der Energieverbrauch pro Core, während der Energieverbrauch pro Chip bei 100-200W stagniert.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Und oft auch Features, die die meiste Zeit gar nicht gebraucht werden,
sodass Teile des Chips die meiste Zeit ausgeschaltet sind, um Energie zu sparen.
Denn Energieverbrauch erzeugt Abwärme, und die Abwärme setzt dem Chip ein (weiches) Leistungslimit.
Wenn wir also Dinge, die viel Energie verbrauchen (die FPU und die Vektoreinheiten) nicht verwenden,
dann können wir den Takt bei dem Teil des Chips, der benutzt wird hochdrehen,
und bekommen so ein wenig mehr Leistung für viel mehr Energieverbrauch und Abwärme.&lt;/p&gt;
&lt;p&gt;Prozessoren von 2024 haben auf einem Chip bis zu 128 oder gar 192 Cores und die doppelte Anzahl von vCores (Threads).&lt;/p&gt;
&lt;h1 id=&#34;hardwarekosten&#34;&gt;
    &lt;a href=&#34;#hardwarekosten&#34;&gt;
	Hardwarekosten
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;Gehen wir 5 Jahre zurück, kommen wir zu konkreten Kosten.&lt;/p&gt;
&lt;p&gt;Die kleinsten sinnvoll kaufbaren Intel Xeon CPUs von 2019 wären die
&lt;a href=&#34;https://www.intel.com/content/www/us/en/products/sku/123547/intel-xeon-silver-4110-processor-11m-cache-2-10-ghz/specifications.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Xeon Silver 4110&lt;/a&gt;


gewesen.
Auf einer typischen Blade von Dell oder HP gibt uns das 2 Sockets, 16 Cores mit 32 Hyperthreads,
128 GB RAM (8 GB RAM pro Core), eine lokale Micron 1.92 TB NVME mit 800k IOPS,
und einen dedizierten 10 GBit/s Port direkt zum Top-of-Rack Switch (luxuriöse 625 MBit/s pro Core).&lt;/p&gt;
&lt;p&gt;Was ist das für eine Rechnung?&lt;/p&gt;
&lt;p&gt;Ein System muss, damit es funktioniert, balanciert sein.
Manche Workloads sind selbst unbalanciert und brauchen exzessiv CPU oder exzessiv Speicher oder Netz.
Aber die meisten Enterprise-Anwendungen brauchen pro Core mit 3 GHz 4-8 GB RAM und 100-400 MBit/s Netz.
Wenn wir unsere Hardware so proportionieren, dann können wir recht sicher sein, dass sie vielseitig einsetzbar ist.&lt;/p&gt;
&lt;p&gt;Preislich kommen wir (die Umgebung, in der ich gearbeitet habe – Eure Preise können variieren)
mit solchen schwachbrüstigen Klein-Blades auf Kosten von etwa 120-150 Euro im Monat,
für eine geplante Lebensdauer von fünf Jahren. Das ist der Kaufpreis für die Blade,
Platz im Rechenzentrum und anteilig Strom, Netzwerk und Blade-Chassis.&lt;/p&gt;
&lt;p&gt;Die Blade ist dann noch nicht inventarisiert, noch nicht an,
nichts installiert ein Betriebssystem oder die Anwendung – das ist Arbeit, und die rechnen wir hier nicht mit rein.&lt;/p&gt;
&lt;h1 id=&#34;aws-kosten-im-vergleich&#34;&gt;
    &lt;a href=&#34;#aws-kosten-im-vergleich&#34;&gt;
	AWS Kosten im Vergleich
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;Wir können das mit einer AWS &lt;code&gt;m5.8xl&lt;/code&gt; vergleichen: 32 vCPU, 128 GB, 10 GBit/s und kein lokaler Speicher (EBS kostet extra).
Die kostet 1232 USD/Monat, also schmale 10x mehr, plus Netzwerk, plus EBS.&lt;/p&gt;
&lt;p&gt;Alternativ schauen wir auf eine AWS &lt;code&gt;i3.4xl&lt;/code&gt;: 16 vCPU, 122 GB Speicher, und zwei lokale 1.92 TB NVME,
sowie ein 10 GBit/s Link.
Die kostet 990 USD/Monat, plus Netz, aber wir haben zwei lokale Volumes.&lt;/p&gt;
&lt;p&gt;Anders als unsere Blade im Rechenzentrum ist diese VM bereits Teil einer gemanagten Umgebung,
wir können sie also provisionieren, und haben sie im Inventory.&lt;/p&gt;
&lt;p&gt;Anders als unsere Blade im Rechenzentrum ist diese VM auch eine VM, also ein Teil einer anderen, größeren CPU.
Die Silver 4110 ist eine weiche CPU: &lt;a href=&#34;https://en.wikichip.org/wiki/intel/xeon_silver/4110#Frequencies&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Unter Last geht ihr Takt runter&lt;/a&gt;

.
Größere CPUs sind je nach Auswahl auch oft härter,
sie kommen (zumindest bei &lt;code&gt;Normal&lt;/code&gt; Workloads) oft mit viel weniger Taktverlust.
Einige Hyperscaler, speziell AWS, lassen bei Intel besondere Typen nach Maß fertigen,
die nicht im normalen Portfolio für gewöhnliche Endkunden enthalten sind.
Sie haben einen festen Clock, also weder boosten sie, noch gehen sie unter Last runter,
und sie brauchen eine speziell gestaltete und genau spezifizierte Kühlung um das leisten.
Wenn man als einziger Kunde etwa die Hälfte der gesamten Jahresproduktion Xeons abnimmt bekommt man das.&lt;/p&gt;
&lt;h1 id=&#34;cloud-vs-baremetal-on-premises&#34;&gt;
    &lt;a href=&#34;#cloud-vs-baremetal-on-premises&#34;&gt;
	Cloud vs. Baremetal On-Premises
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;Ein früherer Arbeitgeber von mir hatte circa 50.000 von solchen Blades.
Die meisten davon waren die kleinen 4110, und einige größere Einheiten mit &lt;a href=&#34;https://ark.intel.com/content/www/us/en/ark/products/123541/intel-xeon-gold-6132-processor-19-25m-cache-2-60-ghz.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Dual Gold 6132&lt;/a&gt;

 an drei Standorten.
In Summe mag das auf etwa 1.000.000 Cores kommen, und dazu passend ausbalanciert Speicher.&lt;/p&gt;
&lt;p&gt;Bei diesem Arbeitgeber hat man um 2010 herum angefangen, Software zu schreiben, um diese Hardware zu verwalten,
automatisch zu provisionieren und Betriebssystem-Images und Anwendungen automatisch zu verteilen.
Ich kann mir also ein Script schreiben, das 200 Blades vom Typ x in RZ y anfordert.
Ich bekomme diese dann binnen 20 Minuten automatisch provisioniert, meiner Team-Abrechnung belastet,
und mit Partitionierung, Betriebssystem und Puppet-Klassen laufend zugewiesen.
Die ssh-Keys meines Teams erlauben mir einen Zugriff.&lt;/p&gt;
&lt;p&gt;In 2019 waren wir soweit, dass kein Rechner eine Uptime von mehr als 90 Tagen hatte.
Das heißt, alle Teams hatten ihre Software so verpackt,
dass sie vollkommen ohne manuelle Eingriffe installiert werden konnte,
keine Single Points of Failures existierten und alle produktiven Maschinen reihum reinstalliert werden konnten.
Dadurch haben wir Betriebssystem-Images und Anwendungen laufend neu deployed und aktuell gehalten.&lt;/p&gt;
&lt;p&gt;Automatisierung hat natürlich auch vorher schon funktioniert,
aber für die Vollautomatisierung war Arbeit und Druck notwendig.
Ich habe in
&lt;a href=&#34;https://blog.koehntopp.info/2023/02/18/this-is-not-a-drill.html&#34;&gt;This is not a Drill, this is just Tuesday&lt;/a&gt;


ausführlicher dazu geschreiben.&lt;/p&gt;
&lt;p&gt;Jedenfalls war viel Arbeit und es waren viele Leute notwendig,
denn ein Produkt, das so etwas für die lokale Firma passend auf Bare Metal Hardware macht, kann man nicht kaufen,
und schon gar nicht herstellerunabhängig.
Man muss also auf die Kosten für Hardware noch die Kosten für die Entwicklung dieser Stücke Software drauf rechnen.&lt;/p&gt;
&lt;p&gt;Am Ende hat sich dieser Arbeitgeber dafür entscheiden, seine Installation in die Cloud zu verschieben,
weil Operations dann jemand anderes Problem sind.
Das geht natürlich nicht von heute auf morgen,
Und soweit ich weiß, betreibt man auch jetzt, 5 Jahre später,
noch on-premises und Cloud parallel, und bezahlt beides.&lt;/p&gt;
&lt;p&gt;Würde das Projekt abgeschlossen sein, wäre man theoretisch nicht nur das Core.Infrastructure Team los,
sondern auch das Staffing für dieses Team.
Denn Menschen zu finden,
die mit Hardware umgehen können und einen sinnvollen Operations Mindset haben wird zunehmend schwieriger.
Entsprechend war das für das Management ein totaler No-Brainer, selbst bei einem Kostenfaktor von 10x.&lt;/p&gt;
&lt;p&gt;Der Aufwand, solche Personen zu finden, zu halten und so zu steuern,
dass sie dann sinnvolle Automation bauen, ist groß.
Das sind nicht nur Geldkosten, sondern schlimmer, das ist auch kognitive Load auf der Organisation.&lt;/p&gt;
&lt;h1 id=&#34;es-wird-nicht-einfacher&#34;&gt;
    &lt;a href=&#34;#es-wird-nicht-einfacher&#34;&gt;
	Es wird nicht einfacher
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;Allgemeiner gesagt:
Damit Du in 2024 eine Firma haben kannst, die eigene Hardware am Start hat,
muss Deine Firma erst einmal eine Mindestgröße haben.&lt;/p&gt;
&lt;p&gt;Idealerweise kauft man aus Kostengründen immer die zweitgrößte Sorte Rechner, die zu haben ist.
Man kann das genau ausrechnen und dann ist es manchmal die zweitgrößte und manchmal die drittgrößte Sorte CPU,
die hergestellt wird, bei der der Bumms pro Dollar am besten ist.&lt;/p&gt;
&lt;p&gt;Das heißt, man hat dann etwas mit – sagen wir – 128 Cores pro Socket und Single Socket.
Bei 8 GB pro Core und 100-300 MBit/s pro Core landen wir bei
128 * 8 GB = 1024 GB = 1 TB RAM und bei 128 * 200 Mbit/s = 25600 MBit/s = 25 GBit/s.
Bei einer Dual Socket entsprechend das Doppelte,
also 2 TB RAM und 2x 25 GBit/s oder schlicht ein 100 GBit/s Interface (überprovisioniert, aber eventuell einfacher).&lt;/p&gt;
&lt;p&gt;Die typische Java-Anwendung kann man in der Regel so bis 8 Cores und 16 GB RAM skalieren,
danach haucht die JVM ihr Leben aus.
Wir haben also 16-32 Instanzen (Anwendungen) pro Socket.
Die meisten werden nicht am oberen Ende der Skala sein, also rechnen wir eher 50-100 Anwendungen pro Socket.&lt;/p&gt;
&lt;p&gt;Für viele Firmen ist also eine einzige Maschine schon zu groß.
Wir wollen aber aus Gründen der Verfügbarkeit nicht eine Maschine haben, sondern mindestens drei.&lt;/p&gt;
&lt;p&gt;Wenn eine solche Maschine aus welchen Gründen umfällt oder neu starten muss,
dann sind mal eben 100 Anwendungen offline – wir haben also ein Blast Radius Problem.&lt;/p&gt;
&lt;p&gt;Wir können dagegen in der Public Cloud VMs in der passenden Größe kaufen,
und weil der Cloud-Anbieter viele solcher Maschinen hat, wird jede unserer VMs &amp;ldquo;anti-affin&amp;rdquo; scheduled.
Das heißt, der Cloud-Anbieter versucht unsere Anwendungen über so viele Stücke Hardware als möglich zu verteilen,
und uns mit so vielen anderen Kunden als möglich auf einer Kiste zu hosten.
Wenn dann ein Stück Hardware umfällt, verliert jeder Kunde eine Instanz, aber nicht ein Kunde alle.&lt;/p&gt;
&lt;h1 id=&#34;on-premises-ist-auch-nicht-unabhängig&#34;&gt;
    &lt;a href=&#34;#on-premises-ist-auch-nicht-unabh%c3%a4ngig&#34;&gt;
	On-Premises ist auch nicht unabhängig
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;Zurück On-Premises: Wir müssen jetzt aus unserer Hardware Stücke in passender Größe schneiden,
um sie in Pods oder virtuelle Maschinen zu verwandeln.
Für virtuelle Maschinen haben wir die Wahl zwischen VMware und Openstack.
Es gibt noch andere Lösungen, aber für die finden wir in der Regel keine Menschen mit Kenntnissen zur Anstellung.
Wir haben also die Wahl zwischen lebenslanger Schuldknechtschaft zu Broadcom,
oder wir müssen 3 oder mehr Spezialisten einstellen, die dem Openstack hinterher wischen,
wenn es mal wieder die Windel voll gemacht hat.&lt;/p&gt;
&lt;p&gt;Nun können wir VMs provisionieren, aber wir müssen aus den VMs noch immer Dienste machen.
Dort wiederholt sich das Spiel von der VM-Ebene.
Am Ende haben wir eine unserer Firmengröße angemesene &amp;ldquo;Core Infra&amp;rdquo; Abteilung, die unsere On-Prem Cloud betreibt.
Das sind dann vielleicht keine 50.000 Maschinen mit zusammen 1.000.000 Cores mehr,
sondern nur noch 8000 Maschinen mit 1.000.000 Cores, aber es sind trotzdem 10-30 Leute, die dafür da sind,
darauf Services zu implementieren.&lt;/p&gt;
&lt;p&gt;Wir haben also die Wahl, erschreckend kostengünstige Hardware, die viel zu groß für alles ist, zu kaufen.
Dann müssen wir Leute finden und anzustellen.
Diese sind dann vielleicht in der Lage (oder vielleicht auch nicht), daraus eine brauchbare Plattform zu bauen.&lt;/p&gt;
&lt;p&gt;Alternativ können wir dem Bezos Kohle in den Rachen schaufeln.&lt;/p&gt;
&lt;p&gt;Die Antwort ist für wirklich jede Firma mit weniger als einer dreistelligen Anzahl von Rechnern absolut offensichtlich,
und besteht nicht darin, Hardware zu kaufen.
Das Staffing, die lokale Betriebs-Entwicklung und alles, was damit einhergeht, will sich niemand ans Bein binden.
Sobald man dann größer ist, ist es teuer, aber zu spät.&lt;/p&gt;
&lt;p&gt;Folgerichtig findet man auch immer weniger Leute, die sich mit solchem lokalen Betrieb auskennen,
und Dir so etwas bauen können.
Dagegen kannst Du Dich mit Leuten tot werfen, die Dir Instanzen bei AWS klicken und für 60k-75k im Jahr zu Dir kommen.&lt;/p&gt;
&lt;h1 id=&#34;die-ganze-logik-kaskade&#34;&gt;
    &lt;a href=&#34;#die-ganze-logik-kaskade&#34;&gt;
	Die ganze Logik-Kaskade
    &lt;/a&gt;
&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Wir haben zu viele Transistoren pro Chip.
Die Hersteller von Chips wissen nicht, was die damit tun sollen.
Du bekommst absurde Features, die nicht auf allen Chips gebraucht werden (KI-Inferenz,
dutzende FPUs und Vektoreinheiten) in den Performance-Cores, oder riesige Mengen Efficiency Cores pro Socket.
Im Consumer Bereich bekommst Du statt eines Computers ein System-on-a-Chip, bei dem Grafikbeschleuniger,
RAM, RAM-Controller und NVME-Controller mit auf der CPU sitzen, zusammen mit 4E+8P Cores oder ähnlich.&lt;/li&gt;
&lt;li&gt;Wir haben daher im Enterprise-Bereich viel zu viele Cores pro Socket (128+ Cores).&lt;/li&gt;
&lt;li&gt;Als Kunde habe ich dadurch das Problem, dass ich kein Bare Metal mehr fahren kann.
Ich brauche also K8s oder einen Hypervisor zum Kleinschneiden der Systeme in brauchbare Stücke.&lt;/li&gt;
&lt;li&gt;Als Kunde habe ich dann auch ein Blast-Radius Problem.
Wenn so ein großer Host umfällt, dann nimmt er die ganze Firma offline.&lt;/li&gt;
&lt;li&gt;Als Kunde will ich also eine VM auf vielen Hosts haben und auf einem Host mit vielen anderen Kunden cohosted werden.
Ich gehe also lieber zu einer Public Cloud und miete mir da die passenden VMs.&lt;/li&gt;
&lt;li&gt;Ich brauche dann auch keine Hardware-Kundigen mehr.&lt;/li&gt;
&lt;li&gt;Als Hoster von so etwas kann ich die Hardware veredeln und Operations übernehmen,
indem ich statt VMs Dienste &amp;ldquo;as-a-Service&amp;rdquo; verkaufe.&lt;/li&gt;
&lt;li&gt;Als Kunde kann ich so nicht nur meine Hardware-Kundigen los werden,
sondern für den Dienst x (jetzt xaaS) auch meine x-Kundigen.&lt;/li&gt;
&lt;li&gt;Als Kunde von so einem Anbieter habe ich nun reine Entwickler,
die in komplett abstrakten Layers Dinge zusammenstecken,
low-code und nahe an Business Problemen.&lt;/li&gt;
&lt;li&gt;Dadurch habe ich niemanden nirgendwo mehr, der auch nur einen Hauch einer Ahnung hat, was das alles bedeutet,
lastmäßig, und ob der getriebene Aufwand dem Problem angemessen ist.&lt;/li&gt;
&lt;li&gt;Ich kann solche Einschätzungen aber als Beratung einkaufen,
entweder von lokalen Drittanbieter-Consultants oder vom Hoster, als &amp;ldquo;Well-Architected&amp;rdquo; Beratung nach Schema F.&lt;/li&gt;
&lt;li&gt;Das Bruttosozialprodukt steigt, weil das ja jetzt alles Transaktionen mit Echtgeld zwischen Firmen sind,
statt Verrechnung mit Spielgeld innerhalb einer Firma.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Und am Ende spielen die Kosten im Vergleich keine Rolle mehr, weil andere, größere Vektoren auf die Firmen einwirken.&lt;/p&gt;
&lt;p&gt;Einer dieser Vektoren sind auch immer größere Regulierungsverpflichtungen,
die den Betrieb eigener Rechner On-Premises unmöglich machen,
weil eine ISO 27k, eine NIS-2 und eine PCI-Zertifizierung ja auch Aufwand und Geld kosten.
Kauft man dagegen eine vorab zertifizierte Cloudlösung hat man mindestens drei Viertel des Schmerzes nicht,
wird einem versprochen.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Werk und AI</title>
      <link>https://blog.koehntopp.info/2024/09/29/werk-und-ai.html</link>
      <pubDate>Sun, 29 Sep 2024 04:05:06 +0000</pubDate><author>kris-blog@koehntopp.de (Kristian Köhntopp)</author>

      <guid>https://blog.koehntopp.info/2024/09/29/werk-und-ai.html</guid>
      <description>&lt;p&gt;Jemand fragt im Kontext
&lt;a href=&#34;https://www.creativebloq.com/ai/ai-art/controversial-competition-winner-still-hopes-to-copyright-his-ai-art&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;People are &amp;ldquo;blatantly stealing my work,&amp;rdquo; AI artist complains&lt;/a&gt;

:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;What the hell is an &amp;ldquo;AI artist&amp;rdquo;&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;und das ist ziemlich kompliziert.&lt;/p&gt;
&lt;h1 id=&#34;werke-und-werkzeuge&#34;&gt;
    &lt;a href=&#34;#werke-und-werkzeuge&#34;&gt;
	Werke und Werkzeuge
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;Du kannst ein Bild auf Leinwand malen und dann ist es ein Werk und durch das Urheberrecht geschützt.&lt;/p&gt;
&lt;p&gt;Du kannst Midjourney oder DALL-E bitten, Dir ein Bild nach folgendem Prompt zu malen,
und dann ist es kein Werk und auch nicht durch das Urheberrecht geschützt, denn das Gesetz verlangt &amp;ldquo;human authorship&amp;rdquo;.&lt;/p&gt;
&lt;p&gt;Der Prompt, den der Künstler geschaffen hat, wäre geschützt,
denn das Urheberrecht schützt ausdrücklich auch &lt;a href=&#34;https://medien-wiki.de/kleine-muenze&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Kleine Münze&lt;/a&gt;

.&lt;/p&gt;
&lt;p&gt;Du kannst ein Bild in Photoshop malen oder ein Foto von Dir in Photoshop bearbeiten,
und das wäre durch das Urheberrecht geschützt.&lt;/p&gt;
&lt;p&gt;Du kannst dann Teile des Bildes manuell in Photoshop retuschieren,
und auch das wäre durch das Urheberrecht geschützt.&lt;/p&gt;
&lt;p&gt;Du kannst Teile des Bildes durch Photoshop mit AI Inpainting retuschieren lassen und das… ist unklar.&lt;/p&gt;
&lt;p&gt;Ab irgendeinem Punkt ist es kein Werk von einem Menschen mehr,
oder nur noch Ausschnitte des Werkes sind von einem Menschen gemacht.&lt;/p&gt;
&lt;p&gt;Es ist offen, und darum geht es in diesem Prozeß, ab wieviel menschlichem Anteil etwas ein Werk ist.
Und ob dann das Gesamtbild ein Werk ist, oder nur die Teile, die von einem Menschen gemacht sind.&lt;/p&gt;
&lt;h1 id=&#34;bildgebende-werkzeuge&#34;&gt;
    &lt;a href=&#34;#bildgebende-werkzeuge&#34;&gt;
	Bildgebende Werkzeuge
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;Es ist damit im Grunde auch offen, welche bildgebenden Werkzeuge, die durch einen Menschen benutzt werden,
ein menschliches Werk erzeugen und welche nicht.&lt;/p&gt;
&lt;p&gt;Fotos, also Bilder, die durch einen physikalischen Prozeß erzeugt werden, sind urheberrechtlich geschützt.&lt;/p&gt;
&lt;p&gt;Aber nur dann, wenn das Werkzeug durch einen Menschen bedient wird.
Ein
&lt;a href=&#34;https://www.stern.de/panorama/weltgeschehen/wie-das-beruehmte-affen-selfie-einen-fotografen-ruinierte--7561910.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;nichtmenschliches Foto&lt;/a&gt;


ist nicht geschützt.&lt;/p&gt;
&lt;p&gt;Also, es ist bisher unstrittig,
dass ein digitaler Pinsel oder ein digitaler Mustergenerator den Werkscharacter nicht in Frage stellen.&lt;/p&gt;
&lt;p&gt;Es ist zur Zeit aber auch unstrittig, dass DALL-E keine Werke produzieren kann.&lt;/p&gt;
&lt;p&gt;Es ist unstrittig,
dass ein Blur-Filter oder ein Solarisations-Filter auf einem Bild oder Teilen eines Bildes den Werkscharacter nicht in Frage stellt.&lt;/p&gt;
&lt;p&gt;Es ist vollkommen unklar, was ein Photoshop Inpainting,
das man prompted &amp;ldquo;Entferne den Menschen im markierten Gebiet&amp;rdquo; mit dem Werkscharacter eines Bildes macht.
Oder &amp;ldquo;Ersetze den Himmel in diesem Bild durch dramatische Sturmwolken&amp;rdquo; auf das ganze Bild
mit dem Werkscharacter eines Bildes macht.&lt;/p&gt;
&lt;p&gt;Offenbar ist das Recht derzeit der Ansicht, dass es irgendwo eine Grenze zwischen Werk und Nichtwerk gibt,
aber es ist absolut unklar, in Gesetz und Anwendung, wo diese liegt.&lt;/p&gt;
&lt;h1 id=&#34;auch-für-texte&#34;&gt;
    &lt;a href=&#34;#auch-f%c3%bcr-texte&#34;&gt;
	Auch für Texte
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;Dasselbe gilt auch für Texte:&lt;/p&gt;
&lt;p&gt;Du kannst ChatGPT bitten, &amp;ldquo;erzeuge mir eine Kurzgeschichte mit &amp;hellip;&amp;rdquo; und ChatGPT macht eine solche Kurzgeschichte.
Abgesehen davon, dass die langweilig ist, ist es auch nach aktuellem Recht kein Werk.&lt;/p&gt;
&lt;p&gt;Du kannst aber auch eine Reihe von Prompts schreiben, in denen Du mit ChatGPT eine Geschichte entwickelst,
indem Du interaktiv Szenario, Figuren, Konflikte und Arc generierst.
Du kannst nach diesen automatisch generierten Ideen eine Story schreiben – ein menschliches Werk?&lt;/p&gt;
&lt;p&gt;Du kannst aber auch in einer neuen Session mit ChatGPT eine Reihe von Prompts entlang des Arc einwerfen,
und den resultierenden Text in eine zusammenhängende Geschichte umbauen.
Kein menschliches Werk.&lt;/p&gt;
&lt;p&gt;Dann nimmst Du sowohl diesen Text als auch den ersten, selbst geschriebenen, kapitelweise,
bearbeitest jeden von denen ein wenig und pastest ihn wieder nach ChatGPT.
Der Prompt ist dabei die Bitte, die Rechtschreibung und Grammatik zu korrigieren,
sprachlich die folgenden Redewendungen zu vermeiden und den Text aggressiv im Stil von &amp;hellip; umzuformulieren.
Was davon ist ein Werk?&lt;/p&gt;
&lt;p&gt;Das Resultat ist etwas, das ChatGPT alleine nicht hätte erzeugen können,
es hat definitiv eine menschliche Komponente und eine große Menge menschliche Führung.
Selbst dann, wenn jedes Wort im sichtbaren Text von ChatGPT generiert ist.&lt;/p&gt;
&lt;p&gt;Die genaue Formulierung und der Stil der Sprache sind aber autogeneriert.
Ist das ein Werk?&lt;/p&gt;
&lt;p&gt;Wir wissen es nicht.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Details in Hugo</title>
      <link>https://blog.koehntopp.info/2024/09/28/details-in-hugo.html</link>
      <pubDate>Sat, 28 Sep 2024 04:05:06 +0000</pubDate><author>kris-blog@koehntopp.de (Kristian Köhntopp)</author>

      <guid>https://blog.koehntopp.info/2024/09/28/details-in-hugo.html</guid>
      <description>&lt;p&gt;Ich habe ja seit circa 2000 kein Frontend mehr gemacht.&lt;/p&gt;
&lt;h1 id=&#34;details-&#34;&gt;
    &lt;a href=&#34;#details-&#34;&gt;
	&lt;code&gt;&amp;lt;details /&amp;gt;&lt;/code&gt;
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;Heute habe ich also gelernt,
dass es ein &lt;a href=&#34;https://wiki.selfhtml.org/wiki/HTML/Elemente/details&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;code&gt;&amp;lt;details&amp;gt;&lt;/code&gt;&lt;/a&gt;

-Element gibt.
Das ist ein Element, das zusammengeklappt gerendert wird, und das man Aufklappen kann, um den Inhalt zu enthüllen.&lt;/p&gt;
&lt;p&gt;Der Teil von &lt;code&gt;&amp;lt;details&amp;gt;&lt;/code&gt;, der zusammengeklappt sichtbar ist, heißt &lt;a href=&#34;https://wiki.selfhtml.org/wiki/HTML/Elemente/summary&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;code&gt;&amp;lt;summary&amp;gt;&lt;/code&gt;&lt;/a&gt;

.&lt;/p&gt;
&lt;p&gt;Nach der Summary kann dann beliebig viel &amp;ldquo;flow-content&amp;rdquo; kommen, also ein oder mehr &lt;code&gt;&amp;lt;div&amp;gt;&lt;/code&gt; zum Beispiel.&lt;/p&gt;
&lt;h1 id=&#34;shortcodes&#34;&gt;
    &lt;a href=&#34;#shortcodes&#34;&gt;
	Shortcodes
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;Ich will das nun in Hugo nutzen können, ohne daß ich HTML tippen muss.
Dazu kann ich in Hugo einen Shortcode &lt;code&gt;reveal&lt;/code&gt; definieren, den ich dann als &lt;code&gt;{{&amp;lt; reveal &amp;gt;}}&lt;/code&gt; aufrufen kann.
Ein vordefinierter Shortcode, der hier im Blog laufend verwendet wird, ist zum Beispiel &lt;code&gt;{{&amp;lt; relref &amp;gt;}}&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Dazu lege ich &lt;code&gt;./layouts/shortcodes/reveal.html&lt;/code&gt; mit folgendem Inhalt an:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-html&#34; data-lang=&#34;html&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;details&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;reveal&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;summary&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;reveal&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;{{ .Get &amp;#34;question&amp;#34; }}&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;summary&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;reveal&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;{{ .Inner | markdownify }}&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;details&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;und verwende das in der Form&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-html&#34; data-lang=&#34;html&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;nt&#34;&gt;reveal&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;question&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Was ist los?&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;}}
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Nix.
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;reveal&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;}}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;mit dem Ergebnis:&lt;/p&gt;
&lt;details class=&#34;reveal&#34;&gt;
	&lt;summary class=&#34;reveal&#34;&gt;Was ist los?&lt;/summary&gt;
	&lt;div class=&#34;reveal&#34;&gt;Nix.&lt;/div&gt;
&lt;/details&gt;

&lt;p&gt;Dazu kommt noch Styling:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-css&#34; data-lang=&#34;css&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;reveal&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;k&#34;&gt;margin-bottom&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;em&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;err&#34;&gt;summary&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;cursor&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;pointer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;color&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;#3d80bb&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;padding&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.5&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;em&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;background-color&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;#f5f5f5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;margin-top&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.5&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;em&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;padding&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.5&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;em&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;background-color&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;#fafafa&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nt&#34;&gt;summary&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;nd&#34;&gt;hover&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;background-color&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;#e0e0e0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Auf diese Weise lassen sich lange optionale Inhalte rendern ohne den Artikel zu unübersichtlich zu machen.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>zigbee2mqtt in rootless podman</title>
      <link>https://blog.koehntopp.info/2024/09/03/zigbee2mqtt-in-rootless-podman.html</link>
      <pubDate>Tue, 03 Sep 2024 04:05:06 +0000</pubDate><author>kris-blog@koehntopp.de (Kristian Köhntopp)</author>

      <guid>https://blog.koehntopp.info/2024/09/03/zigbee2mqtt-in-rootless-podman.html</guid>
      <description>&lt;p&gt;I have a Zigbee Controller from Dresden Electronics, a Conbee II.
On a previous machine, I had been running this in a docker container using &lt;code&gt;zigbee2mqtt&lt;/code&gt;.
In parallel, &lt;code&gt;docker-compose&lt;/code&gt; also maintained a &lt;code&gt;mosquitto&lt;/code&gt;, an &lt;code&gt;influx 1.8&lt;/code&gt; and a &lt;code&gt;grafana&lt;/code&gt;
plus Home Assistant in a Container.&lt;/p&gt;
&lt;p&gt;For the new machine, I wanted to change the setup, with the biggest change being that I wanted to get rid of Docker.
This meant using Podman, and to make it interesting, using a rootless podman.&lt;/p&gt;
&lt;p&gt;Rootless podman creates and uses containers as a regular user.
I am creating a different user for every project, so I have accounts for Navidrome, Restic, Unifi and Vaultwarden.
I am complementing them with an account &lt;code&gt;hass&lt;/code&gt; for Home Assistant (the german noun &lt;em&gt;der Hass (m)&lt;/em&gt; means &lt;em&gt;hate&lt;/em&gt;).&lt;/p&gt;
&lt;h1 id=&#34;create-a-user-hass&#34;&gt;
    &lt;a href=&#34;#create-a-user-hass&#34;&gt;
	Create a user &lt;code&gt;hass&lt;/code&gt;
    &lt;/a&gt;
&lt;/h1&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; useradd -m -c &lt;span class=&#34;s2&#34;&gt;&amp;#34;Home Assistant Project User&amp;#34;&lt;/span&gt; hass
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; loginctl enable-linger hass
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; su - hass
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;I am dropping the existing volume &lt;code&gt;/export/hass&lt;/code&gt; into this location
&lt;code&gt;/home/hass&lt;/code&gt; to keep the history and config of everything,
and adjust a few pathnames.
This means my &lt;code&gt;z2m&lt;/code&gt; config is now in &lt;code&gt;/home/hass/z2m&lt;/code&gt;.&lt;/p&gt;
&lt;h1 id=&#34;error-enoent-no-such-file-or-directory-lstat-devttyacm0&#34;&gt;
    &lt;a href=&#34;#error-enoent-no-such-file-or-directory-lstat-devttyacm0&#34;&gt;
	Error: ENOENT: no such file or directory, lstat &amp;lsquo;/dev/ttyACM0&amp;rsquo;
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;Trying to run this in podman-compose fails, even after pathname correction.
This is because the device &lt;code&gt;/dev/ttyACM0&lt;/code&gt; is not accessible inside my container.&lt;/p&gt;
&lt;p&gt;Importing it seems somewhat complicated.
A simple &lt;code&gt;devices: &amp;quot;/dev/ttyACM0:/dev/ttyACM0&amp;quot;&lt;/code&gt; is not enough, because the &lt;code&gt;hass&lt;/code&gt; user can&amp;rsquo;t access the device.&lt;/p&gt;
&lt;p&gt;A lot of tutorials exist, and they all hint at a setup that supposedly looks like this:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Add the user &lt;code&gt;hass&lt;/code&gt; to the local group &lt;code&gt;dialout&lt;/code&gt; and logout, login again.
All &lt;code&gt;hass&lt;/code&gt;-owned processes are now also having the supplemental GID &lt;code&gt;18(hass)&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Make sure, the device &lt;code&gt;/dev/ttyACM0&lt;/code&gt;, your Zigbee Controller, is permissioned &lt;code&gt;root:dialout&lt;/code&gt; with &lt;code&gt;0660&lt;/code&gt;.
This is the default.&lt;/li&gt;
&lt;li&gt;Modify the container definition for &lt;code&gt;z2m&lt;/code&gt; to keep the supplemental group inside the container.&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;z2m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;image&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;koenkk/zigbee2mqtt&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;container_name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;z2m&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;hostname&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;z2m&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;group-add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;- &lt;span class=&#34;s2&#34;&gt;&amp;#34;keep-groups&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;devices&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;- &lt;span class=&#34;s2&#34;&gt;&amp;#34;/dev/ttyACM0:/dev/ttyACM0&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;volumes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;- &lt;span class=&#34;s2&#34;&gt;&amp;#34;/home/hass/z2m:/app/data&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;- &lt;span class=&#34;s2&#34;&gt;&amp;#34;/run/udev:/run/udev:ro&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;- &lt;span class=&#34;s2&#34;&gt;&amp;#34;/etc/localtime:/etc/localtime:ro&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;ports&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;- &lt;span class=&#34;m&#34;&gt;8082&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;8080&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;depends_on&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;- &lt;span class=&#34;s2&#34;&gt;&amp;#34;mosquitto&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;restart&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;unless-stopped&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;logging&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;driver&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;json-file&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;options&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;max-size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;200k&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;max-file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;5&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Variations of that exist.
They all aim to make the supplemental group available inside the container, and give the container access to the Device.&lt;/p&gt;
&lt;p&gt;All these attempts failed for me.&lt;/p&gt;
&lt;h1 id=&#34;not-using-supplemental-groups&#34;&gt;
    &lt;a href=&#34;#not-using-supplemental-groups&#34;&gt;
	Not using supplemental groups
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;My approach differs.&lt;/p&gt;
&lt;p&gt;I want a device &lt;code&gt;/dev/ttyHASS0&lt;/code&gt; that has the right device numbers and permissions, owned by &lt;code&gt;hass:hass&lt;/code&gt;.
Making that device and then importing it into the container should suffice.
I should not have to do the supplemental group dance in the first place.&lt;/p&gt;
&lt;h2 id=&#34;create-a-new-device-node-owned-by-hass&#34;&gt;
    &lt;a href=&#34;#create-a-new-device-node-owned-by-hass&#34;&gt;
	Create a new device node owned by &lt;code&gt;hass&lt;/code&gt;
    &lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;I created a script &lt;code&gt;/root/bin/create_ttyhass.sh&lt;/code&gt;.
This needed to be a script, chained commands inside an &lt;code&gt;udev&lt;/code&gt; rule did not work.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; ls -l /dev/ttyACM0
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;crw-rw---- 1 root dialout 166, 0 Sep  3 11:08 /dev/ttyACM0
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; cat /root/bin/create_ttyhass.sh
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt;! /bin/bash --
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;if [ ! -e /dev/ttyHASS0 ]; then
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;    /bin/mknod /dev/ttyHASS0 c 166 0
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;    /bin/chown hass:hass /dev/ttyHASS0
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;    /bin/chmod 0660 /dev/ttyHASS0
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;fi
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; ls -l /root/bin/create_ttyhass.sh
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;-rwxr-xr-x 1 root root 162 Sep  3 10:42 /root/bin/create_ttyhass.sh
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;create-a-device-rule-that-triggers-the-script&#34;&gt;
    &lt;a href=&#34;#create-a-device-rule-that-triggers-the-script&#34;&gt;
	Create a device rule that triggers the script
    &lt;/a&gt;
&lt;/h2&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; lsusb &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; grep -i dresd
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Bus 001 Device 077: ID 1cf1:0030 Dresden Elektronik ZigBee gateway [ConBee II]
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; cat /etc/udev/rules.d/99-usb-dresden-electronics.rules
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;SUBSYSTEM==&amp;#34;tty&amp;#34;, ATTRS{idVendor}==&amp;#34;1cf1&amp;#34;, ATTRS{idProduct}==&amp;#34;0030&amp;#34;, ATTRS{serial}==&amp;#34;DE2197315&amp;#34;, RUN+=&amp;#34;/root/bin/create_ttyhass.sh&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; udevadm control --reload-rules&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; sleep 3&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; udevadm trigger
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; ls -l /dev/tty&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;A-Z&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;*
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;crw-rw---- 1 root dialout 166,  0 Sep  3 11:08 /dev/ttyACM0
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;crw-rw---- 1 hass hass    166,  0 Sep  3 11:44 /dev/ttyHASS0
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;crw-rw---- 1 root dialout   4, 64 Sep  3 10:43 /dev/ttyS0
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;crw-rw---- 1 root dialout   4, 65 Sep  3 10:43 /dev/ttyS1
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;crw-rw---- 1 root dialout   4, 66 Sep  3 10:43 /dev/ttyS2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;crw-rw---- 1 root dialout   4, 67 Sep  3 10:43 /dev/ttyS3
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;udev&lt;/code&gt; is slow, the &lt;code&gt;sleep&lt;/code&gt; is actually helpful.
As we can see, a &lt;code&gt;/dev/ttyHASS0&lt;/code&gt; owned by &lt;code&gt;hass:hass&lt;/code&gt; with proper permissions now exists.&lt;/p&gt;
&lt;h2 id=&#34;adjusting-configurationyaml&#34;&gt;
    &lt;a href=&#34;#adjusting-configurationyaml&#34;&gt;
	Adjusting &lt;code&gt;configuration.yaml&lt;/code&gt;
    &lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;I then changed &lt;code&gt;~hass/z2m/configuration.yaml&lt;/code&gt; to match.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;homeassistant&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;discovery_topic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;homeassistant&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;permit_join&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;mqtt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;base_topic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;zigbee2mqtt&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;server&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;mqtt://mosquitto/&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;serial&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;/dev/ttyHASS0&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;adapter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;deconz&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;frontend&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;8080&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;devices&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nn&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The &lt;code&gt;serial: adapter: deconz&lt;/code&gt; thing was actually necessary for this to work with a Conbee II.
Otherwise the script dies with an obscure error message.
What actually happens is that &lt;code&gt;z2m&lt;/code&gt; tries to push a firmware onto the device and fails, then dies.
The &lt;code&gt;deconz&lt;/code&gt; declaration prevents that.&lt;/p&gt;
&lt;p&gt;My setup now runs flawlessly without privileges,
but also without any supplemental group dances.&lt;/p&gt;
&lt;h2 id=&#34;the-working-rootless-podman-composeyaml&#34;&gt;
    &lt;a href=&#34;#the-working-rootless-podman-composeyaml&#34;&gt;
	The working rootless &lt;code&gt;podman-compose.yaml&lt;/code&gt;
    &lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;This is the &lt;code&gt;z2m&lt;/code&gt; section that actually makes it work, using the &lt;code&gt;udev&lt;/code&gt; entry from above.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;z2m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;image&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;koenkk/zigbee2mqtt&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;container_name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;z2m&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;hostname&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;z2m&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;user&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;devices&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;- &lt;span class=&#34;s2&#34;&gt;&amp;#34;/dev/ttyHASS0:/dev/ttyHASS0&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;volumes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;- &lt;span class=&#34;s2&#34;&gt;&amp;#34;/home/hass/z2m:/app/data&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;- &lt;span class=&#34;s2&#34;&gt;&amp;#34;/run/udev:/run/udev:ro&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;- &lt;span class=&#34;s2&#34;&gt;&amp;#34;/etc/localtime:/etc/localtime:ro&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;ports&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;- &lt;span class=&#34;m&#34;&gt;8082&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;8080&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;depends_on&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;- &lt;span class=&#34;s2&#34;&gt;&amp;#34;mosquitto&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;restart&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;unless-stopped&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;logging&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;driver&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;json-file&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;options&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;max-size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;200k&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;max-file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;5&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;this-is-how-unix-works&#34;&gt;
    &lt;a href=&#34;#this-is-how-unix-works&#34;&gt;
	This is how Unix works
    &lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;In Unix, a device is a &lt;code&gt;c&lt;/code&gt; (character) or &lt;code&gt;b&lt;/code&gt; (block) special file.
A character special file does not use the file system buffer cache and can do only blocked I/O.
A block special file does use the file system buffer cache and can do arbitrary character I/O.&lt;/p&gt;
&lt;p&gt;The actual driver is specified by the major and minor device numbers, here &lt;code&gt;166:0&lt;/code&gt;.
It does not matter where the device file is, having it in &lt;code&gt;/dev&lt;/code&gt; is just a convention.
It does not matter what the device name is, or if it is the only device file for that driver.&lt;/p&gt;
&lt;p&gt;In my case,
making a second device entry with the appropriate permissions completely removed the need for any supplemental group ids.
This greatly simplifies the problem that &lt;code&gt;podman-compose&lt;/code&gt; has to solve.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>MySQL: Upgrading old MySQL instances</title>
      <link>https://blog.koehntopp.info/2024/07/23/mysql-upgrading-old-mysql-instances.html</link>
      <pubDate>Tue, 23 Jul 2024 05:06:07 +0000</pubDate><author>kris-blog@koehntopp.de (Kristian Köhntopp)</author>

      <guid>https://blog.koehntopp.info/2024/07/23/mysql-upgrading-old-mysql-instances.html</guid>
      <description>&lt;blockquote&gt;
&lt;p&gt;Dear Kris,&lt;/p&gt;
&lt;p&gt;We have a number of old MySQL instances, version 5.5 and 5.6.
We want to upgrade them to a current version of MySQL.
The databases are between 0.5 TB to 8 TB in size.&lt;/p&gt;
&lt;p&gt;Unfortunately, using rsync on a stopped MySQL instance is not an option because the versions are too different,
and the new version seems unable to read the binary data.
I could use a dump (multi-threaded), but importing a single file with mysql takes forever
(it would need to be single-threaded).&lt;/p&gt;
&lt;p&gt;Would you simply create a dump per table and then import them in parallel?
Or has MySQL improved, allowing for better import methods now?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;That is a lot to unpack.&lt;/p&gt;
&lt;h1 id=&#34;a-consistent-backup-and-a-binlog-position&#34;&gt;
    &lt;a href=&#34;#a-consistent-backup-and-a-binlog-position&#34;&gt;
	A consistent backup and a binlog position
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;First off, a backup needs to be consistent.
You cannot make a backup of individual tables, one after the other, and expect the target database to be consistent.
A backup is a backup of all tables referencing each other, at a known binlog position.
Only then a clean cut-over can be done.&lt;/p&gt;
&lt;p&gt;We are discussing the why and how in
&lt;a href=&#34;https://blog.koehntopp.info/2020/11/27/backups-and-replication.html&#34;&gt;Backups and Replication&lt;/a&gt;

.&lt;/p&gt;
&lt;p&gt;We are discussing the proper &lt;code&gt;mysqldump&lt;/code&gt; options in
&lt;a href=&#34;https://blog.koehntopp.info/2023/01/03/mysql-ways-to-run-mysqldump.html&#34;&gt;Ways to run mysqldump&lt;/a&gt;

.&lt;/p&gt;
&lt;p&gt;There are now other, better ways to dump the database, using &lt;code&gt;mysqlsh&lt;/code&gt;.
This also provides facilities for parallel import.
See
&lt;a href=&#34;https://dev.mysql.com/doc/mysql-shell/8.4/en/mysql-shell-utilities-parallel-table.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Parallel Table Import Utility&lt;/a&gt;

.
I have never tested that at scale.
According to the documentation, you need to be at MySQL 5.7 or later for the data source for this to work:
&lt;a href=&#34;https://dev.mysql.com/doc/mysql-shell/8.4/en/mysql-shell-utilities-dump-instance-schema.html#mysql-shell-utilities-dump-opt-requirements&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Schema Dump Utility: Requirements and Restrictions&lt;/a&gt;

.&lt;/p&gt;
&lt;p&gt;That makes it a non-option for the original ask, and we are limited to traditional options for the task.&lt;/p&gt;
&lt;h1 id=&#34;upgrading-in-place&#34;&gt;
    &lt;a href=&#34;#upgrading-in-place&#34;&gt;
	Upgrading in place
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;MySQL&amp;rsquo;s data files have a defined format that is independent of the various operating system facilities,
and from the way the hardware represents certain data types.
It will not change inside one stable major version (except MySQL 8.0,
and that turned out a major source of downtime and problems for a deployment I was in charge of).&lt;/p&gt;
&lt;p&gt;An upgrade of libc that changes collations will not affect MySQL indexes,
because MySQL does not use operating system collations.
It defines its own – they are faster, stable across OS vendors, libc upgrades and other changes, and they are immutable.
A collation, even if faulty, will never change.
To fix bugs, a new collation with a new name will be created.
This has not always been the case, and that is a long and sad story.
Read about it in
&lt;a href=&#34;https://blog.koehntopp.info/2022/01/12/utf8mb4.html&#34;&gt;UTF8MB4&lt;/a&gt;

.&lt;/p&gt;
&lt;p&gt;MySQL does support upgrading binary data files,
but does so only one version step at a time from one major stable version to the next.&lt;/p&gt;
&lt;p&gt;That is, you can safely go from&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;5.5 to 5.6&lt;/li&gt;
&lt;li&gt;5.6 to 5.7&lt;/li&gt;
&lt;li&gt;5.7 to 8.0&lt;/li&gt;
&lt;li&gt;8.0 to 8.4&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;and specifically from the latest version of the OLD major version to the latest version of the new major version.
To go from 5.5 to 8.4, first upgrade to the latest 5.5 build.
Then go to 5.6, 5.7, 8.0 and 8.4 using the respective latest versions of each.
Use the version-specific upgrade process as documented in the manual,
and test each upgrade before proceeding to the next.&lt;/p&gt;
&lt;p&gt;MySQL 8.1, 8.2 and 8.3 have been innovation releases and are not &amp;ldquo;major stable versions&amp;rdquo;.
So is MySQL 9.0.
Don&amp;rsquo;t use any of them in production.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;Note on Non-GA Versions of MySQL:&lt;/strong&gt;
It is useful to run new versions of MySQL and innovation releases as replicas &lt;em&gt;for testing&lt;/em&gt; in production.
Doing this helps you to stay on top of current developments and get familiar with new features and quirks early.&lt;/p&gt;
&lt;p&gt;An idle replica will check your write-transactions, using SBR.
If you feel adventurous, divert a minimal amount of read-transactions to it from the database load balancer to
check how reads perform.&lt;/p&gt;
&lt;p&gt;Do not use 8.1, 8.2, 8.3 or 9.0 in a productive context or for a primary.
They are called &amp;ldquo;Innovation Releases&amp;rdquo; for a reason.&lt;/p&gt;
&lt;p&gt;Do use them to experiment and innovate, in a safe way.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;Note on SBR in MySQL replication:&lt;/strong&gt;
SBR has a lot of limitations and quirks, but it does transport original SQL to a replica.
It is useful to test write-transactions on a replica.&lt;/p&gt;
&lt;p&gt;It is not recommended to use SBR in production replication. Use RBR or group-replication.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Upgrading in place changes the on-disk format of the database,
the valid syntax of some queries you may use, and the behavior of some data types.
It is a tricky thing and usually requires more than one attempt to get right.&lt;/p&gt;
&lt;p&gt;Thus, it is very much recommended you create a new instance from a valid backup,
and make this instance a replica of the primary, old server.&lt;/p&gt;
&lt;p&gt;You then stop the replica, perform the upgrade as outlined in the relevant manual
(and the procedure&amp;rsquo;s details change from version to version,
because each major version does have other special concerns),
and then try to restart the replica.&lt;/p&gt;
&lt;p&gt;If that works, divert a bit of read-load to the replica to see if your queries are still valid SQL under the new version.
If you are confident everything works, you can point the writes from the primary to the replica and be done with it.&lt;/p&gt;
&lt;p&gt;Continue with the next version until done.
This sounds tedious, and it is.
Especially if you have put off upgrading.
Don&amp;rsquo;t do that, upgrade early (at least one replica), and it will hurt a lot less.&lt;/p&gt;
&lt;h1 id=&#34;reading-a-dump&#34;&gt;
    &lt;a href=&#34;#reading-a-dump&#34;&gt;
	Reading a dump
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;On disk, a database is a collection of files that represent the actual data in the database,
plus additional structures for quick access, the indexes.
A dump will create a representation of the data in the database in SQL syntax.
The index definitions are also generated, but the actual indexes are not part of the dump.&lt;/p&gt;
&lt;p&gt;On reading the dump, the new database instance has to read and parse the SQL.
While this is not as fast as loading binary data, it is usually not a bottleneck.
The MySQL SQL parser is quite fast.&lt;/p&gt;
&lt;p&gt;What takes time is the recreation of the indexes after reading a table.
To do that, the database will have to extract the indexed columns from the table by reading through the table,
and sort them.
It will then write out the index as tuples
that contain the indexed columns and a copy of the primary key as a pointer to the full row,
in sorted order.&lt;/p&gt;
&lt;p&gt;Sorting the data in index order is what takes time and potentially a lot of memory.
If you do not have enough memory, sorting is done in &amp;ldquo;runs&amp;rdquo;, with intermediate results on disk,
and a merge sort to build the final version of the index.
The full process is documented in
&lt;a href=&#34;https://dev.mysql.com/doc/refman/8.4/en/sorted-index-builds.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Sorted Index Builds&lt;/a&gt;

.&lt;/p&gt;
&lt;p&gt;Run size is controlled by the variable
&lt;a href=&#34;https://dev.mysql.com/doc/refman/8.4/en/innodb-parameters.html#sysvar_innodb_sort_buffer_size&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;innodb_sort_buffer_size&lt;/a&gt;

.
Note that this is different from
&lt;a href=&#34;https://dev.mysql.com/doc/refman/8.4/en/server-system-variables.html#sysvar_sort_buffer_size&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;sort_buffer_size&lt;/a&gt;


(a variable used in ORDER BY optimization, but not in InnoDB bulk index builds).&lt;/p&gt;
&lt;h1 id=&#34;beheading&#34;&gt;
    &lt;a href=&#34;#beheading&#34;&gt;
	Beheading
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;No matter what you do, you can upgrade the database using replicas with minimal operations impact and downtime.&lt;/p&gt;
&lt;p&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2024/07/upgrade-01.png&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/p&gt;
&lt;p&gt;&lt;em&gt;A database client writes to a MySQL 5.5 primary, and reads from a MySQL 5.5.
replica.
An additional replica for upgrades has been created from a backup. It is also MySQL 5.5.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2024/07/upgrade-02.png&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/p&gt;
&lt;p&gt;&lt;em&gt;The additional replica has been upgraded to MYSQL 5.6,
following the upgrade procedure for this specific version in the manual.
If the replication keeps up, it means the SQL you write is probably good (using SBR).
RBR will simply work.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2024/07/upgrade-03.png&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/p&gt;
&lt;p&gt;&lt;em&gt;The replication hierarchy has been extended to one additional replica of MySQL 5.6.
We also have moved the reads from MySQL 5.5 to MySQL 5.6.
At this point in time we can test our reading SQL with the new version, and if that fails, cut back to the old version.
After fixing the problem we try again.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2024/07/upgrade-04.png&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Once we are confident the reads work, we can try the same with the write traffic.
This is the point of no return: The old primary is now idle, and is missing writes.
We can only fail forward, that is, fix the problematic write SQL, as we are committed to the new version.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2024/07/upgrade-05.png&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/p&gt;
&lt;p&gt;&lt;em&gt;We can now delete all old version instances, that is, we behead the replication tree.
We can then start over and move to the next version in our upgrade sequence.&lt;/em&gt;&lt;/p&gt;
&lt;h1 id=&#34;tldr&#34;&gt;
    &lt;a href=&#34;#tldr&#34;&gt;
	TL;DR
    &lt;/a&gt;
&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;If your MySQL instance does not have at least one replica more than you are going to need, you are holding it wrong.
&lt;ul&gt;
&lt;li&gt;You must be operationally capable of casually creating new MySQL replicas from a backup or a donor instance at will.
This must be an operational procedure, a day-to-day task, not a project.
If you can&amp;rsquo;t do this, you can&amp;rsquo;t move.
Solve this problem first, then return to the upgrade task.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Upgrade MySQL from one major version to the next one, using in-place upgrades – on a replica.
&lt;ul&gt;
&lt;li&gt;When done, behead the replication tree. That is, point the writes from the old version primary to the new database,
promoting the replica to the new primary.&lt;/li&gt;
&lt;li&gt;Make sure to build new replicas using the new version as needed, in time.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;If you must upgrade using a dump, plan this.
&lt;ul&gt;
&lt;li&gt;Dumps are slow because they rebuild indexes.&lt;/li&gt;
&lt;li&gt;Try this out and time it, optimize it by playing with &lt;code&gt;innodb_sort_buffer_size&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; This article has been edited on 24-Jul-2024 to include additional input from Simon Mudd. Thank you, Simon!&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Crowdstroke</title>
      <link>https://blog.koehntopp.info/2024/07/22/crowdstroke.html</link>
      <pubDate>Mon, 22 Jul 2024 04:05:06 +0000</pubDate><author>kris-blog@koehntopp.de (Kristian Köhntopp)</author>

      <guid>https://blog.koehntopp.info/2024/07/22/crowdstroke.html</guid>
      <description>&lt;p&gt;This is the Monday after the Friday
when Crowdstrike took out a good 1% of all Windows machines worldwide with a botched update.&lt;/p&gt;
&lt;h1 id=&#34;some-takes&#34;&gt;
    &lt;a href=&#34;#some-takes&#34;&gt;
	Some Takes
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2024/07/crowdstroke-01.png&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/p&gt;
&lt;h2 id=&#34;crowdstrike&#34;&gt;
    &lt;a href=&#34;#crowdstrike&#34;&gt;
	Crowdstrike
    &lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;The company did release a statement with
&amp;ldquo;&lt;a href=&#34;https://www.crowdstrike.com/blog/falcon-update-for-windows-hosts-technical-details/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Technical Details&lt;/a&gt;

&amp;rdquo;.
This is a big nothingburger.
They are confirming what we already knew.
Nothing is said about the server side, root causes and the chain of process failures that led to this incident.&lt;/p&gt;
&lt;h2 id=&#34;martin-seeger&#34;&gt;
    &lt;a href=&#34;#martin-seeger&#34;&gt;
	Martin Seeger
    &lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;Martin Seeger compares this to the XZ Incident in Open Source in
&lt;a href=&#34;https://infosec.exchange/@masek/112817758224618946&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;a post&lt;/a&gt;

:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;We are now at t+26h.
Please compare
how much we knew about the xz-attack after less than a day with what
we know about the chain of events of giant outage yesterday.&lt;/p&gt;
&lt;p&gt;If something similar had been caused by an OSS component,
we would see congress discussing a ban on open software in critical infrastructure already.&lt;/p&gt;&lt;/blockquote&gt;
&lt;h2 id=&#34;kevin-beaumont&#34;&gt;
    &lt;a href=&#34;#kevin-beaumont&#34;&gt;
	Kevin Beaumont
    &lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;Kevin Beaumont gives the kill count in
&lt;a href=&#34;https://cyberplace.social/@GossiTheDog/112819549722486621&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;another post&lt;/a&gt;

:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Microsoft estimate almost 9 million Windows devices are impacted by the CrowdStrike incident
(likely from crash telemetry).
&lt;a href=&#34;https://blogs.microsoft.com/blog/2024/07/20/helping-our-customers-through-the-crowdstrike-outage/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;link to microsoft&lt;/a&gt;

&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;But the outage did not affect just any one percent of all Windows machines,
but specifically, the one percent
that due to use in commercial environments with special requirements had Crowdstrike installed.
That is particularly funny, because the
&lt;a href=&#34;https://www.crowdstrike.com/terms-and-conditions-de/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ToS of Crowdstrike&lt;/a&gt;


says &amp;ldquo;not liable, not highly available, not suitable for anything important, and by the way, you are on your own&amp;rdquo;.
I am sure this will be contested in court,
but in any case, the liability clauses of anything else in the market are very similar.&lt;/p&gt;
&lt;h2 id=&#34;manuel-atug&#34;&gt;
    &lt;a href=&#34;#manuel-atug&#34;&gt;
	Manuel Atug
    &lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.linkedin.com/posts/manuel-honkhase-atug-820b27241_crowdstrike-kritis-activity-7220713390443241472-1EMl/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Manual Atug posts on LinkedIn&lt;/a&gt;


about this fact, and the comments section is largely in
&lt;a href=&#34;https://en.wikipedia.org/wiki/Five_stages_of_grief&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;the denial stage of grief&lt;/a&gt;

.
Mostly people resign (&amp;ldquo;All EULA are like this.&amp;rdquo;),
think product liability is never going to be a thing,
and even ask how they are supposed to test this, or implement staggered rollouts for AV and endpoint security updates.&lt;/p&gt;
&lt;p&gt;That is not how KRITIS works.
If an outage on a desktop can affect flight operations or supermarket cash registers,
the desktops are in scope.
And the Crowdstrike outage, on the desktop, had an impact on travel, sales and other systems.
That means it&amp;rsquo;s in scope, and the testing, rollout and EULA are not adequate.&lt;/p&gt;
&lt;h2 id=&#34;lennart-poettering&#34;&gt;
    &lt;a href=&#34;#lennart-poettering&#34;&gt;
	Lennart Poettering
    &lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;Windows itself is badly prepared for such an outage.
Lennart Poettering (somewhat smugly)
&lt;a href=&#34;https://mastodon.social/@pid_eins/112818864687187963&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;in a post&lt;/a&gt;


points out that&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;So, if you ask me what my takeaway from the Crowdstrike issue is, I&amp;rsquo;d say:
boot counting/boot assessment/automatic fallback should really be a MUST for today&amp;rsquo;s systems.
Before* you invoke your first kernel you need
have tracking of boot attempts and a logic for falling back to older versions automatically.
It&amp;rsquo;s a major shortcoming that this is not default behaviour of today&amp;rsquo;s distros, in particular commercial ones.&lt;/p&gt;
&lt;p&gt;Of course systemd has supported this for a long time:
&lt;a href=&#34;https://systemd.io/AUTOMATIC_BOOT_ASSESSMENT/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Automatic Boot Assessment&lt;/a&gt;

&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Windows does not do that, but Linux could.
If commercial Linux distros were to use this feature.&lt;/p&gt;
&lt;p&gt;MacOS also would not have been affected.
Apple prohibits security software implemented as device drivers,
because they &lt;a href=&#34;https://blog.koehntopp.info/2018/06/18/websense-dlp-gives-instant-root.html&#34;&gt;tend to be flawed&lt;/a&gt;

.
Instead, Apple provides a framework, System Extensions,
in which a non-privileged process can run a security scanning process safely and in a way
where a crash does not take down the system.
Microsoft claims they can&amp;rsquo;t provide this
because due to contracts with the EU they are bound to give security vendors the same API as they are using themselves.
That is, of course, bullshit.
Defender could use such an API, and then everybody else would have to, as well, because that &lt;em&gt;is&lt;/em&gt; the API.&lt;/p&gt;
&lt;h2 id=&#34;stefan-eissing&#34;&gt;
    &lt;a href=&#34;#stefan-eissing&#34;&gt;
	Stefan Eissing
    &lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;Stefan Eissing describes what the &lt;a href=&#34;&#34;&gt;mod_md&lt;/a&gt;

 certificate renewal process does.&lt;/p&gt;
&lt;p&gt;Apache mod_md is a module for the Apache web server that implements the ACME protocol as spoken by Let&amp;rsquo;s Encrypt.
Here is how he &lt;a href=&#34;https://chaos.social/@icing/112829370177074835&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;describes the update&lt;/a&gt;

:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;How Apache ACME (mod_md) gets you a new certificate:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;all ACME communication are done as unprivileged user&lt;/li&gt;
&lt;li&gt;all certificates from the CA are parsed as unprivileged user before storing them&lt;/li&gt;
&lt;li&gt;activation, as privileged user, parses again before replacing production as a last fail safe.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Since 2017.&lt;/p&gt;
&lt;p&gt;Typical over-engineering. What are the chances a CA sends you a borked file?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;This is what Crowdstrike did not do, in the client.&lt;/p&gt;
&lt;p&gt;So, what can we learn, not having a proper Root Cause Analysis from the vendor, four days later?&lt;/p&gt;
&lt;h1 id=&#34;learnings&#34;&gt;
    &lt;a href=&#34;#learnings&#34;&gt;
	Learnings
    &lt;/a&gt;
&lt;/h1&gt;
&lt;h2 id=&#34;windows&#34;&gt;
    &lt;a href=&#34;#windows&#34;&gt;
	Windows
    &lt;/a&gt;
&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Windows does not offer the equivalent of the macOS System Extension API,
in which an iterator for files is provided by the OS
and all security software is running with System Extension Capability,
but as an otherwise unprivileged user.&lt;/li&gt;
&lt;li&gt;Windows does not offer the equivalent of the Linux eBPF framework,
which allows vendors to implement probes in a safer, less intrusive and more resilient way than using raw C.&lt;/li&gt;
&lt;li&gt;Windows does not protect against recoverable device driver crashes such as Linux (Kernel Oops vs. Kernel Crash).&lt;/li&gt;
&lt;li&gt;Windows does not do automatic Boot Assessment and Rollback,
and manual rollback is complicated with disk encryption deployed.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;crowdstrike-1&#34;&gt;
    &lt;a href=&#34;#crowdstrike-1&#34;&gt;
	Crowdstrike
    &lt;/a&gt;
&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Crowdstrike implements a kernel process or driver,
which parses config files in a privileged kernel context which can lead to crash on boot
(which is remediated by deleting a config file)
&lt;ul&gt;
&lt;li&gt;This is a bad architecture from the 1990ies.&lt;/li&gt;
&lt;li&gt;Crowdstrike could implement a &amp;ldquo;System Extension&amp;rdquo; like static driver themselves,
and run the analysis in an unprivileged user account.
They do not have to wait for Microsoft for such an API.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Crowdstrike seems to use C or C++ instead of a memory safe language such as Rust.
&lt;ul&gt;
&lt;li&gt;Crashing a Rust-written driver in the way demonstrated would be much harder.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;There is no public documentation on the functioning, configuration or the data processed by Crowdstrike in their cloud.
It is weird that this can be even done in the EU, being GDPR-compliant and all.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;enterprises&#34;&gt;
    &lt;a href=&#34;#enterprises&#34;&gt;
	Enterprises
    &lt;/a&gt;
&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Enterprises roll out such updates in an uncontrolled way.
No local testing, no staggered rollouts.
Complete absence of a proper Change Management process.&lt;/li&gt;
&lt;li&gt;The fact
that large Enterprises operating KRITIS have fired thousands of employees within the last 12 months also contributed,
for example, by the inability to implement proper testing and staggered rollout.
Non-functional decisions have functional consequences.
Enterprises have lost critical institutional knowledge and functional execution capabilities.&lt;/li&gt;
&lt;li&gt;Enterprises use such software in the critical path of KRITIS systems.
While not directly in regulated OT, the outage did affect the proper functioning of KRITIS systems,
and is therefore in scope.
&lt;ul&gt;
&lt;li&gt;This also suggests &lt;a href=&#34;https://blog.koehntopp.info/2023/02/18/this-is-not-a-drill.html&#34;&gt;inadequate BCM testing&lt;/a&gt;

.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;In summary,
we are observing a multilateral process breakdown leading to a KRITIS outage,
indicating that we do have compliance driven architecture instead of an actual security process.&lt;/p&gt;
&lt;p&gt;See also: &lt;a href=&#34;https://blog.koehntopp.info/2024/02/10/snake-oil.html&#34;&gt;Snake Oil&lt;/a&gt;

,
especially the guinea pig at the end.
Some things can only be made bearable with cute guinea pig photos.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Power (and Energy)</title>
      <link>https://blog.koehntopp.info/2024/07/16/energy.html</link>
      <pubDate>Tue, 16 Jul 2024 04:05:06 +0000</pubDate><author>kris-blog@koehntopp.de (Kristian Köhntopp)</author>

      <guid>https://blog.koehntopp.info/2024/07/16/energy.html</guid>
      <description>&lt;p&gt;Let&amp;rsquo;s talk about power and household items.&lt;/p&gt;
&lt;p&gt;Power is measured in Watt (W).
1000 Watt make a Kilowatt (kW).&lt;/p&gt;
&lt;p&gt;Work (Energy) is power expended for an amount of time.
1000 Watt (a Kilowatt) used for one hour is a Kilowatt-hour (kWh).&lt;/p&gt;
&lt;p&gt;How much is a Watt?
In our graphics, a Watt is a single red pixel, right of the word cellphone
One Watt is what an iPhone uses when you are running Ice Cubes, scrolling social media.&lt;/p&gt;
&lt;p&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2024/07/energy-01.png&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;


&lt;em&gt;Zoom into this image to see the pixel. It symbolizes 1 W.&lt;/em&gt;&lt;/p&gt;
&lt;h1 id=&#34;media-appliances&#34;&gt;
    &lt;a href=&#34;#media-appliances&#34;&gt;
	Media appliances
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;When you are using 5 W your cellphone gets hot.
It is the approximate maximum a device can use without having active cooling, a spinning fan.&lt;/p&gt;
&lt;p&gt;A device with an active cooler such as a Mac mini uses 5 W when used normally, and up to 25 W under load.
It can use up to 50 W.&lt;/p&gt;
&lt;p&gt;25 W is also what a typical cheap Intel laptop uses when idle.
For example, the Lenovo Yoga I once had.&lt;/p&gt;
&lt;p&gt;80 W is what a medium large TV uses in your living room. showing the news.&lt;/p&gt;
&lt;p&gt;80 W is also what my gaming machine uses, with a Ryzen CPU, an Nvidia 4070 and 64 GB of memory,
when idle showing steam and the Windows desktop.&lt;/p&gt;
&lt;p&gt;400 W is what my gaming machine uses when I play.&lt;/p&gt;
&lt;p&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2024/07/energy-02.png&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;


&lt;em&gt;Typical household media consumption, Energy used. One pixel = one W.&lt;/em&gt;&lt;/p&gt;
&lt;h1 id=&#34;household-heat&#34;&gt;
    &lt;a href=&#34;#household-heat&#34;&gt;
	Household heat
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;Let&amp;rsquo;s walk over from the living room to the kitchen.
A lot of these household devices produce heat, for washing, drying or cooking.
At 10 Ampere, you get around 2300 W from 230 V. At 16 Ampere, 3680 W.&lt;/p&gt;
&lt;p&gt;Most of these heaters are very simple devices: They are fully on or completely off.
So we see a lot of devices that are using either full power or almost no power.&lt;/p&gt;
&lt;p&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2024/07/energy-09.png&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/p&gt;
&lt;p&gt;&lt;em&gt;A Wiesheu Minimat 43s, a professional baking oven of the kind that you find in gas stations or supermarkets.
It uses single phase normal power, 16A, so that still can fit into a normal household.
The device heats up, using 3000W, and then switches on and off to maintain temperature.
This pattern is typical for household appliances that produce process heat:
Ovens, cooking plates, washing machines, dryers.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2024/07/energy-03.png&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;


&lt;em&gt;Adding a 2000 W (10 A) and a 3000 W (16 A) household device.&lt;/em&gt;&lt;/p&gt;
&lt;h1 id=&#34;driving-and-charging-a-car&#34;&gt;
    &lt;a href=&#34;#driving-and-charging-a-car&#34;&gt;
	Driving and charging a car
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;Many people now drive electrical cars.
Those that have the space often use a local charge-point that uses three-phase power at 16 A per phase to charge.
Three phases at 16 A and 230 V deliver 3 * 16 A * 230 V = 11000 W.&lt;/p&gt;
&lt;p&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2024/07/energy-04.png&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;


&lt;em&gt;Adding the charge-point, 11000 W.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Over one hour, this uses 11 kWh of Energy.
A battery of 60 kWh that was at 10% is typically charged to 80%.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;&amp;gt;&lt;/span&gt;&amp;gt;&amp;gt; &lt;span class=&#34;nv&#34;&gt;scale&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;4&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;&amp;gt;&lt;/span&gt;&amp;gt;&amp;gt; &lt;span class=&#34;m&#34;&gt;60&lt;/span&gt; * &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.8-0.1&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;42.0
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;gp&#34;&gt;&amp;gt;&lt;/span&gt;&amp;gt;&amp;gt; ./11
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;3.8181
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Charging a car with a 60 kWh battery from 10% to 80% replaces 70% of the total battery capacity, 42 kWh.
At a charge rate of 11 kW, it takes 3.8 h to charge the car.
Since charging slows down as the battery fills up, it will take approximately 4 h to complete the charge.&lt;/p&gt;
&lt;p&gt;You could get a 3 phase, 32 A connection, for a 22 kW charge-point.
But the electricity company will charge you a lot more for that,
and it is kind of pointless.
Already at 11kW, even a 100 kWh Tesla battery will charge from 10% to 80% in 6.5 h,
and you do not have to drive the battery to empty before you charge.&lt;/p&gt;
&lt;p&gt;In fact, if you charge every evening, just because you can, you are going to replace what you used up this day.
For 100 km, that is typically 20 kWh or less, so the car will be back at 80% after one or two hours.&lt;/p&gt;
&lt;p&gt;Don&amp;rsquo;t get a 22 kW charge-point, it is pointless.&lt;/p&gt;
&lt;p&gt;Many people want charge-points that can do surplus charging,
using only as much power as the solar array on their roof can provide.
Most charge-points can go from 3 phases to 1 phase, and from 16 A down to 6 A.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;&amp;gt;&lt;/span&gt;&amp;gt;&amp;gt; &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; * &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt; * &lt;span class=&#34;m&#34;&gt;230&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;1380
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;gp&#34;&gt;&amp;gt;&lt;/span&gt;&amp;gt;&amp;gt; &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; * &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt; * &lt;span class=&#34;m&#34;&gt;230&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;4140
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;For a single phase, you can go down as low as 1380 W at 6 A.
For three-phase, you can go down as low as 4140 W at 6 A.
That is good for 5.5 kWh or 16.5 kWh on a sunny afternoon (4 h of time at 1.4 kW or 4.1 kW).&lt;/p&gt;
&lt;p&gt;With a proper charge controller, you could charge your electric car from the solar array of the house slowly,
but for free.
Even on somewhat cloudy days.&lt;/p&gt;
&lt;p&gt;When driving, that car (in my case, a Renault Megane e-Tech 60 kWh) straight on a flat Netherlands Autobahn,
the car consumes 15,000 W.&lt;/p&gt;
&lt;p&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2024/07/energy-05.png&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/p&gt;
&lt;p&gt;&lt;em&gt;If your car shows &amp;ldquo;15 kWh being used&amp;rdquo;,
it means that if you continued to drive this way for an hour, it would use 15 kWh of the battery.
It is actually using 15 kW, 15,000 W, right now.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Motors in electrical cars are not like motors in combustion engine cars.
They can use an almost infinite amount of energy for a short amount of time.
The current the battery can provide limits their output
(which is a function of the battery&amp;rsquo;s internal resistance).
Also limiting are the thickness of the wires,
and ultimately the amount of cooling we provide for the motor.&lt;/p&gt;
&lt;p&gt;So for a short time, the car can provide astronomical amounts of power.
The Renault Megane we used as an example further up can be
driven on the autobahn at 100 km/h with 15,000 W.
But it can consume 160,000 W (220 horsepower) for a short time to get away from the traffic light in a race.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.koehntopp.info/uploads/2024/07/energy-06.png&#34;&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2024/07/energy-06.png&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/a&gt;

&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Hitting a Megane on the head will use 160 kW, 220 hp. &lt;a href=&#34;https://blog.koehntopp.info/uploads/2024/07/energy-06.png&#34;&gt;full size&lt;/a&gt;

&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;If you drove using that much energy for an hour, you&amp;rsquo;d use 160 kWh.
At 42 kWh of useful battery content from a 60 kWh battery,
with a discharge rate of 160 kW the 42 kWh will be drained in 16 minutes.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;&amp;gt;&lt;/span&gt;&amp;gt;&amp;gt; 42/160
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;0.2625
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;42 kWh battery content, 160 kW used, so we will have that used up in 0.2625 h.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;&amp;gt;&lt;/span&gt;&amp;gt;&amp;gt; 60*0.2625
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;15.75
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Sixty minutes to the hour, so 0.2625 of an hour are 15.75 minutes.&lt;/p&gt;
&lt;p&gt;An electrical flow heater, dispensing water in a household, is using around 21 kW.&lt;/p&gt;
&lt;p&gt;A Tesla V4 fast charger will provide 250,000 W.&lt;/p&gt;
&lt;p&gt;A Porsche Taycan can provide 560 000 Watt (760 hp) for a short time.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.koehntopp.info/uploads/2024/07/energy-07.png&#34;&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2024/07/energy-07.png&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/a&gt;

&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Hitting a Porsche Taycan on the head will use 560 kW, 760 hp. &lt;a href=&#34;https://blog.koehntopp.info/uploads/2024/07/energy-07.png&#34;&gt;full size&lt;/a&gt;

&lt;/em&gt;&lt;/p&gt;
&lt;h1 id=&#34;bonus-picture-being-dumb&#34;&gt;
    &lt;a href=&#34;#bonus-picture-being-dumb&#34;&gt;
	Bonus picture: Being dumb
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2024/07/energy-08.png&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/p&gt;
&lt;p&gt;&lt;em&gt;I am opening the deep freezer door to take out the chocolate ice cream, and I do not close the door properly.
The deep freezer goes into overdrive.
Since I am plotting the 1d average power, I can see how that affects the freezer:
Average goes up from 13 W to 19 W, peak from 35 W to 90 W.&lt;/em&gt;&lt;/p&gt;
&lt;h1 id=&#34;how-can-i-save-energy&#34;&gt;
    &lt;a href=&#34;#how-can-i-save-energy&#34;&gt;
	How can I save energy?
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;The numbers you see here are power, not energy.
They only become energy if you are using the power over longer amounts of time.&lt;/p&gt;
&lt;p&gt;Saving energy would mean to measure kWh, not kW, and then cut down on the kWh used.
Or even convert the household so that it generates kWh, i.e., by installing roof solar or balcony solar.&lt;/p&gt;
&lt;p&gt;Still, kW is often a good indicator:&lt;/p&gt;
&lt;p&gt;Driving 100 km in an electric car at 100 km/h uses 15 kWh.
Doing the same at 130 km/h uses 22 kWh.
Doing the same in a combustion engine car at 130 km/h uses 6l of diesel, 60 kWh of raw energy content.&lt;/p&gt;
&lt;p&gt;Washing machines, dryers, and dishwashers tend to use a lot of energy, but often only for an hour or so.
A modern washer uses around 1.3 kWh to wash 7 kg of clothing.&lt;/p&gt;
&lt;p&gt;Permanently running devices such as file-servers use a lot of energy because they are always on.
Multiply their power by 24 to get energy.&lt;/p&gt;
&lt;p&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2024/07/energy-10.png&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Running the washing machine used 1.3 kWh at 13:00.
But over the whole day, my desk and all the computers on it are using the most energy,
because the file server is running 24/7 at 100 W.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;All that energy use is completely dwarfed by driving.
Here is a day
that shows what happens when we charge the Megane e-Tech at the charge-point and the Carver S+ using a normal wall-plug.&lt;/p&gt;
&lt;p&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2024/07/energy-11.png&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Charging the Megane for 20 kWh and the Carver for 7 kWh. The rest of households power consumption is much smaller.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Is that bad?&lt;/p&gt;
&lt;p&gt;&lt;p class=&#34;md__image&#34;&gt;
  &lt;img src=&#34;https://blog.koehntopp.info/uploads/2024/07/energy-12.png&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;

&lt;/p&gt;
&lt;p&gt;&lt;em&gt;On that particular day, 2024-Jul-12, we produced 38.8 kWh of energy using the solar array on our roof.
We consumed 33.9 kWh.
Overall, we returned 4.92 kWh to the grid,
but we actually put 29.7 kWh into the grid and took 24.8 kWh out of the grid at other times.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;This was a sunny day.
While we have been drawing almost 25 kWh from the grid (we use around 10 kWh on normal days),
we also fed almost 30 kWh into the grid, for a surplus of almost five kWh.
That is, despite the 2.5-fold higher power consumption than normal, we have provided a net power surplus to the grid.
We also pulled power from the grid around noon, when solar power is usually available in abundance,
and the hourly energy prices are lowest.&lt;/p&gt;
&lt;h1 id=&#34;tldr&#34;&gt;
    &lt;a href=&#34;#tldr&#34;&gt;
	TL;DR
    &lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;Find a way to
&lt;a href=&#34;https://www.amazon.de/dp/B0054PSIDW&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;measure power and energy consumption&lt;/a&gt;


so that you know and do not have to guess.
Collect and visualize that data using
&lt;a href=&#34;https://www.home-assistant.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Home Assistant&lt;/a&gt;


or similar.&lt;/p&gt;
&lt;p&gt;Media power consumption is meaningless in the grander scheme of things.&lt;/p&gt;
&lt;p&gt;Household heat matters.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Get rid of gas, get a heat pump.&lt;/li&gt;
&lt;li&gt;Cook electrically, not using gas.&lt;/li&gt;
&lt;li&gt;Make sure your household devices working with heat are state of the art:
&lt;ul&gt;
&lt;li&gt;Get a decent washing machine.&lt;/li&gt;
&lt;li&gt;Do not use a tumble dryer, dry on a clothes horse.&lt;/li&gt;
&lt;li&gt;Get a decent fridge/freezer combo. Make sure it is de-iced and efficient.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Watch out for always-on devices, but be sure to relate their energy use to the rest of the household&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Mobility matters even more than household heat: Driving uses way more energy than living in a place.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Work from home.&lt;/li&gt;
&lt;li&gt;When moving, do not use a car, use a bike. Or public transport.&lt;/li&gt;
&lt;li&gt;When using a car, use a small car. Weight matters.&lt;/li&gt;
&lt;li&gt;When using a car, drive energy efficiently: Going 130 km/h instead of 100 km/h uses 50% more energy.&lt;/li&gt;
&lt;li&gt;If you have to use a car, get rid of a combustion engine car, drive an electric car.
It uses 1/3 the energy of a combustion engine car.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Make energy.
Cover every surface in solar cells.&lt;/p&gt;
&lt;p&gt;Store energy.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Get a battery that can provide enough power for your household.
Power (Watt) is often a function of the cell count.
Cells also provide capacity, so larger batteries (more kWh) also provide more power (kW) up to a limit (11 kW).
When planning, check both numbers, kW and kWh.&lt;/li&gt;
&lt;li&gt;To get a household to self-sufficiency, surprisingly small batteries are needed.
The minimum of either half the daily power consumption
and the production in a day in March or October should be enough.
You may want more, but that is because of power, not energy content.&lt;/li&gt;
&lt;li&gt;In any case, ~10 kWh LFP should be fine for most households.
Having more than you can fill on an early spring/late autumn day is useless, and you won&amp;rsquo;t fill it Nov – Feb anyway.
Having giant capacities in summer is useless, because you won&amp;rsquo;t empty the battery.&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
  </channel>
</rss>
