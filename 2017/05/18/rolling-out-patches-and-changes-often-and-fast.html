<!doctype html>
<html lang="en">
    <head>
    <meta charset="utf-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<title>Rolling out patches and changes, often and fast | Die wunderbare Welt von Isotopp</title>
<meta name="description" content="Kris Köhntopp&#39;s blog (Fedi: @isotoppinfosec.exchange)">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" href="icon.png">
<link rel="icon" href="favicon.ico" type="image/ico">
<link rel="shortcut icon" href="favicon.ico">
<link rel="canonical" href="https://blog.koehntopp.info/2017/05/18/rolling-out-patches-and-changes-often-and-fast.html">

<link rel="alternate" type="application/rss+xml" href='https://blog.koehntopp.info/feed.xml' title="Die wunderbare Welt von Isotopp">
<link rel="alternate" type="application/rss+xml" href='https://blog.koehntopp.info/tags/mysql/feed.xml' title="Feed: mysql Articles for Die wunderbare Welt von Isotopp">
<link rel="alternate" type="application/rss+xml" href='https://blog.koehntopp.info/tags/review/feed.xml' title="Feed: review Articles for Die wunderbare Welt von Isotopp">


<meta name="generator" content="Hugo 0.145.0">
<meta property="og:title" content='Rolling out patches and changes, often and fast | Die wunderbare Welt von Isotopp' />
<meta property="og:site_name" content='Die wunderbare Welt von Isotopp' />
<meta property="og:locale" content="en_US" />
<meta name="description" content='Kris Köhntopp&#39;s blog (Fedi: @isotoppinfosec.exchange)' />
<meta property="og:description" content='Kris Köhntopp&#39;s blog (Fedi: @isotoppinfosec.exchange)' />
<meta property="og:url" content="https://blog.koehntopp.info/2017/05/18/rolling-out-patches-and-changes-often-and-fast.html" />
<meta property="og:type" content="article" />
<meta name="article:published_time" content='2017-05-18T10:44:13Z' />
<meta name="fediverse:creator" content="@isotopp@infosec.exchange">
<meta property="og:image" content='https://blog.koehntopp.info/assets/img/background/rijksmuseum.jpg' />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:creator" content='@isotopp@infosec.exchange' />
<meta property="twitter:title" content='Rolling out patches and changes, often and fast' />
<meta property="twitter:description" content='Kris Köhntopp&#39;s blog (Fedi: @isotoppinfosec.exchange)' />
<meta property="twitter:image" content='https://blog.koehntopp.info/assets/img/background/rijksmuseum.jpg' />


    



<link rel="stylesheet" href="https://blog.koehntopp.info/style.min.dd9d518fe6cac55191b6af874e18327dff051055754ffc7e106131baf826e6d3.css">


    </head>
    <body>
        

        <nav class="navbar navbar-expand-lg navbar-light px-lg-4 pt-lg-4">
    <div class="container-fluid">
        <a class="navbar-brand justify-content-center" href="https://blog.koehntopp.info/" rel="home" title="Die wunderbare Welt von Isotopp">
            <img alt="Kris" height='48' width='48' src='/assets/img/avatars/isotopp.jpg' class='p-0 me-3 d-block d-lg-inline'>
            <span class='h4 d-block d-lg-inline'>Die wunderbare Welt von Isotopp</span>
        </a>

        <button class="navbar-toggler ms-auto" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse text-center" id="navbarSupportedContent">
            <ul class="navbar-nav ms-auto">
                
                <li class="nav-item ">
                    <a class="nav-link" href="/about/">
                        <span class="">About</span>
                        
                    </a>
                </li>
                <li class="nav-item ">
                    <a class="nav-link" href="/contribute/">
                        <span class="">Contribute</span>
                        
                    </a>
                </li>
                <li class="nav-item ">
                    <a class="nav-link" href="/search/">
                        <span class=""><svg class='bi' height='1.5rem' width='1.5rem' fill='currentColor'><use xlink:href='/bootstrap-icons.svg#search'/></svg></span>
                        
                    </a>
                </li>
                <li class="nav-item ">
                    <a class="nav-link" href="/tags/">
                        <span class=""><svg class='bi' width='1.5rem' height='1.5rem' fill='currentColor'><use xlink:href='/bootstrap-icons.svg#tags-fill'/></svg></span>
                        
                    </a>
                </li>
                
            </ul>
            
        </div>

    </div>
</nav>


        <main role="main" class="container-fluid p-0">

            









<div class="page">
	<article class="rolling-out-patches-and-changes-often-and-fast-page">
		<div class='row  justify-content-center text-center my-4 mx-0'>
			<header class="headerbanner">
				<div class='col'>
					<h1 class="title mb-lg-4 text-white">
						Rolling out patches and changes, often and fast
					</h1>
					<div class='text-uppercase text-light' style='letter-spacing: 0.1rem;'>
						<img alt='@isotopp@infosec.exchange image' src='/assets/img/avatars/isotopp.jpg' class='me-1 p-0'
						     style='width: 1.9rem; border-radius: 1rem;'>
						<a href="https://infosec.exchange/@isotopp" class='text-light text-decoration-none'>
							Kristian Köhntopp
						</a>
						
						<span class='d-none d-lg-inline'>-</span>
						<div class='d-block d-lg-inline'>May 18, 2017</div>
						
					</div>
				</div>
				
				<img alt='a featured image' src="/assets/img/background/rijksmuseum.jpg">
				
			</header>
		</div>

		<div class='row justify-content-center mx-0'>
			<div class='col-lg-4 text-center text-lg-start'>
				
				<div>
					<div class='letter-spacing-01 text-uppercase text-secondary'>
						Previous Post
					</div>
					<a class='text-decoration-none' href="https://blog.koehntopp.info/2017/05/15/handling-wannacrypt-a-few-words-about-technical-debt.html">Handling Wannacrypt - a few words about technical debt</a>
				</div>
				
			</div>

			<div class='col-lg-4 text-lg-end mt-5 mt-lg-0 text-center'>
				
				<div>
					<div class='letter-spacing-01 text-uppercase text-secondary'>
						Next Post
					</div>
					<a class='text-decoration-none' href="https://blog.koehntopp.info/2017/05/23/rethinking-transportation.html">Rethinking Transportation</a>
				</div>
				
			</div>
		</div>

		<div class='row justify-content-center mx-0 mt-3 mb-5'>
			<div class="col-lg-8 mb-3">
				
			</div>
			<div class='col-lg-8'>
				<p>Fefe had a <a href="https://blog.fefe.de/?ts=a7e82d0e" target="_blank" rel="noopener">short pointer</a>

 to an article
<a href="https://www.cs.columbia.edu/~smb/blog/2017-05/2017-05-12.html" target="_blank" rel="noopener">Patching is Hard</a>

.
It is, but you can make it a lot easier by doing a few things right. I did s small
writeup (<a href="https://blog.fefe.de/?ts=a7e262f4" target="_blank" rel="noopener">in German</a>

) to explain this,
which Fefe posted.</p>
<p>I do have an older talk on this, titled &ldquo;8 rollouts a day&rdquo; (more like
30 these days). There are
<a href="https://www.slideshare.net/isotopp/8-rollouts-a-day" target="_blank" rel="noopener">slides</a>

 and a
<a href="https://www.youtube.com/watch?v=rzU1UtUpyTI" target="_blank" rel="noopener">recording</a>

. The Devops talk
&ldquo;Go away or I will replace you with a little shell script&rdquo; addresses it,
too, but from a different angle
(<a href="https://www.slideshare.net/isotopp/go-away-of-i-will-replace-you-with-a-little-shell-script-english" target="_blank" rel="noopener">slides</a>

,
<a href="https://www.youtube.com/watch?v=e0CCv7pSK4s" target="_blank" rel="noopener">recording</a>

).</p>
<p>Here is the english version of my writeup.</p>
<p>The <a href="https://www.cs.columbia.edu/~smb/blog/2017-05/2017-05-12.html" target="_blank" rel="noopener">Patching is Hard</a>

 article
says:</p>
<blockquote>
<p>Patching is hard? Yes—and every major tech player, no matter
how sophisticated they are, has had catastrophic failures when
they tried to change something. Google once bricked
Chromebooks with an update. A Facebook configuration change
took the site offline for 2.5 hours. Microsoft ruined network
configuration and partially bricked some computers; even their
newest patch isn&rsquo;t trouble-free. An iOS update from Apple
bricked some iPad Pros. Even Amazon knocked AWS off the air.</p></blockquote>
<p>Where I am working we made the same observation. 100% uptime is
impossible, but management needs metrics and controls to
understand if we are still on the right track. We do have an
outage budget. That means we are measuring the actual current
business and compare with the predicted business. If a failed
rollout creates a loss of (potential) income, we can tell how
much that is and deduct that from the outage budget. We are
trying to make the budget as precisely as possible. That does
not mean we are trying to create outages on purpose, but having
fewer outages than the budget allows may mean that we are not
moving fast enough and have become complacent in what we are
doing.</p>
<p>Rolling out often is useful, because then change sets are small
and easy to check, much easier than large and hard to understand
changes. So we do need to roll out often in order to maintain
speed. Rollout problems tend to manifest in subsystems where we
do not roll out often enough. Usually secondary changes, changes
in dependencies and libraries, accumulate and then the rollout
fails. The solution is to roll out even if the code did not
change (that is, we roll out for the sake of keeping
dependencies current).</p>
<p>This is a very tangible form of representing technical debt:</p>
<ul>
<li>the larger the diff between production and trunk is, the more
likely moving trunk to production is going to result in a
failure.</li>
<li>To make patching safe you have to do it often.</li>
<li>To be able to patch often, you need to make patching and
rolling out an operative process and not an upgrade/migration
project.</li>
<li>To make rollouts and operative thing it is useful to
make testing in production safe and survivable.</li>
<li>To be able to test in production, the following things are
useful:
<ul>
<li>have at most two versions of a change to a certain system.
Do not do three phase or multiphase rollouts. Finish one
change before you do the next one.</li>
<li>have overcapacity. A change might make it necessary to
provide more machinery or more computer power or more memory
for a short time. You need to have that or be able to
provision this on short notice. Being efficient means having
no reserves, no elasticity.</li>
<li>separation of code distribution and code activation. That means feature
flags and experiments in your code. The same rollout must be
able to switch at runtime between old and new behavior.</li>
<li>changes to persistent data structures require that you update both
versions of the structure concurrently in order for old and
new code to be able to co-exist.</li>
<li>you need to know what is going on. Have a good monitoring, central log
collection, good search on all of that. There is a thing
called monitoring lag, the distance in time between a thing
happening and the time you will see this in your monitoring.
Measure that lag and have it shown on each screen. Alert on
monitoring lag.</li>
<li>have a culture of failure that focuses on improvement and
learnings. Check out the search term &ldquo;blameless postmortem&rdquo;
and read up on this.</li>
</ul>
</li>
</ul>
<p>It&rsquo;s not actually rocket science, but it will make things a lot better
around you.</p>
<blockquote>
<p>Stört euch bitte nicht an dem Denglisch, das ist in der Ops-Abteilung von
internationalen Firmen durchaus normal :-)</p></blockquote>
<p>Indeed. The office is in Amsterdam, and the language at work is English.
When I am thinking about work, I am doing it in English. Writing about work
in German means that I will use a lot of english terms for the things I am
trying to describe, because I&rsquo;d have to search for appropriate German terms
and concepts first and that would interrupt the flow. Sorry about that.</p>

			</div>
		</div>

		
		
		<div class='row justify-content-center py-3 mb-3 mx-0'>
			<div class='col-lg-8 text-center'>
				<span class='letter-spacing-01 text-uppercase text-secondary me-2'>Tags</span>
				
				<a href="/tags/#computer" class='btn btn-sm btn-outline-primary mb-1'>
				<svg class="bi" width="1rem" height="1rem" fill="currentColor">
					<use xlink:href="/bootstrap-icons.svg#tag-fill"></use>
				</svg>
				computer
				</a>
				
				<a href="/tags/#work" class='btn btn-sm btn-outline-primary mb-1'>
				<svg class="bi" width="1rem" height="1rem" fill="currentColor">
					<use xlink:href="/bootstrap-icons.svg#tag-fill"></use>
				</svg>
				work
				</a>
				
				<a href="/tags/#erklaerbaer" class='btn btn-sm btn-outline-primary mb-1'>
				<svg class="bi" width="1rem" height="1rem" fill="currentColor">
					<use xlink:href="/bootstrap-icons.svg#tag-fill"></use>
				</svg>
				erklaerbaer
				</a>
				
			</div>
		</div>

		
		
		
		
		<div class='row justify-content-center py-3 mb-3 mx-0'>
			<div class='col-lg-8 text-center'>
				<a href="https://github.com/isotopp/isotopp.github.io/edit/main/content/posts/2017-05-18-rolling-out-patches-and-changes-often-and-fast.md"
				   rel="noopener noreferrer" target="_blank">
					<span class='letter-spacing-01 text-uppercase text-secondary me-2'>Suggest Changes</span>
				</a>
			</div>
		</div>
		

		<div class='row justify-content-center mx-0'>
			<div class='col-lg-4 text-center text-lg-start'>
				
				<div>
					<div class='letter-spacing-01 text-uppercase text-secondary'>
						Previous Post
					</div>
					<a class='text-decoration-none' href="https://blog.koehntopp.info/2017/05/15/handling-wannacrypt-a-few-words-about-technical-debt.html">Handling Wannacrypt - a few words about technical debt</a>
				</div>
				
			</div>

			<div class='col-lg-4 text-lg-end mt-5 mt-lg-0 text-center'>
				
				<div>
					<div class='letter-spacing-01 text-uppercase text-secondary'>
						Next Post
					</div>
					<a class='text-decoration-none' href="https://blog.koehntopp.info/2017/05/23/rethinking-transportation.html">Rethinking Transportation</a>
				</div>
				
			</div>
		</div>


		
	</article>
</div>



            <footer class='row justify-content-center mb-4 pb-4 mx-0'>
  <div class='col-8 text-center'>
    <div>
      A collection of old stuff, new stuff and random stuff.
    </div>
    <div class='row text-primary mt-4'>
      <div class='col'>

        <a href='/feed.xml' title='Follow RSS feed' class='me-3 text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#rss-fill'/>
          </svg>
        </a>

        <a href='mailto:kristian.koehntopp@gmail.com' title='Email' class='me-3 text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#envelope'/>
          </svg>
        </a>

        <a href='https://github.com/isotopp' title='Follow on GitHub' class='me-3 text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#github'/>
          </svg>
        </a>

        <a rel="me" href="https://infosec.exchange/@isotopp" title='Follow on Mastodon' class='me-3 text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#mastodon'/>
          </svg>
        </a>

        
        <a href='http://steamcommunity.com/id/ixotopp' title='Follow on Steam' class='me-3 text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#steam'/>
          </svg>
        </a>

        

        <a href='https://www.youtube.com/user/isotopp' title='Follow on YouTube' class=''>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#youtube'/>
          </svg>
        </a>
      </div>
    </div>
  </div>
</footer>


        </main>

	





<script src="https://blog.koehntopp.info/js/bootstrap.js"></script>




<script src="https://blog.koehntopp.info/js/lunr.js"></script>





<script src="https://blog.koehntopp.info/js/app.js"></script>


    </body>
</html>
