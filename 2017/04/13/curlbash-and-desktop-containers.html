<!doctype html>
<html lang="en">
    <head>
    <meta charset="utf-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<title>Curlbash, and Desktop Containers | Die wunderbare Welt von Isotopp</title>
<meta name="description" content="Kris Köhntopp&#39;s blog (Fedi: @isotoppinfosec.exchange)">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" href="icon.png">
<link rel="icon" href="favicon.ico" type="image/ico">
<link rel="shortcut icon" href="favicon.ico">
<link rel="canonical" href="https://blog.koehntopp.info/2017/04/13/curlbash-and-desktop-containers.html">

<link rel="alternate" type="application/rss+xml" href='https://blog.koehntopp.info/feed.xml' title="Die wunderbare Welt von Isotopp">
<link rel="alternate" type="application/rss+xml" href='https://blog.koehntopp.info/tags/mysql/feed.xml' title="Feed: mysql Articles for Die wunderbare Welt von Isotopp">
<link rel="alternate" type="application/rss+xml" href='https://blog.koehntopp.info/tags/review/feed.xml' title="Feed: review Articles for Die wunderbare Welt von Isotopp">


<meta name="generator" content="Hugo 0.145.0">
<meta property="og:title" content='Curlbash, and Desktop Containers | Die wunderbare Welt von Isotopp' />
<meta property="og:site_name" content='Die wunderbare Welt von Isotopp' />
<meta property="og:locale" content="en_US" />
<meta name="description" content='Kris Köhntopp&#39;s blog (Fedi: @isotoppinfosec.exchange)' />
<meta property="og:description" content='Kris Köhntopp&#39;s blog (Fedi: @isotoppinfosec.exchange)' />
<meta property="og:url" content="https://blog.koehntopp.info/2017/04/13/curlbash-and-desktop-containers.html" />
<meta property="og:type" content="article" />
<meta name="article:published_time" content='2017-04-13T10:05:43Z' />
<meta name="fediverse:creator" content="@isotopp@infosec.exchange">
<meta property="og:image" content='https://blog.koehntopp.info/assets/img/background/schloss.jpg' />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:creator" content='@isotopp@infosec.exchange' />
<meta property="twitter:title" content='Curlbash, and Desktop Containers' />
<meta property="twitter:description" content='Kris Köhntopp&#39;s blog (Fedi: @isotoppinfosec.exchange)' />
<meta property="twitter:image" content='https://blog.koehntopp.info/assets/img/background/schloss.jpg' />


    



<link rel="stylesheet" href="https://blog.koehntopp.info/style.min.dd9d518fe6cac55191b6af874e18327dff051055754ffc7e106131baf826e6d3.css">


    </head>
    <body>
        

        <nav class="navbar navbar-expand-lg navbar-light px-lg-4 pt-lg-4">
    <div class="container-fluid">
        <a class="navbar-brand justify-content-center" href="https://blog.koehntopp.info/" rel="home" title="Die wunderbare Welt von Isotopp">
            <img alt="Kris" height='48' width='48' src='/assets/img/avatars/isotopp.jpg' class='p-0 me-3 d-block d-lg-inline'>
            <span class='h4 d-block d-lg-inline'>Die wunderbare Welt von Isotopp</span>
        </a>

        <button class="navbar-toggler ms-auto" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse text-center" id="navbarSupportedContent">
            <ul class="navbar-nav ms-auto">
                
                <li class="nav-item ">
                    <a class="nav-link" href="/about/">
                        <span class="">About</span>
                        
                    </a>
                </li>
                <li class="nav-item ">
                    <a class="nav-link" href="/contribute/">
                        <span class="">Contribute</span>
                        
                    </a>
                </li>
                <li class="nav-item ">
                    <a class="nav-link" href="/search/">
                        <span class=""><svg class='bi' height='1.5rem' width='1.5rem' fill='currentColor'><use xlink:href='/bootstrap-icons.svg#search'/></svg></span>
                        
                    </a>
                </li>
                <li class="nav-item ">
                    <a class="nav-link" href="/tags/">
                        <span class=""><svg class='bi' width='1.5rem' height='1.5rem' fill='currentColor'><use xlink:href='/bootstrap-icons.svg#tags-fill'/></svg></span>
                        
                    </a>
                </li>
                
            </ul>
            
        </div>

    </div>
</nav>


        <main role="main" class="container-fluid p-0">

            









<div class="page">
	<article class="curlbash-and-desktop-containers-page">
		<div class='row  justify-content-center text-center my-4 mx-0'>
			<header class="headerbanner">
				<div class='col'>
					<h1 class="title mb-lg-4 text-white">
						Curlbash, and Desktop Containers
					</h1>
					<div class='text-uppercase text-light' style='letter-spacing: 0.1rem;'>
						<img alt='@isotopp@infosec.exchange image' src='/assets/img/avatars/isotopp.jpg' class='me-1 p-0'
						     style='width: 1.9rem; border-radius: 1rem;'>
						<a href="https://infosec.exchange/@isotopp" class='text-light text-decoration-none'>
							Kristian Köhntopp
						</a>
						
						<span class='d-none d-lg-inline'>-</span>
						<div class='d-block d-lg-inline'>April 13, 2017</div>
						
					</div>
				</div>
				
				<img alt='a featured image' src="/assets/img/background/schloss.jpg">
				
			</header>
		</div>

		<div class='row justify-content-center mx-0'>
			<div class='col-lg-4 text-center text-lg-start'>
				
				<div>
					<div class='letter-spacing-01 text-uppercase text-secondary'>
						Previous Post
					</div>
					<a class='text-decoration-none' href="https://blog.koehntopp.info/2017/04/05/apostrophiser.html">Apostrophiser</a>
				</div>
				
			</div>

			<div class='col-lg-4 text-lg-end mt-5 mt-lg-0 text-center'>
				
				<div>
					<div class='letter-spacing-01 text-uppercase text-secondary'>
						Next Post
					</div>
					<a class='text-decoration-none' href="https://blog.koehntopp.info/2017/04/19/node-js-idea-of-an-inode-is-approximately-broken.html">node.js idea of an inode is approximately broken</a>
				</div>
				
			</div>
		</div>

		<div class='row justify-content-center mx-0 mt-3 mb-5'>
			<div class="col-lg-8 mb-3">
				
			</div>
			<div class='col-lg-8'>
				<p>I was having two independent discussions recently, which started with some
traditional Unix person condemning software installing with curlbash (<code>curl https://... | bash</code>), or even <code>curl | sudo bash</code>.</p>
<p>I do not really think this to be much more dangerous than the installation
of random rpm or dpkg packages any more. Especially if those packages are
unsigned or the signing key gets installed just before the package.</p>
<p>The threat model really became a different one in the last few years, and
the security mechanism have had to change as well. And they have, UIDs
becoming much less important. Desktop containers and Sandboxes have become
much more important, and segregation happens now at a much finer granularity
(the app level) instead of the user level.</p>
<p>The two discusssions have been around the installation of sysdig
(see <a href="https://sysdig.com/blog/friends-dont-let-friends-curl-bash/" target="_blank" rel="noopener">their article</a>

,
which focuses on signed code and proxies injecting modifications), and
Mastodon (which uses node.js, which features one installation path using
<code>curl -sL https://deb.nodesource.com/setup\_7.x | sudo -E bash -</code>).</p>
<p>Provided that you actually get the file that&rsquo;s on the remote server (i.e. no
proxy exists that modifies stuff), I fail to see the problem. You are not
very likely to go through the source and review it. Also, you are hopefully
installing this into a single-purpose virtual machine or container, so there
is nothing else inside the image anyway. It does not really matter, which
UID this is running as, because there is nothing else inside this universe
in the first place.</p>
<p>We have come, in a way, full circle and are back at MS-DOS, where there are
no users or permissions visible to the application, because it is utterly
alone in the world.</p>
<p>User IDs also do not matter much on personal devices, because these
typically have only one user. Being kris (1000) on my Laptop or my Cellphone
does not really contain or isolate anything, because there is only me and
the only files important are all mine - the files not owned by me come from
the operating system image and can be restored at any time. Yes, my files
are much more important and harder to replace than the system files.</p>
<h2 id="macos">
    <a href="#macos">
	MacOS
    </a>
</h2>
<p>In MacOS, we have a system that kind of solved the problem of a lone user
installing a lot of apps, all of which might to a certain extent be hostile
to each other or are trying to pull off things with me and my data. The
threat model is not &ldquo;multiple users sharing a single device, and keeping
their stuff separate&rdquo;, but &ldquo;many apps from different sources, and with
different levels of trustworthiness, make sure they do not make off with the
users data or another apps data unnoticed&rdquo;.</p>
<p>This is very different from Unix-Think and Unix is actually by default not
set up at all to handle this. MacOS attacks the problem by sandboxing Apps
from the App Store. Apps run in</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">⌂ [:~/Library com.omnigroup.OmniGraffle7.MacAppStore]↥ $ pwd
</span></span></span><span class="line"><span class="cl"><span class="go">/Users/kkoehntopp/Library/Containers/com.omnigroup.OmniGraffle7.MacAppStore
</span></span></span><span class="line"><span class="cl"><span class="go">⌂ [:~/Library … com.omnigroup.OmniGraffle7.MacAppStore]↥ $ ls -1
</span></span></span><span class="line"><span class="cl"><span class="go">Desktop
</span></span></span><span class="line"><span class="cl"><span class="go">Documents
</span></span></span><span class="line"><span class="cl"><span class="go">Downloads
</span></span></span><span class="line"><span class="cl"><span class="go">Library
</span></span></span><span class="line"><span class="cl"><span class="go">Movies
</span></span></span><span class="line"><span class="cl"><span class="go">Music
</span></span></span><span class="line"><span class="cl"><span class="go">Pictures
</span></span></span></code></pre></div><p>That is, you still have a single UID per potential user, but apps are
confined to a subdirectory and a bunch of system standard locations for
stuff. They can exit that through the file dialogs and other systems means
and access arbitrary locations in the system, but the user interaction
required here makes sure their activity is being screened and contextualized
by a human.</p>
<p>For the user, this is transparent and invisible, and requires no conscious
permissive actions. It is implied in the normal I/O dialog workflow. That&rsquo;s
genius, because it hides all the complexity that comes with other systems
such as AppArmor, let alone SELinux.</p>
<h2 id="android">
    <a href="#android">
	Android
    </a>
</h2>
<p>Android uses Unix UIDs, but differently than intended. In Android, you
always have a GUI, because a Command line without a GUI does make no sense
on touch devices. Multiple Users are possible, but user separation is not
via UID, it is via GUI.</p>
<p>Instead, Android assigns a UID to each app dynamically, and uses Linux
permissions <em>and</em> SELinux on top of that to keep apps out of each others
data.</p>
<p>The &ldquo;SD Card&rdquo; area and permission is actually a limited file share facility
between apps, but that was not planned. Instead it has been but a side
effect of the fact that MS-DOS filesystems on SD-Cards do not enforce Unix
UIDs of different apps.</p>
<p>On top of that, Google has been learning clumsily and slowly to leverage
this to an advantage, with several false starts.</p>
<h2 id="user-story">
    <a href="#user-story">
	User Story
    </a>
</h2>
<p>Both systems allow users to install apps from all kinds of app makers
through a unified channel with limited review, and manage to keep data
per-app separated. So it is possible to run apps safely, even if the app is
somewhat hostile to other apps or the users data. The ideas behind that have
been picked up, and are being transformed slowly in the unix environment
using the desktop-container paradigm.</p>
<p>Things like <a href="http://flatpak.org/" target="_blank" rel="noopener">Flatpak</a>

 are leveraging containers on the
desktop to do exactly what the MacOS sandbox does.</p>
<h2 id="summary">
    <a href="#summary">
	Summary:
    </a>
</h2>
<ul>
<li>If everything on your system is running as the same user, then &ldquo;curl |sudo
bash&rdquo; and &ldquo;curl | bash&rdquo; are equivalent in terms of threat.</li>
<li>If the user is not actually reviewing the source and build, then each apt-get,
rpm and any curlbash are actually equivalent, because the amount of review
is the same, and far too little.</li>
</ul>
<p>What is instead necessary is a system that improves security in a way that
separates apps, not users, and that makes it possible to recover from the
accidental install and execution of a hostile or broken app.</p>
<p>And that&rsquo;s what desktop containers like flatpak do, or intend to do. They
are obviously neither perfect nor finished. But they are actually addressing
a new and different threat model than the one Unix was built for, and that
is no longer reflecting the current world.</p>

			</div>
		</div>

		
		
		<div class='row justify-content-center py-3 mb-3 mx-0'>
			<div class='col-lg-8 text-center'>
				<span class='letter-spacing-01 text-uppercase text-secondary me-2'>Tags</span>
				
				<a href="/tags/#security" class='btn btn-sm btn-outline-primary mb-1'>
				<svg class="bi" width="1rem" height="1rem" fill="currentColor">
					<use xlink:href="/bootstrap-icons.svg#tag-fill"></use>
				</svg>
				security
				</a>
				
				<a href="/tags/#container" class='btn btn-sm btn-outline-primary mb-1'>
				<svg class="bi" width="1rem" height="1rem" fill="currentColor">
					<use xlink:href="/bootstrap-icons.svg#tag-fill"></use>
				</svg>
				container
				</a>
				
				<a href="/tags/#lang_en" class='btn btn-sm btn-outline-primary mb-1'>
				<svg class="bi" width="1rem" height="1rem" fill="currentColor">
					<use xlink:href="/bootstrap-icons.svg#tag-fill"></use>
				</svg>
				lang_en
				</a>
				
			</div>
		</div>

		
		
		
		
		<div class='row justify-content-center py-3 mb-3 mx-0'>
			<div class='col-lg-8 text-center'>
				<a href="https://github.com/isotopp/isotopp.github.io/edit/main/content/posts/2017-04-13-curlbash-and-desktop-containers.md"
				   rel="noopener noreferrer" target="_blank">
					<span class='letter-spacing-01 text-uppercase text-secondary me-2'>Suggest Changes</span>
				</a>
			</div>
		</div>
		

		<div class='row justify-content-center mx-0'>
			<div class='col-lg-4 text-center text-lg-start'>
				
				<div>
					<div class='letter-spacing-01 text-uppercase text-secondary'>
						Previous Post
					</div>
					<a class='text-decoration-none' href="https://blog.koehntopp.info/2017/04/05/apostrophiser.html">Apostrophiser</a>
				</div>
				
			</div>

			<div class='col-lg-4 text-lg-end mt-5 mt-lg-0 text-center'>
				
				<div>
					<div class='letter-spacing-01 text-uppercase text-secondary'>
						Next Post
					</div>
					<a class='text-decoration-none' href="https://blog.koehntopp.info/2017/04/19/node-js-idea-of-an-inode-is-approximately-broken.html">node.js idea of an inode is approximately broken</a>
				</div>
				
			</div>
		</div>


		
	</article>
</div>



            <footer class='row justify-content-center mb-4 pb-4 mx-0'>
  <div class='col-8 text-center'>
    <div>
      A collection of old stuff, new stuff and random stuff.
    </div>
    <div class='row text-primary mt-4'>
      <div class='col'>

        <a href='/feed.xml' title='Follow RSS feed' class='me-3 text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#rss-fill'/>
          </svg>
        </a>

        <a href='mailto:kristian.koehntopp@gmail.com' title='Email' class='me-3 text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#envelope'/>
          </svg>
        </a>

        <a href='https://github.com/isotopp' title='Follow on GitHub' class='me-3 text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#github'/>
          </svg>
        </a>

        <a rel="me" href="https://infosec.exchange/@isotopp" title='Follow on Mastodon' class='me-3 text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#mastodon'/>
          </svg>
        </a>

        
        <a href='http://steamcommunity.com/id/ixotopp' title='Follow on Steam' class='me-3 text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#steam'/>
          </svg>
        </a>

        

        <a href='https://www.youtube.com/user/isotopp' title='Follow on YouTube' class=''>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#youtube'/>
          </svg>
        </a>
      </div>
    </div>
  </div>
</footer>


        </main>

	





<script src="https://blog.koehntopp.info/js/bootstrap.js"></script>




<script src="https://blog.koehntopp.info/js/lunr.js"></script>





<script src="https://blog.koehntopp.info/js/app.js"></script>


    </body>
</html>
