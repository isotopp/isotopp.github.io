<!doctype html>
<html lang="en">
    <head>
    <meta charset="utf-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<title>Sicherheit von Chipkarten | Die wunderbare Welt von Isotopp</title>
<meta name="description" content="Kris Köhntopp&#39;s blog (Fedi: @isotoppinfosec.exchange)">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" href="icon.png">
<link rel="icon" href="favicon.ico" type="image/ico">
<link rel="shortcut icon" href="favicon.ico">
<link rel="canonical" href="https://blog.koehntopp.info/2008/08/11/sicherheit-von-chipkarten.html">

<link rel="alternate" type="application/rss+xml" href='https://blog.koehntopp.info/feed.xml' title="Die wunderbare Welt von Isotopp">
<link rel="alternate" type="application/rss+xml" href='https://blog.koehntopp.info/tags/mysql/feed.xml' title="Feed: mysql Articles for Die wunderbare Welt von Isotopp">
<link rel="alternate" type="application/rss+xml" href='https://blog.koehntopp.info/tags/review/feed.xml' title="Feed: review Articles for Die wunderbare Welt von Isotopp">


<meta name="generator" content="Hugo 0.145.0">
<meta property="og:title" content='Sicherheit von Chipkarten | Die wunderbare Welt von Isotopp' />
<meta property="og:site_name" content='Die wunderbare Welt von Isotopp' />
<meta property="og:locale" content="de_DE" />
<meta name="description" content='Kris Köhntopp&#39;s blog (Fedi: @isotoppinfosec.exchange)' />
<meta property="og:description" content='Kris Köhntopp&#39;s blog (Fedi: @isotoppinfosec.exchange)' />
<meta property="og:url" content="https://blog.koehntopp.info/2008/08/11/sicherheit-von-chipkarten.html" />
<meta property="og:type" content="article" />
<meta name="article:published_time" content='2008-08-11T14:48:26Z' />
<meta name="fediverse:creator" content="@isotopp@infosec.exchange">
<meta property="og:image" content='https://blog.koehntopp.info/assets/img/background/schloss.jpg' />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:creator" content='@isotopp@infosec.exchange' />
<meta property="twitter:title" content='Sicherheit von Chipkarten' />
<meta property="twitter:description" content='Kris Köhntopp&#39;s blog (Fedi: @isotoppinfosec.exchange)' />
<meta property="twitter:image" content='https://blog.koehntopp.info/assets/img/background/schloss.jpg' />


    



<link rel="stylesheet" href="https://blog.koehntopp.info/style.min.dd9d518fe6cac55191b6af874e18327dff051055754ffc7e106131baf826e6d3.css">


    </head>
    <body>
        

        <nav class="navbar navbar-expand-lg navbar-light px-lg-4 pt-lg-4">
    <div class="container-fluid">
        <a class="navbar-brand justify-content-center" href="https://blog.koehntopp.info/" rel="home" title="Die wunderbare Welt von Isotopp">
            <img alt="Kris" height='48' width='48' src='/assets/img/avatars/isotopp.jpg' class='p-0 me-3 d-block d-lg-inline'>
            <span class='h4 d-block d-lg-inline'>Die wunderbare Welt von Isotopp</span>
        </a>

        <button class="navbar-toggler ms-auto" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse text-center" id="navbarSupportedContent">
            <ul class="navbar-nav ms-auto">
                
                <li class="nav-item ">
                    <a class="nav-link" href="/about/">
                        <span class="">About</span>
                        
                    </a>
                </li>
                <li class="nav-item ">
                    <a class="nav-link" href="/contribute/">
                        <span class="">Contribute</span>
                        
                    </a>
                </li>
                <li class="nav-item ">
                    <a class="nav-link" href="/search/">
                        <span class=""><svg class='bi' height='1.5rem' width='1.5rem' fill='currentColor'><use xlink:href='/bootstrap-icons.svg#search'/></svg></span>
                        
                    </a>
                </li>
                <li class="nav-item ">
                    <a class="nav-link" href="/tags/">
                        <span class=""><svg class='bi' width='1.5rem' height='1.5rem' fill='currentColor'><use xlink:href='/bootstrap-icons.svg#tags-fill'/></svg></span>
                        
                    </a>
                </li>
                
            </ul>
            
        </div>

    </div>
</nav>


        <main role="main" class="container-fluid p-0">

            









<div class="page">
	<article class="sicherheit-von-chipkarten-page">
		<div class='row  justify-content-center text-center my-4 mx-0'>
			<header class="headerbanner">
				<div class='col'>
					<h1 class="title mb-lg-4 text-white">
						Sicherheit von Chipkarten
					</h1>
					<div class='text-uppercase text-light' style='letter-spacing: 0.1rem;'>
						<img alt='@isotopp@infosec.exchange image' src='/assets/img/avatars/isotopp.jpg' class='me-1 p-0'
						     style='width: 1.9rem; border-radius: 1rem;'>
						<a href="https://infosec.exchange/@isotopp" class='text-light text-decoration-none'>
							Kristian Köhntopp
						</a>
						
						<span class='d-none d-lg-inline'>-</span>
						<div class='d-block d-lg-inline'>August 11, 2008</div>
						
					</div>
				</div>
				
				<img alt='a featured image' src="/assets/img/background/schloss.jpg">
				
			</header>
		</div>

		<div class='row justify-content-center mx-0'>
			<div class='col-lg-4 text-center text-lg-start'>
				
				<div>
					<div class='letter-spacing-01 text-uppercase text-secondary'>
						Previous Post
					</div>
					<a class='text-decoration-none' href="https://blog.koehntopp.info/2008/07/25/yahoo-schaltet-yahoo-music-ab.html">Yahoo! schaltet Yahoo Music ab</a>
				</div>
				
			</div>

			<div class='col-lg-4 text-lg-end mt-5 mt-lg-0 text-center'>
				
				<div>
					<div class='letter-spacing-01 text-uppercase text-secondary'>
						Next Post
					</div>
					<a class='text-decoration-none' href="https://blog.koehntopp.info/2008/08/13/berliner-mauer.html">Berliner Mauer</a>
				</div>
				
			</div>
		</div>

		<div class='row justify-content-center mx-0 mt-3 mb-5'>
			<div class="col-lg-8 mb-3">
				
			</div>
			<div class='col-lg-8'>
				<p><p class="md__image">
  <img src="/uploads/chipkarte.jpg" alt=""  />
</p>

</p>
<p><em>Image: <a href="https://flickr.com/photos/dwizzy/412531283/" target="_blank" rel="noopener">Dwizzy</a>

 on Flickr</em></p>
<p>Zwei Artikel im Folge im Blog von Bruce Schneier, und beide haben mit Karten und Sicherheit zu tun.
In
<a href="http://www.schneier.com/blog/archives/2008/08/hacking_mifare.html" target="_blank" rel="noopener">Hacking MiFare Transport Cards</a>


kommentiert Schneier die Gruppe der Radboud University Nijmegen, die die Sicherheitssysteme der MiFare Classic Karte von NXP überwunden hat.
NXP hat versucht, gegen die Veröffentlichung der Papers zu klagen, die diese Fehler der MiFare beschreiben, hat aber den Prozess verloren.
Der Richter urteilte:</p>
<blockquote>
<p>Damage to NXP is not the result of the publication of the article but of the production and sale of a chip that appears to have shortcomings.</p></blockquote>
<p>In einem zweiten Artikel
<a href="http://www.schneier.com/blog/archives/2008/08/uk_electronic_p.html" target="_blank" rel="noopener">UK Electronic Passport Cloned</a>


geht es um den Pass mit Chip, der in England ausgegeben werden soll, ähnlich dem biometrischen Pass und Personalausweis in Deutschland.
Die Times hat sich von einem Sicherheitsspezialisten zwei Pässe clonen und die darin enthaltenen Bilder ersetzen lassen.</p>
<p>Man fragt sich natürlich, was die Hersteller solcher Geräte die ganze Zeit tun, wenn sich ihre Karten und Chips so schnell knacken lassen und so hilflos gegen Angriffe sind.
Der Fehler ist aber nur zum Teil bei den Herstellern zu suchen, es handelt sich vielmehr um ein tiefer liegendes Problem, und zwar um ein Verständnisproblem bei den Leuten, die sich für solche Systeme entscheiden.</p>
<p>Eine Chipkarte ist ein Single Chip Computer, der Sicherheit gewährleisten soll.
Dazu hat dieser Single Chip Computer eine CPU, ein wenig Speicher und ein wenig Kryptologik an Bord.
All das wird in eine Plastikkarte eingebettet.</p>
<p>Der Chip hat keine eigene Stromversorgung, er hat keine Peripheriegeräte wie Display oder Tastatur, sondern im günstigsten Fall 2-6 Kontakte nach draußen, im ungünstigsten Fall eine Drahtschlinge als Antenne zur Stromversorgung und zum Senden und Empfangen von Daten.
Diesen Chip in seiner Plastikverpackung gibt man dann dem Angreifer in die Hand und lässt diesen mit dem Gerät einige Tage, Wochen oder Monate lang allein.</p>
<p>Angriffe auf solche Chips gibt es viele.
Einige
<a href="http://www.flylogic.net/blog/?p=26" target="_blank" rel="noopener">Leute</a>


legen solche Chips zum Beispiel routinemäßig aus ihrer Plastik- oder Chipverpackung frei und durchleuchten sie dann mit einem Raster-Elektronenmikroskop oder anderen Untersuchungsmethoden.
Aus dem Layout der Leiterbahnen kann man
<a href="http://www.flylogic.net/blog/?p=25" target="_blank" rel="noopener">Fehler im Chipdesign</a>


oder Hintertüren erkennen oder Angriffsmethoden ableiten.</p>
<p>Man kann sich auch
<a href="http://www.rfidguardian.org/index.php/Differential_Power_Analysis" target="_blank" rel="noopener">auf die Stromversorgung des Chips</a>


klemmen und so auf geheime Daten rückschließen, die eigentlich nicht extrahierbar auf dem Chip gespeichert sind.
Je nachdem wie die Daten auf dem Chip gespeichert sind und verarbeitet werden kann man aus dem Stromverbrauch des Chips auf Nullen oder Einsen in einem Bitmuster schließen, daß etwa einen geheimen Schlüssel darstellt, der den Chip nie verlassen sollte.</p>
<p>Andere Angriffe bestehen darin, daß man den Chip auf so einer Karte mit unsauberer oder unzureichender Betriebsspannung versorgt, und zwar gerade so, daß der Chip funktioniert, aber nicht zuverlässig.
Es kommt bei Rechnungen zu Bitkippern oder anderen seltsamen Ungereimtheiten, weil zur Verfügung stehende Leistung böswillig so manipuliert oder moduliert wird, daß man eigentlich unlogische Ergebnisse bekommt.
Einige Chips versuchen sich gegen solche Angriffe zu schützen, etwa indem sie dieselbe Berechnung dreimal ausführen und dann die Ergebnisse vergleichen.
Bei korrekter Funktion des Chips kommt natürlich immer dasselbe raus, kommt es jedoch wegen Unterversorgung des Chips zu zufälligen Bitkippern, sind die Ergebnisse nicht identisch (und der Chip schaltet sich ab).</p>
<p>Bei allen Chipkarten - mit oder ohne Kontakte - kommt dazu, daß sie keine vertrauenswürdige Peripherie haben, also nicht wissen, ob sie mit einem legitimen Terminal oder einem Angreifer reden, ebenso wie anders herum das Terminal nicht wissen kann, ob es mit einer legitimen Karte oder einem Angreifer redet.
Karte und Terminal müssen sich also gegenseitig authentisieren und legitimieren.
Bei drahtlos kommunizierenden Karten kommt noch dazu, daß Dritte die Kommunikation zwischen Karte und Lesegerät unter Umständen mithören und daraus gewonnene Information für Angriffe ausnutzen können.</p>
<p>Chipkarten sollen nun außerdem noch in großer Stückzahl hergestellt werden.
Das bedeutet, sie sind wahrscheinlich ab Werk identisch und werden später erst personalisiert (Angreifer können möglicherweise also über unpersonalisierte Blanko-Exemplare verfügen und diese dann später so personalisieren, daß sie Duplikate existierender Karten sind).
Und das bedeutet auch, die Karten müssen sehr preisgünstig hergestellt werden:
Da der Anzahl-Multiplikator in die Millionen gehen kann, zählt jeder Cent-Bruchteil Ersparnis.</p>
<p>Kurz: Wenn man ein Angreifermodell für eine Sicherheitsanalyse konstruieren sollte, das für den Verteidiger möglichst pessimal ist, dann kommt etwas heraus, das einer kontaktlosen Chipkarte und ihrem typischen Benutzungsumfeld sehr, sehr ähnlich ist.</p>
<p>Für Fahrkarten mag das vielleicht ausreichend sein, für Zugangskontrolle eher nicht.
Für Ausweise?
Öh.
Da wäre man schon sehr <strike>dämlich</strike> von einer Industrielobby gekauft, wenn man sich als Staat für so etwas entschiede.
Ich erwarte jedenfalls aufgrund der Verteidigungssituation in diesem Szenario nicht, daß irgendeiner dieser Chip für nennenswerte Zeit einem Angriff standhält.
Nein, auch nicht die in meinem Pass und Perso.</p>
<p><strong>Update:</strong>
Natürlich gibt es gegen jeden Einzelnen dieser bekannten Angriffe Gegenmaßnahmen - Metallschichten auf dem Chip, Mehrfachberechnungen zur Erkennung versorgungsbedingter Fehlfunktionen, Codegestaltung so, daß immer gleich viel Power verbraucht wird, Kryptoprotokolle zwischen Terminal und Karte.
Alle diese Dinge machen jedoch die Karte stromhungriger, langsamer und vor allen Dingen teurer und stehen einer Massenproduktion damit entgegen.
Viele der Fehler entwerten außerdem nicht eine Karte, sondern das System - das mit vielen Millionen Karten im missionskritischen Einsatz ein sehr empfindlicher Totalverlust ist, wenn die Sicherheit des Systems und nicht die einer Karte versagen sollte.</p>
<p>Darum ja auch die etwas hysterische Reaktion von NXP.</p>

			</div>
		</div>

		
		
		<div class='row justify-content-center py-3 mb-3 mx-0'>
			<div class='col-lg-8 text-center'>
				<span class='letter-spacing-01 text-uppercase text-secondary me-2'>Tags</span>
				
				<a href="/tags/#identity" class='btn btn-sm btn-outline-primary mb-1'>
				<svg class="bi" width="1rem" height="1rem" fill="currentColor">
					<use xlink:href="/bootstrap-icons.svg#tag-fill"></use>
				</svg>
				identity
				</a>
				
				<a href="/tags/#security" class='btn btn-sm btn-outline-primary mb-1'>
				<svg class="bi" width="1rem" height="1rem" fill="currentColor">
					<use xlink:href="/bootstrap-icons.svg#tag-fill"></use>
				</svg>
				security
				</a>
				
				<a href="/tags/#lang_de" class='btn btn-sm btn-outline-primary mb-1'>
				<svg class="bi" width="1rem" height="1rem" fill="currentColor">
					<use xlink:href="/bootstrap-icons.svg#tag-fill"></use>
				</svg>
				lang_de
				</a>
				
			</div>
		</div>

		
		
		
		
		<div class='row justify-content-center py-3 mb-3 mx-0'>
			<div class='col-lg-8 text-center'>
				<a href="https://github.com/isotopp/isotopp.github.io/edit/main/content/posts/2008-08-11-sicherheit-von-chipkarten.md"
				   rel="noopener noreferrer" target="_blank">
					<span class='letter-spacing-01 text-uppercase text-secondary me-2'>Suggest Changes</span>
				</a>
			</div>
		</div>
		

		<div class='row justify-content-center mx-0'>
			<div class='col-lg-4 text-center text-lg-start'>
				
				<div>
					<div class='letter-spacing-01 text-uppercase text-secondary'>
						Previous Post
					</div>
					<a class='text-decoration-none' href="https://blog.koehntopp.info/2008/07/25/yahoo-schaltet-yahoo-music-ab.html">Yahoo! schaltet Yahoo Music ab</a>
				</div>
				
			</div>

			<div class='col-lg-4 text-lg-end mt-5 mt-lg-0 text-center'>
				
				<div>
					<div class='letter-spacing-01 text-uppercase text-secondary'>
						Next Post
					</div>
					<a class='text-decoration-none' href="https://blog.koehntopp.info/2008/08/13/berliner-mauer.html">Berliner Mauer</a>
				</div>
				
			</div>
		</div>


		
	</article>
</div>



            <footer class='row justify-content-center mb-4 pb-4 mx-0'>
  <div class='col-8 text-center'>
    <div>
      A collection of old stuff, new stuff and random stuff.
    </div>
    <div class='row text-primary mt-4'>
      <div class='col'>

        <a href='/feed.xml' title='Follow RSS feed' class='me-3 text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#rss-fill'/>
          </svg>
        </a>

        <a href='mailto:kristian.koehntopp@gmail.com' title='Email' class='me-3 text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#envelope'/>
          </svg>
        </a>

        <a href='https://github.com/isotopp' title='Follow on GitHub' class='me-3 text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#github'/>
          </svg>
        </a>

        <a rel="me" href="https://infosec.exchange/@isotopp" title='Follow on Mastodon' class='me-3 text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#mastodon'/>
          </svg>
        </a>

        
        <a href='http://steamcommunity.com/id/ixotopp' title='Follow on Steam' class='me-3 text-decoration-none'>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#steam'/>
          </svg>
        </a>

        

        <a href='https://www.youtube.com/user/isotopp' title='Follow on YouTube' class=''>
          <svg class='bi' height='2.5rem' width='2.5rem' fill='currentColor'>
            <use xlink:href='/bootstrap-icons.svg#youtube'/>
          </svg>
        </a>
      </div>
    </div>
  </div>
</footer>


        </main>

	





<script src="https://blog.koehntopp.info/js/bootstrap.js"></script>




<script src="https://blog.koehntopp.info/js/lunr.js"></script>





<script src="https://blog.koehntopp.info/js/app.js"></script>


    </body>
</html>
